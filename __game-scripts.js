function gtag(){dataLayer.push(arguments)}!function(){var n,r={resource:{version:"1",macros:[],tags:[],predicates:[],rules:[]},runtime:[]},i="function"==typeof Object.create?Object.create:function(n){var b=function(){};return b.prototype=n,new b};if("function"==typeof Object.setPrototypeOf)n=Object.setPrototypeOf;else{var o;e:{var s={};try{s.__proto__={a:!0},o=s.a;break e}catch(T){}o=!1}n=o?function(n,r){if(n.__proto__=r,n.__proto__!==r)throw new TypeError(n+" is not extensible");return n}:null}var l=n,v=this||self,ma=function(n){return n},oa=function(n){return"function"==typeof n},h=function(n){return"string"==typeof n},pa=function(n){return"number"==typeof n&&!isNaN(n)},d=Array.isArray,ra=function(n,r){if(n&&d(n))for(var i=0;i<n.length;i++)if(n[i]&&r(n[i]))return n[i]},sa=function(n,r){return(!pa(n)||!pa(r)||n>r)&&(n=0,r=2147483647),Math.floor(Math.random()*(r-n+1)+n)},ua=function(n,r){for(var i=new ta,o=0;o<n.length;o++)i.set(n[o],!0);for(var s=0;s<r.length;s++)if(i.get(r[s]))return!0;return!1},k=function(n,r){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&r(i,n[i])},xa=function(n){return!!n&&("[object Arguments]"===Object.prototype.toString.call(n)||Object.prototype.hasOwnProperty.call(n,"callee"))},Aa=function(n){return"false"!==String(n).toLowerCase()&&!!n},Ba=function(n){var r=[];if(d(n))for(var i=0;i<n.length;i++)r.push(String(n[i]));return r},z=function(){return new Date(Date.now()).getTime()},ta=function(){this.prefix="gtm.",this.values={}};ta.prototype.set=function(n,r){this.values[this.prefix+n]=r},ta.prototype.get=function(n){return this.values[this.prefix+n]};var g,p,Fa=function(n){var r=n;return function(){if(r){var n=r;r=void 0;try{n()}catch(n){}}}},Ga=function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},Ia=function(n,r){for(var i=[],o=0;o<n.length;o++)i.push(n[o]),i.push.apply(i,r[n[o]]||[]);return i},Ja=function(n,r){for(var i={},o=i,s=n.split("."),l=0;l<s.length-1;l++)o=o[s[l]]={};return o[s[s.length-1]]=r,i};function Pa(){for(var n=g,r={},i=0;i<n.length;++i)r[n[i]]=i;return r}function Ra(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return(n+=n.toLowerCase()+"0123456789-_")+"."}function Ta(n){g=g||Ra(),p=p||Pa();for(var r=[],i=0;i<n.length;i+=3){var o=i+1<n.length,s=i+2<n.length,l=n.charCodeAt(i),v=o?n.charCodeAt(i+1):0,d=s?n.charCodeAt(i+2):0,_=l>>2,m=(3&l)<<4|v>>4,y=(15&v)<<2|d>>6,w=63&d;s||(w=64,o||(y=64)),r.push(g[_],g[m],g[y],g[w])}return r.join("")}var _,m={},Wa=function(n,r){m[n]=m[n]||[],m[n][r]=!0},Ya=function(n){var r=m[n];if(!r||0===r.length)return"";for(var i=[],o=0,s=0;s<r.length;s++)0==s%8&&0<s&&(i.push(String.fromCharCode(o)),o=0),r[s]&&(o|=1<<s%8);return 0<o&&i.push(String.fromCharCode(o)),Ta(i.join("")).replace(/\.+$/,"")},y=Array.prototype.indexOf?function(n,r){return Array.prototype.indexOf.call(n,r,void 0)}:function(n,r){if("string"==typeof n)return"string"!=typeof r||1!=r.length?-1:n.indexOf(r,0);for(var i=0;i<n.length;i++)if(i in n&&n[i]===r)return i;return-1},ab=function(){if(void 0===_){var n=null,r=v.trustedTypes;if(r&&r.createPolicy){try{n=r.createPolicy("goog#html",{createHTML:ma,createScript:ma,createScriptURL:ma})}catch(n){v.console&&v.console.error(n.message)}_=n}else _=n}return _},cb=function(n,r){this.h=r===w?n:""};cb.prototype.toString=function(){return this.h+""};var w={};function eb(){var n=v.navigator;if(n){var r=n.userAgent;if(r)return r}return""}function fb(n){return-1!=eb().indexOf(n)}function gb(){return fb("Firefox")||fb("FxiOS")}function hb(){return(fb("Chrome")||fb("CriOS"))&&!fb("Edge")||fb("Silk")}var x={},jb=function(n,r){this.h=r===x?n:""};jb.prototype.toString=function(){return this.h.toString()};var I=window,S=document,E=navigator,M=S.currentScript&&S.currentScript.src,pb=function(n,r){var i=I[n];return I[n]=void 0===i?r:i,I[n]},qb=function(n,r){r&&(n.addEventListener?n.onload=r:n.onreadystatechange=function(){n.readyState in{loaded:1,complete:1}&&(n.onreadystatechange=null,r())})},A={async:1,nonce:1,onerror:1,onload:1,src:1,type:1};function tb(n,r,i){r&&k(r,(function(r,o){r=r.toLowerCase(),i.hasOwnProperty(r)||n.setAttribute(r,o)}))}var T,j,N,L,ub=function(n,r,i,o,s){var l=S.createElement("script");tb(l,o,A),l.type="text/javascript",l.async=!0;var v,d=n,g=ab(),p=g?g.createScriptURL(d):d;v=new cb(p,w),l.src=v instanceof cb&&v.constructor===cb?v.h:"type_error:TrustedResourceUrl";var _,m,y,x=null==(y=(m=(l.ownerDocument&&l.ownerDocument.defaultView||window).document).querySelector)?void 0:y.call(m,"script[nonce]");if((_=x&&(x.nonce||x.getAttribute("nonce"))||"")&&l.setAttribute("nonce",_),qb(l,r),i&&(l.onerror=i),s)s.appendChild(l);else{var I=S.getElementsByTagName("script")[0]||S.body||S.head;I.parentNode.insertBefore(l,I)}return l},xb=function(n,r,i){var o=new Image(1,1);o.onload=function(){o.onload=null,r&&r()},o.onerror=function(){o.onerror=null,i&&i()},o.src=n},yb=function(n,r,i,o){n.addEventListener?n.addEventListener(r,i,!!o):n.attachEvent&&n.attachEvent("on"+r,i)},G=function(n){I.setTimeout(n,0)},q=/\[object (Boolean|Number|String|Function|Array|Date|RegExp)\]/,Ib=function(n){if(null==n)return String(n);var r=q.exec(Object.prototype.toString.call(Object(n)));return r?r[1].toLowerCase():"object"},Jb=function(n,r){return Object.prototype.hasOwnProperty.call(Object(n),r)},Kb=function(n){if(!n||"object"!=Ib(n)||n.nodeType||n==n.window)return!1;try{if(n.constructor&&!Jb(n,"constructor")&&!Jb(n.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}for(var r in n);return void 0===r||Jb(n,r)},J=function(n,r){var i,o=r||("array"==Ib(n)?[]:{});for(i in n)if(Jb(n,i)){var s=n[i];"array"==Ib(s)?("array"!=Ib(o[i])&&(o[i]=[]),o[i]=J(s,o[i])):Kb(s)?(Kb(o[i])||(o[i]={}),o[i]=J(s,o[i])):o[i]=s}return o},Lb=function(n){if(void 0===n||d(n)||Kb(n))return!0;switch(typeof n){case"boolean":case"number":case"string":case"function":return!0}return!1},D={Oh:(T=function(n){return{toString:function(){return n}}})("consent"),Lf:T("convert_case_to"),Mf:T("convert_false_to"),Nf:T("convert_null_to"),Of:T("convert_true_to"),Pf:T("convert_undefined_to"),sk:T("debug_mode_metadata"),Ra:T("function"),Ue:T("instance_name"),Ei:T("live_only"),Fi:T("malware_disabled"),Gi:T("metadata"),Ji:T("original_activity_id"),wk:T("original_vendor_template_id"),vk:T("once_on_load"),Ii:T("once_per_event"),Sg:T("once_per_load"),xk:T("priority_override"),yk:T("respected_consent_types"),Wg:T("setup_tags"),Qc:T("tag_id"),Xg:T("teardown_tags")},U=[],R=[],B=[],V=[],K=[],F={},uc=function(n,r){var i=n.function,o=r&&r.event;if(!i)throw Error("Error: No function name given for function call.");var s,l=F[i],v={};for(s in n)n.hasOwnProperty(s)&&0===s.indexOf("vtp_")&&(l&&o&&o.dh&&o.dh(n[s]),v[void 0!==l?s:s.substr(4)]=n[s]);if(l&&o&&o.bh&&(v.vtp_gtmCachedValues=o.bh),r){if(null==r.name){var d;e:{var g=r.index;if(null==g)d="";else{var p;switch(r.type){case 2:p=U[g];break;case 1:p=V[g];break;default:d="";break e}var _=p&&p[D.Ue];d=_?String(_):""}}r.name=d}l&&(v.vtp_gtmEntityIndex=r.index,v.vtp_gtmEntityName=r.name)}return void 0!==l?l(v):undefined(i,v,r)},wc=function(n,r,i){i=i||[];var o,s={};for(o in n)n.hasOwnProperty(o)&&(s[o]=vc(n[o],r,i));return s},vc=function(n,r,i){var o;if(d(n))switch(n[0]){case"function_id":return n[1];case"list":o=[];for(var s=1;s<n.length;s++)o.push(vc(n[s],r,i));return o;case"macro":var l=n[1];if(i[l])return;var v=U[l];if(!v||r.nf(v))return;i[l]=!0;var g=String(v[D.Ue]);try{var p=wc(v,r,i);p.vtp_gtmEventId=r.id,r.priorityId&&(p.vtp_gtmPriorityId=r.priorityId),o=uc(p,{event:r,index:l,type:2,name:g}),L&&(o=L.Yi(o,p))}catch(n){r.qh&&r.qh(n,Number(l),g),o=!1}return i[l]=!1,o;case"map":o={};for(var _=1;_<n.length;_+=2)o[vc(n[_],r,i)]=vc(n[_+1],r,i);return o;case"template":o=[];for(var m=!1,y=1;y<n.length;y++){var w=vc(n[y],r,i);N&&(m=m||w===N.Rd),o.push(w)}return N&&m?N.Zi(o):o.join("");case"escape":if(o=vc(n[1],r,i),N&&d(n[1])&&"macro"===n[1][0]&&N.yj(n))return N.Qj(o);o=String(o);for(var x=2;x<n.length;x++)Nb[n[x]]&&(o=Nb[n[x]](o));return o;case"tag":var I=n[1];if(!V[I])throw Error("Unable to resolve tag reference "+I+".");return{jh:n[2],index:I};case"zb":var S={arg0:n[2],arg1:n[3],ignore_case:n[5]};S.function=n[1];var E=xc(S,r,i),M=!!n[4];return M||2!==E?M!==(1===E):null;default:throw Error("Attempting to expand unknown Value type: "+n[0]+".")}return n},xc=function(n,r,i){try{return j(wc(n,r,i))}catch(r){JSON.stringify(n)}return 2},zc=function(n,r){for(var i=n.if||[],o=0;o<i.length;o++){var s=r(i[o]);if(0===s)return!1;if(2===s)return null}for(var l=n.unless||[],v=0;v<l.length;v++){var d=r(l[v]);if(2===d)return null;if(1===d)return!1}return!0},yc=function(n){var r=[];return function(i){return void 0===r[i]&&(r[i]=xc(B[i],n)),r[i]}},H={Yi:function(n,r){return r[D.Lf]&&"string"==typeof n&&(n=1==r[D.Lf]?n.toLowerCase():n.toUpperCase()),r.hasOwnProperty(D.Nf)&&null===n&&(n=r[D.Nf]),r.hasOwnProperty(D.Pf)&&void 0===n&&(n=r[D.Pf]),r.hasOwnProperty(D.Of)&&!0===n&&(n=r[D.Of]),r.hasOwnProperty(D.Mf)&&!1===n&&(n=r[D.Mf]),n}},W=[];W[7]=!0,W[9]=!0,W[27]=!0,W[6]=!0,W[12]=!0,W[11]=!0,W[13]=!0,W[15]=!0,W[23]=!0,W[29]=!0,W[33]=!0,W[35]=!0,W[36]=!0,W[38]=!0,W[43]=!0,W[44]=!0,function Ec(n,r){for(var i,o,s=0;i===o;)if(i=Math.floor(2*Math.random()),o=Math.floor(2*Math.random()),20<++s)return;i?W[n]=!0:W[r]=!0}(46,47),W[54]=!0,W[57]=!0,W[60]=!0;var O=function(n){return!!W[n]},X=/^[1-9a-zA-Z_-][1-9a-c][1-9a-v]\d$/;function $c(n,r){return"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_"[n<<2|r]}if(S.querySelectorAll)try{var Q=S.querySelectorAll(":root");Q&&1==Q.length&&Q[0]==S.documentElement&&!0}catch(T){}var P=function(n){Wa("GTM",n)},$={F:"ad_storage",R:"analytics_storage",If:"region",Jf:"consent_updated",Kf:"wait_for_update",Sh:"app_remove",Th:"app_store_refund",Uh:"app_store_subscription_cancel",Vh:"app_store_subscription_convert",Wh:"app_store_subscription_renew",Qf:"add_payment_info",Rf:"add_shipping_info",mc:"add_to_cart",nc:"remove_from_cart",Sf:"view_cart",Ib:"begin_checkout",oc:"select_item",sb:"view_item_list",Jb:"select_promotion",tb:"view_promotion",Ba:"purchase",qc:"refund",Ha:"view_item",Tf:"add_to_wishlist",Xh:"first_open",Yh:"first_visit",va:"gtag.config",Ca:"gtag.get",Zh:"in_app_purchase",sc:"page_view",ai:"session_start",we:"user_engagement",Kb:"gclid",ia:"ads_data_redaction",X:"allow_ad_personalization_signals",xe:"allow_custom_scripts",bi:"allow_display_features",uc:"allow_enhanced_conversions",Lb:"allow_google_signals",wa:"allow_interest_groups",vd:"auid",ci:"auto_detection_enabled",Wa:"aw_remarketing",wd:"aw_remarketing_only",vc:"discount",wc:"aw_feed_country",xc:"aw_feed_language",Z:"items",yc:"aw_merchant_id",Uf:"aw_basket_type",xd:"campaign_content",yd:"campaign_id",zd:"campaign_medium",Ad:"campaign_name",zc:"campaign",Bd:"campaign_source",Cd:"campaign_term",kb:"client_id",di:"content_group",ei:"content_type",Da:"conversion_cookie_prefix",Ac:"conversion_id",Xa:"conversion_label",qa:"conversion_linker",ye:"conversion_api",Ya:"cookie_domain",Ia:"cookie_expires",Za:"cookie_flags",Bc:"cookie_name",ze:"cookie_path",Pa:"cookie_prefix",ub:"cookie_update",Mb:"country",ma:"currency",Cc:"customer_lifetime_value",Dc:"custom_map",fi:"debug_mode",aa:"developer_id",Vf:"disable_merchant_reported_purchases",gi:"dc_custom_params",hi:"dc_natural_search",Ae:"dynamic_event_settings",ii:"affiliation",Wf:"checkout_option",Xf:"checkout_step",ji:"coupon",Yf:"item_list_name",Zf:"list_name",ki:"promotions",Ec:"shipping",ag:"tax",Dd:"engagement_time_msec",Fc:"enhanced_client_id",Gc:"enhanced_conversions",cg:"enhanced_conversions_automatic_settings",Hc:"estimated_delivery_date",Be:"euid_logged_in_state",Nb:"event_callback",Ob:"event_developer_id_string",dg:"event",Ed:"event_settings",Fd:"event_timeout",li:"experiments",Ce:"firebase_id",Gd:"first_party_collection",Hd:"_x_20",vb:"_x_19",eg:"fledge",fg:"flight_error_code",gg:"flight_error_message",hg:"gac_gclid",Id:"gac_wbraid",ig:"gac_wbraid_multiple_conversions",Ic:"ga_restrict_domain",De:"ga_temp_client_id",jg:"gdpr_applies",kg:"geo_granularity",ab:"value_callback",Qa:"value_key",Pb:"global_developer_id_string",tk:"google_ono",lb:"google_signals",Jd:"google_tld",Kd:"groups",lg:"gsa_experiment_id",mg:"iframe_state",Ld:"ignore_referrer",Ee:"internal_traffic_results",Md:"is_legacy_loaded",ng:"is_passthrough",Ja:"language",Fe:"legacy_developer_id_string",ra:"linker",Qb:"accept_incoming",Rb:"decorate_forms",T:"domains",Jc:"url_position",og:"method",Sb:"new_customer",pg:"non_interaction",mi:"optimize_id",Ka:"page_location",Ge:"page_path",La:"page_referrer",Tb:"page_title",qg:"passengers",rg:"phone_conversion_callback",ni:"phone_conversion_country_code",sg:"phone_conversion_css_class",oi:"phone_conversion_ids",ug:"phone_conversion_number",vg:"phone_conversion_options",wg:"quantity",Kc:"redact_device_info",He:"redact_enhanced_user_id",ri:"redact_ga_client_id",si:"redact_user_id",Nd:"referral_exclusion_definition",nb:"restricted_data_processing",ui:"retoken",xg:"screen_name",wb:"screen_resolution",vi:"search_term",xa:"send_page_view",xb:"send_to",Lc:"session_duration",Od:"session_engaged",Ie:"session_engaged_time",ob:"session_id",Pd:"session_number",Ub:"delivery_postal_code",yg:"tc_privacy_string",zg:"temporary_client_id",wi:"tracking_id",Je:"traffic_type",Ea:"transaction_id",na:"transport_url",Ag:"trip_type",Mc:"update",cb:"url_passthrough",Ke:"_user_agent_architecture",Le:"_user_agent_bitness",Me:"_user_agent_full_version_list",Bg:"_user_agent_mobile",Ne:"_user_agent_model",Oe:"_user_agent_platform",Pe:"_user_agent_platform_version",Cg:"_user_agent_wait",Qe:"_user_agent_wow64",ca:"user_data",Dg:"user_data_auto_latency",Eg:"user_data_auto_meta",Fg:"user_data_auto_multi",Gg:"user_data_auto_selectors",Hg:"user_data_auto_status",Ig:"user_data_mode",Re:"user_data_settings",sa:"user_id",Ma:"user_properties",Jg:"us_privacy_string",ka:"value",Qd:"wbraid",Kg:"wbraid_multiple_conversions",Ng:"_host_name",Og:"_in_page_command",Pg:"_is_linker_valid",Qg:"_is_passthrough_cid",Rg:"non_personalized_ads"},Z={};Object.freeze((Z[$.X]=1,Z[$.uc]=1,Z[$.Lb]=1,Z[$.Z]=1,Z[$.Ya]=1,Z[$.Ia]=1,Z[$.Za]=1,Z[$.Bc]=1,Z[$.ze]=1,Z[$.Pa]=1,Z[$.ub]=1,Z[$.Dc]=1,Z[$.aa]=1,Z[$.Ae]=1,Z[$.Nb]=1,Z[$.Ed]=1,Z[$.Fd]=1,Z[$.Gd]=1,Z[$.Ic]=1,Z[$.lb]=1,Z[$.Jd]=1,Z[$.Kd]=1,Z[$.Ee]=1,Z[$.Md]=1,Z[$.ra]=1,Z[$.He]=1,Z[$.Nd]=1,Z[$.nb]=1,Z[$.xa]=1,Z[$.xb]=1,Z[$.Lc]=1,Z[$.Ie]=1,Z[$.Ub]=1,Z[$.na]=1,Z[$.Mc]=1,Z[$.Re]=1,Z[$.Ma]=1,Z));Object.freeze([$.Ka,$.La,$.Tb,$.Ja,$.xg,$.sa,$.Ce,$.di]);var Y={},ee=(Object.freeze((Y[$.Sh]=1,Y[$.Th]=1,Y[$.Uh]=1,Y[$.Vh]=1,Y[$.Wh]=1,Y[$.Xh]=1,Y[$.Yh]=1,Y[$.Zh]=1,Y[$.ai]=1,Y[$.we]=1,Y)),{}),te=(Object.freeze((ee[$.Qf]=1,ee[$.Rf]=1,ee[$.mc]=1,ee[$.nc]=1,ee[$.Sf]=1,ee[$.Ib]=1,ee[$.oc]=1,ee[$.sb]=1,ee[$.Jb]=1,ee[$.tb]=1,ee[$.Ba]=1,ee[$.qc]=1,ee[$.Ha]=1,ee[$.Tf]=1,ee)),Object.freeze([$.X,$.Lb,$.ub])),ne=(Object.freeze([].concat(te)),Object.freeze([$.Ia,$.Fd,$.Lc,$.Ie,$.Dd])),re=(Object.freeze([].concat(ne)),{}),ie=(re[$.F]="1",re[$.R]="2",{});Object.freeze((ie[$.X]=1,ie[$.uc]=1,ie[$.wa]=1,ie[$.Wa]=1,ie[$.wd]=1,ie[$.vc]=1,ie[$.wc]=1,ie[$.xc]=1,ie[$.Z]=1,ie[$.yc]=1,ie[$.Da]=1,ie[$.qa]=1,ie[$.Ya]=1,ie[$.Ia]=1,ie[$.Za]=1,ie[$.Pa]=1,ie[$.ma]=1,ie[$.Cc]=1,ie[$.aa]=1,ie[$.Vf]=1,ie[$.Gc]=1,ie[$.Hc]=1,ie[$.Ce]=1,ie[$.Gd]=1,ie[$.Md]=1,ie[$.Ja]=1,ie[$.Sb]=1,ie[$.Ka]=1,ie[$.La]=1,ie[$.rg]=1,ie[$.sg]=1,ie[$.ug]=1,ie[$.vg]=1,ie[$.nb]=1,ie[$.xa]=1,ie[$.xb]=1,ie[$.Ub]=1,ie[$.Ea]=1,ie[$.na]=1,ie[$.Mc]=1,ie[$.cb]=1,ie[$.ca]=1,ie[$.sa]=1,ie[$.ka]=1,ie));Object.freeze($);var oe={},ae=I.google_tag_manager=I.google_tag_manager||{};Math.random();oe.Pc="b90",oe.Xe=Number("0")||0,oe.fa="dataLayer",oe.Qh="ChEIgL3nmwYQotP4vpey3vPRARIfAFBS7Xrc2A/MOzD03PoOuOYoV6j5L8dmMGFjnquC/RoC4Nw=";var ce,se={__cl:!0,__ecl:!0,__ehl:!0,__evl:!0,__fal:!0,__fil:!0,__fsl:!0,__hl:!0,__jel:!0,__lcl:!0,__sdl:!0,__tl:!0,__ytl:!0},fe={__paused:!0,__tg:!0};for(ce in se)se.hasOwnProperty(ce)&&(fe[ce]=!0);Aa("");var le=Aa("");oe.ud="www.googletagmanager.com";var de=oe.ud+"/gtag/js",ge=null,he=null,_e={},me={},be={},pe=function(){var n=ae.sequence||1;return ae.sequence=n+1,n};oe.Ph="";oe.Vd="";var we=new ta,Ie={},Oe={},Ee={name:oe.fa,set:function(n,r){J(Ja(n,r),Ie),ue()},get:function(n){return ve(n,2)},reset:function(){we=new ta,Ie={},ue()}},ve=function(n,r){return 2!=r?we.get(n):xe(n)},xe=function(n){var r,i=n.split(".");r=r||[];for(var o=Ie,s=0;s<i.length;s++){if(null===o)return!1;if(void 0===o)break;if(o=o[i[s]],-1!==r.indexOf(o))return}return o},ye=function(n,r){Oe.hasOwnProperty(n)||(we.set(n,r),J(Ja(n,r),Ie),ue())},ue=function(n){k(Oe,(function(r,i){we.set(r,i),J(Ja(r),Ie),J(Ja(r,i),Ie),n&&delete Oe[r]}))},ze=function(n,r){var i=1!==(void 0===r?2:r)?xe(n):we.get(n);return"array"===Ib(i)||"object"===Ib(i)?J(i):i},Ce=/:[0-9]+$/,Qe=function(n,r,i){for(var o=n.split("&"),s=0;s<o.length;s++){var l=o[s].split("=");if(decodeURIComponent(l[0]).replace(/\+/g," ")===r){var v=l.slice(1).join("=");return i?v:decodeURIComponent(v).replace(/\+/g," ")}}},Te=function(n,r,i,o,s){return r&&(r=String(r).toLowerCase()),"protocol"!==r&&"port"!==r||(n.protocol=Re(n.protocol)||Re(I.location.protocol)),"port"===r?n.port=String(Number(n.hostname?n.port:I.location.port)||("http"===n.protocol?80:"https"===n.protocol?443:"")):"host"===r&&(n.hostname=(n.hostname||I.location.hostname).replace(Ce,"").toLowerCase()),Se(n,r,i,o,s)},Se=function(n,r,i,o,s){var l,v=Re(n.protocol);switch(r&&(r=String(r).toLowerCase()),r){case"url_no_fragment":l=Ue(n);break;case"protocol":l=v;break;case"host":if(l=n.hostname.replace(Ce,"").toLowerCase(),i){var d=/^www\d*\./.exec(l);d&&d[0]&&(l=l.substr(d[0].length))}break;case"port":l=String(Number(n.port)||("http"===v?80:"https"===v?443:""));break;case"path":n.pathname||n.hostname||Wa("TAGGING",1);var g=(l="/"===n.pathname.substr(0,1)?n.pathname:"/"+n.pathname).split("/");0<=(o||[]).indexOf(g[g.length-1])&&(g[g.length-1]=""),l=g.join("/");break;case"query":l=n.search.replace("?",""),s&&(l=Qe(l,s));break;case"extension":var p=n.pathname.split(".");l=(l=1<p.length?p[p.length-1]:"").split("/")[0];break;case"fragment":l=n.hash.replace("#","");break;default:l=n&&n.href}return l},Re=function(n){return n?n.replace(":","").toLowerCase():""},Ue=function(n){var r="";if(n&&n.href){var i=n.href.indexOf("#");r=0>i?n.href:n.href.substr(0,i)}return r},Ve=function(n){var r=S.createElement("a");n&&(r.href=n);var i=r.pathname;"/"!==i[0]&&(n||Wa("TAGGING",1),i="/"+i);var o=r.hostname.replace(Ce,"");return{href:r.href,protocol:r.protocol,host:r.host,hostname:o,pathname:i,search:r.search,hash:r.hash,port:r.port}},Pe="TH",ke="TH-10",Ge=new function(n,r){this.h=1933,this.defaultValue=!1}(1933),Ef=function(n){return Ef[" "](n),n};Ef[" "]=function(){};var Gf=function(){var n=Ff;if(n.kf&&n.hasOwnProperty("kf"))return n.kf;var r=new n;return n.kf=r},Ff=function(){var n={};this.h=function(){var r=Ge.h,i=Ge.defaultValue;return null!=n[r]?n[r]:i},this.m=function(){n[Ge.h]=!0}},Me=[];function If(){var n=pb("google_tag_data",{});return n.ics||(n.ics={entries:{},set:Jf,update:Kf,addListener:Lf,notifyListeners:Mf,active:!1,usedDefault:!1,usedUpdate:!1,accessedDefault:!1,accessedAny:!1,wasSetLate:!1}),n.ics}function Jf(n,r,i,o,s,l){var v=If();if(v.usedDefault||!v.accessedDefault&&!v.accessedAny||(v.wasSetLate=!0),v.active=!0,v.usedDefault=!0,null!=r){var d=v.entries,g=d[n]||{},p=g.region,_=i&&h(i)?i.toUpperCase():void 0;if(o=o.toUpperCase(),s=s.toUpperCase(),""===o||_===s||(_===o?p!==s:!_&&!p)){var m=!!(l&&0<l&&void 0===g.update),y={region:_,initial:"granted"===r,update:g.update,quiet:m};""===o&&!1===g.initial||(d[n]=y),m&&I.setTimeout((function(){d[n]===y&&y.quiet&&(y.quiet=!1,Nf(n),Mf(),Wa("TAGGING",2))}),l)}}}function Kf(n,r){var i=If();if(i.usedDefault||i.usedUpdate||!i.accessedAny||(i.wasSetLate=!0),i.active=!0,i.usedUpdate=!0,null!=r){var o=Of(i,n),s=i.entries,l=s[n]=s[n]||{};l.update="granted"===r;var v=Of(i,n);l.quiet?(l.quiet=!1,Nf(n)):v!==o&&Nf(n)}}function Lf(n,r){Me.push({bf:n,ij:r})}function Nf(n){for(var r=0;r<Me.length;++r){var i=Me[r];d(i.bf)&&-1!==i.bf.indexOf(n)&&(i.vh=!0)}}function Mf(n,r){for(var i=0;i<Me.length;++i){var o=Me[i];if(o.vh){o.vh=!1;try{o.ij({consentEventId:n,consentPriorityId:r})}catch(n){}}}}function Of(n,r){var i=n.entries[r]||{};return void 0!==i.update?i.update:i.initial}var Pf=function(n){var r=If();return r.accessedAny=!0,Of(r,n)},Rf=function(n){var r=If();return r.accessedAny=!0,!(r.entries[n]||{}).quiet},Sf=function(){if(!Gf().h())return!1;var n=If();return n.accessedAny=!0,n.active};$.F,$.R;var bg=function(n){var r=n[$.If];r&&P(40);var i=n[$.Kf];i&&P(41);for(var o=d(r)?r:[r],s={ic:0};s.ic<o.length;++(s={ic:s.ic}).ic)k(n,function(n){return function(r,s){if(r!==$.If&&r!==$.Kf){var l=o[n.ic],v=Pe,d=ke;If().set(r,s,l,v,d,i)}}}(s))},Ae=0,dg=function(n,r){k(n,(function(n,r){If().update(n,r)})),function(n,r){If().notifyListeners(n,r)}(r.eventId,r.priorityId);var i=z(),o=i-Ae;Ae&&0<=o&&1e3>o&&P(66),Ae=i},eg=function(n){var r=Pf(n);return null==r||r},jg=function(n,r,i){for(var o=[],s=r.split(";"),l=0;l<s.length;l++){var v=s[l].split("="),d=v[0].replace(/^\s*|\s*$/g,"");if(d&&d==n){var g=v.slice(1).join("=").replace(/^\s*|\s*$/g,"");g&&i&&(g=decodeURIComponent(g)),o.push(g)}}return o};function mg(n){return"null"!==n.origin}var pg=function(n,r,i,o){return ng(o)?jg(n,String(r||og()),i):[]};var og=function(){return mg(window)?window.document.cookie:""},ng=function(n){if(!Gf().h()||!n||!Sf())return!0;if(!Rf(n))return!1;var r=Pf(n);return null==r||!!r},je={M:"TAG_ID",Hb:""},Ne={sh:"TAG_ID",th:"TAG_ID"};je.Ve=Aa("");var Sg=function(){return Ne.sh?Ne.sh.split("|"):[je.M]},Tg=function(){return Ne.th?Ne.th.split("|"):(P(84),[])},Ug=function(){this.container={},this.destination={},this.canonical={}},Yg=function(){var n,r=Vg().container;for(n in r)if(r.hasOwnProperty(n)){var i=r[n];if(pa(i)){if(1===i)return!0}else if(1===i.state)return!0}return!1};function Vg(){var n=ae.tidr;return n||(n=new Ug,ae.tidr=n),n}var Le={"":"n",UA:"u",AW:"a",DC:"d",G:"e",GF:"f",GT:"t",HA:"h",MC:"m",GTM:"g",OPT:"o"},qe={UA:1,AW:2,DC:3,G:4,GF:5,GT:12,GTM:14,HA:6,MC:7};function ch(n,r){if(""===n)return r;var i=Number(n);return isNaN(i)?r:i}var dh=function(n,r,i){n.addEventListener&&n.addEventListener(r,i,!1)};function eh(){return fb("iPhone")&&!fb("iPod")&&!fb("iPad")}function fh(){eh()||fb("iPad")||fb("iPod")}fb("Opera"),fb("Trident")||fb("MSIE"),fb("Edge"),!fb("Gecko")||-1!=eb().toLowerCase().indexOf("webkit")&&!fb("Edge")||fb("Trident")||fb("MSIE")||fb("Edge"),-1!=eb().toLowerCase().indexOf("webkit")&&!fb("Edge")&&fb("Mobile"),fb("Macintosh"),fb("Windows"),fb("Linux")||fb("CrOS");var De=v.navigator||null;De&&(De.appVersion||"").indexOf("X11"),fb("Android"),eh(),fb("iPad"),fb("iPod"),fh(),eb().toLowerCase().indexOf("kaios");var oh=function(n,r){return(r=void 0===r?document:r).createElement(String(n).toLowerCase())};var sh=function(n){var r;r=void 0!==r&&r;var i="https://pagead2.googlesyndication.com/pagead/gen_204?id=tcfe";!function(n,r){if(n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&r(n[i],i,n)}(n,(function(n,r){n&&(i+="&"+r+"="+encodeURIComponent(n))})),rh(i,r)},rh=function(n,r){var i=window;r=void 0!==r&&r,i.fetch?i.fetch(n,{keepalive:!0,credentials:"include",redirect:"follow",method:"get",mode:"no-cors"}):function qh(n,r,i){n.google_image_requests||(n.google_image_requests=[]);var o=oh("IMG",n.document);if(i){var e=function(){if(i){var r=n.google_image_requests,s=y(r,o);0<=s&&Array.prototype.splice.call(r,s,1)}o.removeEventListener&&o.removeEventListener("load",e,!1),o.removeEventListener&&o.removeEventListener("error",e,!1)};dh(o,"load",e),dh(o,"error",e)}o.src=r,n.google_image_requests.push(o)}(i,n,void 0!==r&&r)},uh=function(n){return void 0!==n.addtlConsent&&"string"!=typeof n.addtlConsent&&(n.addtlConsent=void 0),void 0!==n.gdprApplies&&"boolean"!=typeof n.gdprApplies&&(n.gdprApplies=void 0),void 0!==n.tcString&&"string"!=typeof n.tcString||void 0!==n.listenerId&&"number"!=typeof n.listenerId?2:n.cmpStatus&&"error"!==n.cmpStatus?0:3},vh=function(n,r,i){this.m=n,this.h=null,this.K={},this.Ga=0,this.P=void 0===r?500:r,this.D=void 0!==i&&i,this.B=null};!function(n,r){if(n.prototype=i(r.prototype),n.prototype.constructor=n,l)l(n,r);else for(var o in r)if("prototype"!=o)if(Object.defineProperties){var s=Object.getOwnPropertyDescriptor(r,o);s&&Object.defineProperty(n,o,s)}else n[o]=r[o];n.Fk=r.prototype}(vh,(function(){})),vh.prototype.addEventListener=function(n){var r=this,i={internalBlockOnErrors:this.D},o=function(n){var r=n;return function(){if(r){var n=r;r=null,n()}}}((function(){return n(i)})),s=0;-1!==this.P&&(s=setTimeout((function(){i.tcString="tcunavailable",i.internalErrorState=1,o()}),this.P));try{wh(this,"addEventListener",(function(o,l){clearTimeout(s),o?((i=o).internalErrorState=uh(i),i.internalBlockOnErrors=r.D,l&&0===i.internalErrorState||(i.tcString="tcunavailable",l||(i.internalErrorState=3))):(i.tcString="tcunavailable",i.internalErrorState=3),n(i)}))}catch(n){i.tcString="tcunavailable",i.internalErrorState=3,s&&(clearTimeout(s),s=0),o()}},vh.prototype.removeEventListener=function(n){n&&n.listenerId&&wh(this,"removeEventListener",null,n.listenerId)};var yh=function(n,r,i){var o,s;o=void 0===o?"755":o;e:{if(n.publisher&&n.publisher.restrictions){var l=n.publisher.restrictions[r];if(void 0!==l){s=l[void 0===o?"755":o];break e}}s=void 0}if(0===s)return!1;var v,d=i;if(2===i?(d=0,2===s&&(d=1)):3===i&&(d=1,1===s&&(d=0)),0===d)if(n.purpose&&n.vendor){var g=xh(n.vendor.consents,void 0===o?"755":o);v=!(!g||"1"!==r||!n.purposeOneTreatment||"CH"!==n.publisherCC)||g&&xh(n.purpose.consents,r)}else v=!0;else v=1!==d||(!n.purpose||!n.vendor||xh(n.purpose.legitimateInterests,r)&&xh(n.vendor.legitimateInterests,void 0===o?"755":o));return v},xh=function(n,r){return!(!n||!n[r])},wh=function(n,r,i,o){if(i||(i=function(){}),"function"==typeof n.m.__tcfapi)(0,n.m.__tcfapi)(r,2,i,o);else if(zh(n)){Ah(n);var s=++n.Ga;if(n.K[s]=i,n.h){var l={};n.h.postMessage((l.__tcfapiCall={command:r,version:2,callId:s,parameter:o},l),"*")}}else i({},!1)},zh=function(n){if(n.h)return n.h;var r;e:{for(var i=n.m,o=0;50>o;++o){var s,l;try{s=!(!i.frames||!i.frames.__tcfapiLocator)}catch(n){s=!1}if(s){r=i;break e}t:{try{var v=i.parent;if(v&&v!=i){l=v;break t}}catch(n){}l=null}if(!(i=l))break}r=null}return n.h=r,n.h},Ah=function(n){n.B||(n.B=function(r){try{var i;i=("string"==typeof r.data?JSON.parse(r.data):r.data).__tcfapiReturn,n.K[i.callId](i.returnValue,i.success)}catch(n){}},dh(n.m,"message",n.B))},Bh=function(n){return!1===n.gdprApplies||(void 0===n.internalErrorState&&(n.internalErrorState=uh(n)),"error"===n.cmpStatus||0!==n.internalErrorState?!n.internalBlockOnErrors||(sh({e:String(n.internalErrorState)}),!1):"loaded"===n.cmpStatus&&("tcloaded"===n.eventStatus||"useractioncomplete"===n.eventStatus))};var Be={1:0,3:0,4:0,7:3,9:3,10:3},Ke=ch("",550);ch("",500);function Gh(){var n=ae.tcf||{};return ae.tcf=n}var Lh=function(){var n=Gh(),r=new vh(I,-1);if(!0===I.gtag_enable_tcf_support&&!n.active&&("function"==typeof I.__tcfapi||"function"==typeof r.m.__tcfapi||null!=zh(r))){n.active=!0,n.hd={},function Hh(){var n={},r=(n.ad_storage="denied",n.wait_for_update=Ke,n);bg(r)}();var i=null;n.tcString="tcunavailable";try{r.addEventListener((function(o){if(i&&(clearTimeout(i),i=null),0!==o.internalErrorState)Ih(n),Jh(n);else{var s;if(n.gdprApplies=o.gdprApplies,!1===o.gdprApplies)s=Kh(),r.removeEventListener(o);else if("tcloaded"===o.eventStatus||"useractioncomplete"===o.eventStatus||"cmpuishown"===o.eventStatus){var l,v={};for(l in Be)if(Be.hasOwnProperty(l))if("1"===l){var d,g=o,p=!0;p=void 0!==p&&p,d=!!Bh(g)&&(!1===g.gdprApplies||"tcunavailable"===g.tcString||void 0===g.gdprApplies&&!p||"string"!=typeof g.tcString||!g.tcString.length||yh(g,"1",0)),v[1]=d}else v[l]=yh(o,l,Be[l]);s=v}s&&(n.tcString=o.tcString||"tcempty",n.hd=s,Jh(n))}}))}catch(r){i&&(clearTimeout(i),i=null),Ih(n),Jh(n)}}};function Ih(n){n.type="e",n.tcString="tcunavailable"}function Kh(){var n,r={};for(n in Be)Be.hasOwnProperty(n)&&(r[n]=!0);return r}function Jh(n){var r={},i=(r.ad_storage=n.hd[1]?"granted":"denied",r);dg(i,{eventId:0},(n&&n.gdprApplies,Mh()))}var Fe,Mh=function(){var n=Gh();return n.active&&n.tcString||""},He={sampleRate:"0.005000",Kh:"",Jh:Number("5"),Ih:Number("")};(Fe=0<=S.location.search.indexOf("?gtm_latency=")||0<=S.location.search.indexOf("&gtm_latency="))||(Fe=Math.random()<He.sampleRate);var We=Fe,Je="https://www.googletagmanager.com/a?id="+je.M+"&cv=1";je.M;function Zh(){return[Je,"&v=3&t=t","&pid="+sa(),"&rv="+oe.Pc].join("")}var Xe=Zh();function ai(){Xe=Zh()}var $e={},Ze="",Ye="",et="",tt="",nt=[],rt="",it="",ot=void 0,at={},ct={},st=void 0,ut=5;0<He.Jh&&(ut=He.Jh);var ft=function(n,r){for(var i=0,o=[],s=0;s<n;++s)o.push(0);return{zj:function(){return!(i<n)&&z()-o[i%n]<1e3},Xj:function(){var r=i++%n;o[r]=z()}}}(ut),lt=1e3;function wi(n,r){var i=ot;if(void 0===i)return"";var o,s=Ya("GTM"),l=Ya("TAGGING"),v=Ya("HEALTH"),d=Xe,g=$e[i]?"":"&es=1",p=at[i],_=void 0,m=function yi(){return"&tc="+V.filter((function(n){return n})).length}(),y=Ze,w=Ye,x=it,I=void 0,S=et,E=tt,M=function Ai(n,r){var i;if(!ot||!Di(r))return"";var o=gt[ot];return i="&al="+vt.filter((function(n){return void 0!==o[n]})).map((function(n){return n+Math.floor(o[n])})).join(".")+".Z"+ht[ot],n&&delete gt[ot],i}(n,r);return[d,g,p,_,s?"&u="+s:"",l?"&ut="+l:"",v?"&h="+v:"",m,y,w,x,I,S,E,M,o,rt?"&dl="+encodeURIComponent(rt):"",0<nt.length?"&tdp="+nt.join("."):"",oe.Xe?"&x="+oe.Xe:"","&z=0"].join("")}function Ci(n){if(st&&(I.clearTimeout(st),st=void 0),void 0!==ot&&(!$e[ot]||Ze||Ye||Di(n)))if(void 0===ht[ot]&&(ct[ot]||ft.zj()||0>=lt--))P(1),ct[ot]=!0;else{void 0===ht[ot]&&ft.Xj();var r=wi(!0,n);if(n?function(n){var r;try{r=E.sendBeacon&&E.sendBeacon(n)}catch(n){Wa("TAGGING",15)}r||xb(n)}(r):xb(r),tt||rt&&0<nt.length){var i=r.replace("/a?","/td?");xb(i)}$e[ot]=!0,rt=tt=et=it=Ye=Ze="",nt=[]}}function Fi(){st||(st=I.setTimeout(Ci,500))}function Gi(n){var r=String(n[D.Ra]||"").replace(/_/g,"");return 0===r.indexOf("cvt")&&(r="cvt"),r}function Ii(){2022<=wi().length&&Ci()}var Ki=function(n,r){We&&!ct[n]&&ot!==n&&(Ci(),ot=n,et=Ze="",at[n]="&e="+function Hi(n){return n.match(/^(gtm|gtag)\./)?encodeURIComponent(n):"*"}(r)+"&eid="+n,Fi())},Li=function(n,r,i,o){if(We&&r){var s=Gi(r),l=i+s;if(!ct[n]){n!==ot&&(Ci(),ot=n),Ze=Ze?Ze+"."+l:"&tr="+l;var v=r.function;if(!v)throw Error("Error: No function name given for function call.");var d=(F[v]?"1":"2")+s;et=et?et+"."+d:"&ti="+d,Fi(),Ii()}}};var Ti=function(n,r,i){if(We&&void 0!==n&&!ct[n]){n!==ot&&(Ci(),ot=n);var o=i+r;Ye=Ye?Ye+"."+o:"&epr="+o,Fi(),Ii()}},vt=["S","P","C","Z"],dt={},gt=(dt[1]=5,dt[2]=5,dt[3]=5,{}),ht={};function Di(n){return!(!ot||!gt[ot])&&(n||"C"in gt[ot])}gb(),eh()||fb("iPod"),fb("iPad"),!fb("Android")||hb()||gb()||fb("Opera")||fb("Silk"),hb(),!fb("Safari")||hb()||fb("Coast")||fb("Opera")||fb("Edge")||fb("Edg/")||fb("OPR")||gb()||fb("Silk")||fb("Android")||fh();"platform platformVersion architecture model uaFullVersion bitness fullVersionList wow64".split(" ");var pt={};var _t=/[A-Z]+/,mt=/\s/,$k=function(n){if(h(n)){var r=(n=function(n){return n?n.replace(/^\s+|\s+$/g,""):""}(n)).indexOf("-");if(!(0>r)){var i=n.substring(0,r);if(_t.test(i)){for(var o=n.substring(r+1).split("/"),s=0;s<o.length;s++)if(!o[s]||mt.test(o[s])&&("AW"!==i||1!==s))return;return{id:n,prefix:i,U:i+"-"+o[0],I:o}}}}};var dl=function(n,r,i,o){return(2===cl()||o||"http:"!=I.location.protocol?n:r)+i},cl=function(){var n,r=function(){if(M){var n=M.toLowerCase();if(0===n.indexOf("https://"))return 2;if(0===n.indexOf("http://"))return 3}return 1}();if(1===r)e:{for(var i=de,o="https://"+(i=i.toLowerCase()),s="http://"+i,l=1,v=S.getElementsByTagName("script"),d=0;d<v.length&&100>d;d++){var g=v[d].src;if(g){if(0===(g=g.toLowerCase()).indexOf(s)){n=3;break e}1===l&&0===g.indexOf(o)&&(l=2)}}n=l}else n=r;return n};var Ll=function(n,r,i,o,s,l,v,d,g,p,_,m){this.eventId=n,this.priorityId=r,this.h=i,this.K=o,this.m=s,this.D=l,this.P=v,this.B=d,this.eventMetadata=g,this.O=p,this.N=_,this.C=m},Ql=function(n,r){this.zi=n,this.Ai=r,this.D={},this.Lg={},this.h={},this.K={},this.m={},this.Nc={},this.B={},this.kc=function(){},this.Ga=function(){},this.P=!1};RegExp("^UA-\\d+-\\d+%3A[\\w-]+(?:%2C[\\w-]+)*(?:%3BUA-\\d+-\\d+%3A[\\w-]+(?:%2C[\\w-]+)*)*$");function Gn(){return!!oe.Vd&&"SGTM_TOKEN"!==oe.Vd.split("@@").join("")}var In=function(n,r,i,o){if(!Hn()&&!function(n){return!!Vg().container[n]}(n)){var s=i?"/gtag/js":"/gtm.js",l="?id="+encodeURIComponent(n)+"&l="+oe.fa,v=0===n.indexOf("GTM-");v||(l+="&cx=c");var d=Gn();d&&(l+="&sign="+oe.Vd);var g=void 0;if(!g){var p=oe.ud+s;d&&M&&v&&(p=M.replace(/^(?:https?:\/\/)?/i,"").split(/[?#]/)[0]),g=dl("https://","http://",p+l)}Vg().container[n]={state:1,context:o},ub(g)}},Jn=function(n,r,i){var o;if(o=!Hn()){var s=Vg().destination[n];o=!(s&&s.state)}if(o)if(Yg())Vg().destination[n]={state:0,transportUrl:r,context:i},P(91);else{var l="/gtag/destination?id="+encodeURIComponent(n)+"&l="+oe.fa+"&cx=c";Gn()&&(l+="&sign="+oe.Vd);var v=void 0;v||(v=dl("https://","http://",oe.ud+l)),Vg().destination[n]={state:1,context:i},ub(v)}};function Hn(){return!1}var bt=new RegExp(/^(.*\.)?(google|youtube|blogger|withgoogle)(\.com?)?(\.[a-z]{2})?\.?$/),yt={cl:["ecl"],customPixels:["nonGooglePixels"],ecl:["cl"],ehl:["hl"],hl:["ehl"],html:["customScripts","customPixels","nonGooglePixels","nonGoogleScripts","nonGoogleIframes"],customScripts:["html","customPixels","nonGooglePixels","nonGoogleScripts","nonGoogleIframes"],nonGooglePixels:[],nonGoogleScripts:["nonGooglePixels"],nonGoogleIframes:["nonGooglePixels"]},wt={cl:["ecl"],customPixels:["customScripts","html"],ecl:["cl"],ehl:["hl"],hl:["ehl"],html:["customScripts"],customScripts:["html"],nonGooglePixels:["customPixels","customScripts","html","nonGoogleScripts","nonGoogleIframes"],nonGoogleScripts:["customScripts","html"],nonGoogleIframes:["customScripts","html","nonGoogleScripts"]},xt="google customPixels customScripts html nonGooglePixels nonGoogleScripts nonGoogleIframes".split(" "),Qn=function(n){var r=ve("gtm.allowlist")||ve("gtm.whitelist");r&&P(9),r=["google","gtagfl","lcl","zone"],It&&Pn()&&(r=[],window.console&&window.console.log&&window.console.log("GTM blocked. See go/13687728."));var i=r&&Ia(Ba(r),yt),o=ve("gtm.blocklist")||ve("gtm.blacklist");o||(o=ve("tagTypeBlacklist"))&&P(3),o?P(8):o=[],Pn()&&(o=Ba(o)).push("nonGooglePixels","nonGoogleScripts","sandboxedScripts"),0<=Ba(o).indexOf("google")&&P(2);var s=o&&Ia(Ba(o),wt),l={};return function(v){var d=v&&v[D.Ra];if(!d||"string"!=typeof d)return!0;if(d=d.replace(/^_*/,""),void 0!==l[d])return l[d];var g=me[d]||[],p=n(d,g);if(r){var _;if(_=p)e:{if(0>i.indexOf(d)){if(!(g&&0<g.length)){_=!1;break e}for(var m=0;m<g.length;m++)if(0>i.indexOf(g[m])){P(11),_=!1;break e}}_=!0}p=_}var y=!1;if(o){var w=0<=s.indexOf(d);if(w)y=w;else{var x=ua(s,g||[]);x&&P(10),y=x}}var I=!p||y;return I||!(0<=g.indexOf("sandboxedScripts"))||i&&-1!==i.indexOf("sandboxedScripts")||(I=ua(s,xt)),l[d]=I}},It=!1,Pn=function(){return bt.test(I.location&&I.location.hostname)},St={initialized:11,complete:12,interactive:13},Ot={},Et=Object.freeze((Ot[$.xa]=!0,Ot)),Ct=0<=S.location.search.indexOf("?gtm_diagnostics=")||0<=S.location.search.indexOf("&gtm_diagnostics=");function Vn(n,r,i,o){if(i=void 0===i?{}:i,o=void 0===o?"":o,n===r)return[];var s,e=function(n,r){var i=r[n];return void 0===i?Et[n]:i};for(s in function Xn(n,r){var i,o={};for(i in r)r.hasOwnProperty(i)&&(o[i]=!0);for(var s in n)n.hasOwnProperty(s)&&(o[s]=!0);return o}(n,r)){var l=(o?o+".":"")+s,v=e(s,n),d=e(s,r),g="object"===Ib(v)||"array"===Ib(v),p="object"===Ib(d)||"array"===Ib(d);g&&p?Vn(v,d,i,l):(g||p||v!==d)&&(i[l]=!0)}return Object.keys(i)}var Pt=!1,kt=0,Gt=[];function ao(n){if(!Pt){var r=S.createEventObject,i="complete"==S.readyState,o="interactive"==S.readyState;if(!n||"readystatechange"!=n.type||i||!r&&o){Pt=!0;for(var s=0;s<Gt.length;s++)G(Gt[s])}Gt.push=function(){for(var n=0;n<arguments.length;n++)G(arguments[n]);return 0}}}function bo(){if(!Pt&&140>kt){kt++;try{S.documentElement.doScroll("left"),ao()}catch(n){I.setTimeout(bo,50)}}}var go=function(n,r){this.h=!1,this.D=[],this.K={tags:[]},this.P=!1,this.m=this.B=0,fo(this,n,r)},io=function(n,r,i,o){var s=n.K.tags[r];s&&(s.status=i,s.executionTime=o)},jo=function(n){if(!n.h){for(var r=n.D,i=0;i<r.length;i++)r[i]();n.h=!0,n.D.length=0}},fo=function(n,r,i){void 0!==r&&ko(n,r),i&&I.setTimeout((function(){return jo(n)}),Number(i))},ko=function(n,r){var i=Fa((function(){return G((function(){r(je.M,n.K)}))}));n.h?i():n.D.push(i)},lo=function(n){return n.B++,Fa((function(){n.m++,n.P&&n.m>=n.B&&jo(n)}))};function Do(n,r,i,o){var s=V[n],l=function Eo(n,r,i,o){function e(){if(s[D.Fi])v();else{var r=wc(s,i,[]),o=r[D.Oh];if(null!=o)for(var d=0;d<o.length;d++)if(!eg(o[d]))return void v();var g=function(n,r,i,o){if(fe.hasOwnProperty(r)||"__zone"===r)return-1;var s={};return Kb(o)&&(s=J(o,s)),s.id=i,s.status="timeout",n.K.tags.push(s)-1}(i.zb,String(s[D.Ra]),Number(s[D.Qc]),r[D.Gi]),p=!1;r.vtp_gtmOnSuccess=function(){if(!p){p=!0;var r=z()-_;Li(i.id,V[n],"5"),io(i.zb,g,"success",r),l()}},r.vtp_gtmOnFailure=function(){if(!p){p=!0;var r=z()-_;Li(i.id,V[n],"6"),io(i.zb,g,"failure",r),v()}},r.vtp_gtmTagId=s.tag_id,r.vtp_gtmEventId=i.id,i.priorityId&&(r.vtp_gtmPriorityId=i.priorityId),Li(i.id,s,"1");var C=function(){var n=z()-_;Li(i.id,s,"7"),io(i.zb,g,"exception",n),p||(p=!0,v())},_=z();try{uc(r,{event:i,index:n,type:1})}catch(n){C(n)}}}var s=V[n],l=r.O,v=r.N,d=r.terminate;if(i.nf(s))return null;var g=vc(s[D.Xg],i,[]);if(g&&g.length){var p=g[0],_=Do(p.index,{O:l,N:v,terminate:d},i,o);if(!_)return null;l=_,v=2===p.jh?d:_}if(s[D.Sg]||s[D.Ii]){var m=s[D.Sg]?K:i.lk,y=l,w=v;if(!m[n]){e=Fa(e);var x=function Fo(n,r,i){var o=[],s=[];return r[n]=function Go(n,r,i){return function(o,s){n.push(o),r.push(s),i()}}(o,s,i),{O:function(){r[n]=Ho;for(var i=0;i<o.length;i++)o[i]()},N:function(){r[n]=Io;for(var i=0;i<s.length;i++)s[i]()}}}(n,m,e);l=x.O,v=x.N}return function(){m[n](y,w)}}return e}(n,r,i,o);if(!l)return null;var v=vc(s[D.Wg],i,[]);if(v&&v.length){var d=v[0];l=Do(d.index,{O:l,N:1===d.jh?r.terminate:l,terminate:r.terminate},i,o)}return l}function Ho(n){n()}function Io(n,r){r()}function Jo(n){return arguments}var Mo=function(){this.h=[],this.m=[]};Mo.prototype.enqueue=function(n,r,i){var o=this.h.length+1;n["gtm.uniqueEventId"]=r,n["gtm.priorityId"]=o,i.eventId=r,i.fromContainerExecution=!0,i.priorityId=o;var s={message:n,notBeforeEventId:r,priorityId:o,messageContext:i};this.h.push(s);for(var l=0;l<this.m.length;l++)try{this.m[l](s)}catch(n){}},Mo.prototype.listen=function(n){this.m.push(n)},Mo.prototype.get=function(){for(var n={},r=0;r<this.h.length;r++){var i=this.h[r],o=n[i.notBeforeEventId];o||(o=[],n[i.notBeforeEventId]=o),o.push(i)}return n},Mo.prototype.prune=function(n){for(var r=[],i=[],o=0;o<this.h.length;o++){var s=this.h[o];s.notBeforeEventId===n?r.push(s):i.push(s)}return this.h=i,r};function No(){var n=ae.mb;return n||(n=new Mo,ae.mb=n),n}var Yo=function(n){var r=ae.zones;return r?r.getIsAllowedFn(Sg(),n):function(){return!0}};function ap(n,r){var i,o,s=r.wh,l=n.wh;if(0!==(i=s>l?1:s<l?-1:0))o=i;else{var v=n.Fh,d=r.Fh;o=v>d?1:v<d?-1:0}return o}function $o(n,r){if(We){var c=function(n){var i=r.nf(V[n])?"3":"4",o=vc(V[n][D.Wg],r,[]);o&&o.length&&c(o[0].index),Li(r.id,V[n],i);var s=vc(V[n][D.Xg],r,[]);s&&s.length&&c(s[0].index)};c(n)}}var Mt=!1,Hp=function(n){z();var r=n["gtm.uniqueEventId"],i=n["gtm.priorityId"],o=n.event;if("gtm.js"===o){if(Mt)return!1;Mt=!0}var s,l=!1;if(function(n){var r=ae.zones;return!r||r.isActive(Sg(),n)}(r))s=Yo(r);else{if("gtm.js"!==o&&"gtm.init"!==o&&"gtm.init_consent"!==o)return!1;l=!0,s=Yo(Number.MAX_SAFE_INTEGER)}Ki(r,o);var v=n.eventCallback,d=n.eventTimeout,g=v,p={id:r,priorityId:i,name:o,nf:Qn(s),lk:[],qh:function(){P(6),Wa("HEALTH",0)},bh:fp(),dh:Ep(r),zb:new go(g,d)},_=function(n){function b(n){for(var r=0;r<n.length;r++)i[n[r]]=!0}for(var r=[],i=[],o=yc(n),s=0;s<R.length;s++){var l=R[s],v=zc(l,o);if(v){for(var d=l.add||[],g=0;g<d.length;g++)r[d[g]]=!0;b(l.block||[])}else null===v&&b(l.block||[])}for(var p=[],_=0;_<V.length;_++)r[_]&&!i[_]&&(p[_]=!0);return p}(p);l&&(_=function Fp(n){for(var r=[],i=0;i<n.length;i++)if(n[i]){var o=String(V[i][D.Ra]);(se[o]||void 0!==V[i][D.Ji]||be[o])&&(r[i]=!0),O(58)||0!==V[i][D.Ra].indexOf("__ccd")&&0!==V[i][D.Ra].indexOf("__ogt")&&"__set_product_settings"!==V[i][D.Ra]||(r[i]=!0)}return r}(_));var m=function(n,r){for(var i=[],o=0;o<V.length;o++)if(n[o]){var s=V[o],l=lo(r.zb);try{var v=Do(o,{O:l,N:l,terminate:l},r,o);if(v){var d=i,g=d.push,p=o,_=s.function;if(!_)throw"Error: No function name given for function call.";var m=F[_];g.call(d,{Fh:p,wh:m&&m.priorityOverride||0,execute:v})}else $o(o,r),l()}catch(n){l()}}i.sort(ap);for(var y=0;y<i.length;y++)i[y].execute();return 0<i.length}(_,p);return function(n){n.P=!0,n.m>=n.B&&jo(n)}(p.zb),"gtm.js"!==o&&"gtm.sync"!==o||je.M,function Gp(n,r){if(!r)return r;for(var i=0;i<n.length;i++)if(n[i]&&V[i]&&!fe[String(V[i][D.Ra])])return!0;return!1}(_,m)||!1};function Ep(n){return function(n){We&&Lb(n)}}function fp(){var n={};return n.event=ze("event",1),n.ecommerce=ze("ecommerce",1),n.gtm=ze("gtm"),n.eventModel=ze("eventModel"),n}var Jp=function(n,r,i,o){At.push("event",[r,n],i,o)},Lp=function(){this.status=1,this.D={},this.h={},this.K={},this.P=null,this.B={},this.m=!1},Mp=function(n,r,i,o){var s=z();this.type=n,this.m=s,this.W=r||"",this.h=i,this.messageContext=o},Np=function(){this.m={},this.B={},this.h=[]},Op=function(n,r){var i=$k(r);return n.m[i.U]=n.m[i.U]||new Lp},Pp=function(n,r,i,o){if(o.W){var s=Op(n,o.W),l=s.P;if(l){var v=J(i),d=J(s.D[o.W]),g=J(s.B),p=J(s.h),_=J(n.B),m={};if(We)try{m=J(Ie)}catch(n){P(72)}var y=$k(o.W).prefix,u=function(n){Ti(o.messageContext.eventId,y,n);var r=v[$.Nb];r&&G(r)},w=function(n){return new Ll(n.zi,n.Ai,n.D,n.Lg,n.h,n.K,n.m,n.Nc,n.B,n.kc,n.Ga,n.P)}(function(n,r){return n.Ga=r,n}(function(n,r){return n.kc=r,n}(function(n,r){return n.B=r||{},n}(function(n,r){return n.m=r,n}(function(n,r){return n.K=r,n}(function(n,r){return n.Nc=r,n}(function(n,r){return n.h=r,n}(function(n,r){return n.Lg=r,n}(function(n,r){return n.D=r,n}(new Ql(o.messageContext.eventId,o.messageContext.priorityId),v),d),g),p),_),m),o.messageContext.eventMetadata),(function(){if(u){var n=u;u=void 0,n("2")}})),(function(){if(u){var n=u;u=void 0,n("3")}})));try{Ti(o.messageContext.eventId,y,"1"),function(n,r,i){if(We&&"config"===n&&!(1<$k(r).I.length)){var o,s=pb("google_tag_data",{});s.td||(s.td={}),o=s.td;var l=J(i.D);J(i.h,l);var v,d=[];for(v in o){var g=Vn(o[v],l);g.length&&(Ct&&console.log(g),d.push(v))}if(d.length){if(d.length){var p=r+"*"+d.join(".");tt=tt?tt+"!"+p:"&tdc="+p}Wa("TAGGING",St[S.readyState]||14)}o[r]=l}}(o.type,o.W,w),l(o.W,r,o.m,w)}catch(n){Ti(o.messageContext.eventId,y,"4")}}}};Np.prototype.register=function(n,r,i){var o=Op(this,n);3!==o.status&&(o.P=r,o.status=3,i&&(J(o.h,i),o.h=i),this.flush())},Np.prototype.push=function(n,r,i,o){if(void 0!==i){if(!$k(i))return;if(i){var s=$k(i);s&&1===Op(this,i).status&&(Op(this,i).status=2,this.push("require",[{}],s.U,{}))}Op(this,i).m&&(o.deferrable=!1)}this.h.push(new Mp(n,i,r,o)),o.deferrable||this.flush()},Np.prototype.flush=function(n){for(var r=this,i=[],o=!1,s={};this.h.length;){var l=this.h[0];if(l.messageContext.deferrable)!l.W||Op(this,l.W).m?(l.messageContext.deferrable=!1,this.h.push(l)):i.push(l),this.h.shift();else{var v=void 0;switch(l.type){case"require":if(3!==(v=Op(this,l.W)).status&&!n)return void this.h.push.apply(this.h,i);break;case"set":k(l.h[0],(function(n,i){J(Ja(n,i),r.B)}));break;case"config":v=Op(this,l.W),s.hb={},k(l.h[0],function(n){return function(r,i){J(Ja(r,i),n.hb)}}(s));var d=!!s.hb[$.Mc];delete s.hb[$.Mc];var g=$k(l.W),p=g.U===g.id;d||(p?v.B={}:v.D[l.W]={}),v.m&&d||Pp(this,$.va,s.hb,l),v.m=!0,p?J(s.hb,v.B):(J(s.hb,v.D[l.W]),P(70)),o=!0;break;case"event":v=Op(this,l.W),s.nd={},k(l.h[0],function(n){return function(r,i){J(Ja(r,i),n.nd)}}(s)),Pp(this,l.h[1],s.nd,l);break;case"get":v=Op(this,l.W);var _={},m=(_[$.Qa]=l.h[0],_[$.ab]=l.h[1],_);Pp(this,$.Ca,m,l)}this.h.shift(),Qp(this,l)}s={hb:s.hb,nd:s.nd}}this.h.push.apply(this.h,i),o&&this.flush()};var Qp=function(n,r){if("require"!==r.type)if(r.W)for(var i=Op(n,r.W).K[r.type]||[],o=0;o<i.length;o++)i[o]();else for(var s in n.m)if(n.m.hasOwnProperty(s)){var l=n.m[s];if(l&&l.K)for(var v=l.K[r.type]||[],d=0;d<v.length;d++)v[d]()}},At=new Np,Tt={},jt={},Nt="HA GF G UA AW DC MC".split(" "),Lt=!1,qt=!1;function $p(n,r){return n.hasOwnProperty("gtm.uniqueEventId")||Object.defineProperty(n,"gtm.uniqueEventId",{value:pe()}),r.eventId=n["gtm.uniqueEventId"],r.priorityId=n["gtm.priorityId"],{eventId:r.eventId,priorityId:r.priorityId}}var Dt={config:function(n,r){var i=$p(n,r);if(!(2>n.length)&&h(n[1])){var o={};if(2<n.length){if(null!=n[2]&&!Kb(n[2])||3<n.length)return;o=n[2]}var s=$k(n[1]);if(s){Ki(i.eventId,"gtag.config");var l=s.U,v=s.id!==l;if(v?-1===Tg().indexOf(l):-1===Sg().indexOf(l)){if(!O(61)||!o[$.Md]){var d=o[$.na]||At.B[$.na];v?Jn(l,d,{source:2,fromContainerExecution:r.fromContainerExecution}):In(l,0,!0,{source:2,fromContainerExecution:r.fromContainerExecution})}}else{if(le&&!v&&!o[$.Mc]){var g=qt;if(qt=!0,g)return}if(Lt||P(43),!r.noTargetGroup)if(v){!function(n){k(jt,(function(r,i){var o=i.indexOf(n);0<=o&&i.splice(o,1)}))}(s.id);var p=s.id,_=o[$.Kd]||"default";_=String(_).split(",");for(var m=0;m<_.length;m++){var y=jt[_[m]]||[];jt[_[m]]=y,0>y.indexOf(p)&&y.push(p)}}else{!function(n){k(Tt,(function(r,i){var o=i.indexOf(n);0<=o&&i.splice(o,1)}))}(s.id);var w=s.id,x=o[$.Kd]||"default";x=x.toString().split(",");for(var I=0;I<x.length;I++){var S=Tt[x[I]]||[];Tt[x[I]]=S,0>S.indexOf(w)&&S.push(w)}}delete o[$.Kd];var E=r.eventMetadata||{};E.hasOwnProperty("is_external_event")||(E.is_external_event=!r.fromContainerExecution),r.eventMetadata=E,delete o[$.Nb];for(var M=v?[s.id]:Tg(),A=0;A<M.length;A++){var T=J(r);At.push("config",[o],M[A],T)}}}}},consent:function(n,r){if(3===n.length){P(39);var i=$p(n,r),o=n[1];"default"===o?bg(n[2]):"update"===o&&dg(n[2],i)}},event:function(n,r){var i=n[1];if(!(2>n.length)&&h(i)){var o;if(2<n.length){if(!Kb(n[2])&&null!=n[2]||3<n.length)return;o=n[2]}var s=o,l={},v=(l.event=i,l);s&&(v.eventModel=J(s),s[$.Nb]&&(v.eventCallback=s[$.Nb]),s[$.Fd]&&(v.eventTimeout=s[$.Fd]));var g,p=$p(n,r),_=p.eventId,m=p.priorityId;if(v["gtm.uniqueEventId"]=_,m&&(v["gtm.priorityId"]=m),"optimize.callback"===i)return v.eventModel=v.eventModel||{},v;var y=o,w=y&&y[$.xb];if(void 0===w&&(void 0===(w=ve($.xb,2))&&(w="default")),h(w)||d(w)){var x=function(n){for(var r=[],i=[],o={},s=0;s<n.length;o={sd:o.sd,pd:o.pd},s++){var l=n[s];if(0<=l.indexOf("-")){if(o.sd=$k(l),o.sd){var v=Tg();ra(v,function(n){return function(r){return n.sd.U===r}}(o))?r.push(l):i.push(l)}}else{var d=Tt[l]||[];o.pd={},d.forEach(function(n){return function(r){return n.pd[r]=!0}}(o));for(var g=Sg(),p=0;p<g.length;p++)if(o.pd[g[p]]){r=r.concat(Tg());break}var _=jt[l]||[];_.length&&(r=r.concat(_))}}return{Ij:r,Kj:i}}(w.toString().replace(/\s+/g,"").split(",")),I=x.Ij,S=x.Kj;if(S.length)for(var E=y&&y[$.na]||At.B[$.na],M=0;M<S.length;M++){var A=$k(S[M]);A&&Jn(A.U,E,{source:3,fromContainerExecution:r.fromContainerExecution})}g=function(n){for(var r={},i=0;i<n.length;++i){var o=$k(n[i]);o&&(r[o.id]=o)}!function al(n){var r,i=[];for(r in n)if(n.hasOwnProperty(r)){var o=n[r];"AW"===o.prefix&&o.I[1]&&i.push(o.U)}for(var s=0;s<i.length;++s)delete n[i[s]]}(r);var s=[];return k(r,(function(n,r){s.push(r)})),s}(I)}else g=void 0;var T=g;if(T){Ki(_,i);for(var j=[],N=0;N<T.length;N++){var L=T[N],q=J(r);if(-1!==Nt.indexOf(L.prefix)){var D=J(o),U=q.eventMetadata||{};U.hasOwnProperty("is_external_event")||(U.is_external_event=!q.fromContainerExecution),q.eventMetadata=U,delete D[$.Nb],Jp(i,D,L.id,q)}j.push(L.id)}return v.eventModel=v.eventModel||{},0<T.length?v.eventModel[$.xb]=j.join():delete v.eventModel[$.xb],Lt||P(43),r.noGtmEvent?void 0:v}}},get:function(n,r){if(P(53),4===n.length&&h(n[1])&&h(n[2])&&oa(n[3])){var i=$k(n[1]),o=String(n[2]),s=n[3];if(i){Lt||P(43);var l=At.B[$.na];if(ra(Tg(),(function(n){return i.U===n}))){if(-1!==Nt.indexOf(i.prefix)){$p(n,r);var v={};J((v[$.Qa]=o,v[$.ab]=s,v)),function(n,r,i,o){At.push("get",[n,r],i,o)}(o,(function(n){G((function(){return s(n)}))}),i.id,r)}}else Jn(i.U,l,{source:4,fromContainerExecution:r.fromContainerExecution})}}},js:function(n,r){if(2==n.length&&n[1].getTime){Lt=!0;var i=$p(n,r),o=i.eventId,s=i.priorityId,l={event:"gtm.js"};return l["gtm.start"]=n[1].getTime(),l["gtm.uniqueEventId"]=o,l["gtm.priorityId"]=s,l}},policy:function(){},set:function(n,r){var i;if(2==n.length&&Kb(n[1])?i=J(n[1]):3==n.length&&h(n[1])&&(i={},Kb(n[2])||d(n[2])?i[n[1]]=J(n[2]):i[n[1]]=n[2]),i){var o=$p(n,r),s=o.eventId,l=o.priorityId;J(i);var v=J(i);return At.push("set",[v],void 0,r),i["gtm.uniqueEventId"]=s,l&&(i["gtm.priorityId"]=l),O(30)&&delete i.event,r.overwriteModelFields=!0,i}}},Ut={policy:!0},Rt=!1,Bt=[];function gq(){if(!Rt){Rt=!0;for(var n=0;n<Bt.length;n++)G(Bt[n])}}var yq=function(n){if(xq(n))return n;this.h=n};yq.prototype.getUntrustedMessageValue=function(){return this.h};var xq=function(n){return!(!n||"object"!==Ib(n)||Kb(n))&&"getUntrustedMessageValue"in n};yq.prototype.getUntrustedMessageValue=yq.prototype.getUntrustedMessageValue;var Vt=0,zt={},Kt=[],Ft=[],Ht=!1,Wt=!1;function Fq(n,r){return n.messageContext.eventId-r.messageContext.eventId||n.messageContext.priorityId-r.messageContext.priorityId}function Iq(n,r){var i=n._clear||r.overwriteModelFields;k(n,(function(n,r){"_clear"!==n&&(i&&ye(n),ye(n,r))})),ge||(ge=n["gtm.start"]);var o=n["gtm.uniqueEventId"];return!!n.event&&("number"!=typeof o&&(o=pe(),n["gtm.uniqueEventId"]=o,ye("gtm.uniqueEventId",o)),Hp(n))}function Kq(){var n,r;if(Ft.length)n=Ft.shift();else{if(!Kt.length)return;n=Kt.shift()}var i=n;if(Ht||!function Jq(n){if(null==n||"object"!=typeof n)return!1;if(n.event)return!0;if(xa(n)){var r=n[0];if("config"===r||"event"===r||"js"===r||"get"===r)return!0}return!1}(i.message))r=i;else{Ht=!0;var o=i.message["gtm.uniqueEventId"];"number"!=typeof o&&(o=i.message["gtm.uniqueEventId"]=pe());var s={},l={message:(s.event="gtm.init_consent",s["gtm.uniqueEventId"]=o-2,s),messageContext:{eventId:o-2}},v={},d={message:(v.event="gtm.init",v["gtm.uniqueEventId"]=o-1,v),messageContext:{eventId:o-1}};if(Kt.unshift(d,i),We&&je.M){var g;if(je.Ve){var p=je.M,_=Vg().destination[p];g=_&&_.context}else{var m=je.M,y=Vg().container[m];g=y&&y.context}var w,x=g,S=Ve(I.location.href);w=S.hostname+S.pathname;var E=x&&x.fromContainerExecution,M=x&&x.source,A=je.M,T=je.Hb,j=je.Ve;rt||(rt=w),nt.push(A+";"+T+";"+(E?1:0)+";"+(M||0)+";"+(j?1:0))}r=l}return r}function Lq(){for(var n,r=!1;!Wt&&(n=Kq());){Wt=!0,delete Ie.eventModel,ue();var i=n,o=i.message,s=i.messageContext;if(null==o)Wt=!1;else{if(s.fromContainerExecution)for(var l=["gtm.allowlist","gtm.blocklist","gtm.whitelist","gtm.blacklist","tagTypeBlacklist"],v=0;v<l.length;v++){var g=l[v],p=ve(g,1);(d(p)||Kb(p))&&(p=J(p)),Oe[g]=p}try{if(oa(o))try{o.call(Ee)}catch(n){}else if(d(o)){var _=o;if(h(_[0])){var m=_[0].split("."),y=m.pop(),w=_.slice(1),x=ve(m.join("."),2);if(null!=x)try{x[y].apply(x,w)}catch(n){}}}else{var I=void 0,S=!1;if(xa(o)){e:{if(o.length&&h(o[0])){var E=Dt[o[0]];if(E&&(!s.fromContainerExecution||!Ut[o[0]])){I=E(o,s);break e}}I=void 0}(S=I&&"set"===o[0]&&!!I.event)&&P(101)}else I=o;if(I){var M=Iq(I,s);r=M||r,S&&M&&P(113)}}}finally{s.fromContainerExecution&&ue(!0);var A=o["gtm.uniqueEventId"];if("number"==typeof A){for(var T=zt[String(A)]||[],j=0;j<T.length;j++)Ft.push(Mq(T[j]));T.length&&Ft.sort(Fq),delete zt[String(A)],A>Vt&&(Vt=A)}Wt=!1}}}return!r}function Nq(){var n=Lq();try{!function(n){var r=I[oe.fa].hide;if(r&&void 0!==r[n]&&r.end){r[n]=!1;var i,o=!0;for(i in r)if(r.hasOwnProperty(i)&&!0===r[i]){o=!1;break}o&&(r.end(),r.end=null)}}(je.M)}catch(n){}return n}function Po(n){if(Vt<n.notBeforeEventId){var r=String(n.notBeforeEventId);zt[r]=zt[r]||[],zt[r].push(n)}else Ft.push(Mq(n)),Ft.sort(Fq),G((function(){Wt||Lq()}))}function Mq(n){return{message:n.message,messageContext:n.messageContext}}var Pq=function(){function a(n){var r={};if(xq(n)){var i=n;n=xq(i)?i.getUntrustedMessageValue():void 0,r.fromContainerExecution=!0}return{message:n,messageContext:r}}var n=pb(oe.fa,[]),r=ae[oe.fa]=ae[oe.fa]||{};!0===r.pruned&&P(83),zt=No().get(),function(){var n=Po;No().listen(n)}(),function(n){Pt?n():Gt.push(n)}((function(){if(!r.gtmDom){r.gtmDom=!0;var i={};n.push((i.event="gtm.dom",i))}})),function(n){Rt?G(n):Bt.push(n)}((function(){if(!r.gtmLoad){r.gtmLoad=!0;var i={};n.push((i.event="gtm.load",i))}})),r.subscribers=(r.subscribers||0)+1;var i=n.push;n.push=function(){var o;if(0<ae.SANDBOXED_JS_SEMAPHORE){o=[];for(var s=0;s<arguments.length;s++)o[s]=new yq(arguments[s])}else o=[].slice.call(arguments,0);var l=o.map((function(n){return a(n)}));Kt.push.apply(Kt,l);var v=i.apply(n,o),d=Math.max(100,Number("1000")||300);if(this.length>d)for(P(4),r.pruned=!0;this.length>d;)this.shift();var g="boolean"!=typeof v||v;return Lq()&&g};var o=n.slice(0).map((function(n){return a(n)}));Kt.push.apply(Kt,o),Oq()&&G(Nq)},Oq=function(){return!0};function Qq(n){if(null==n||0===n.length)return!1;var r=Number(n),i=z();return r<i+3e5&&r>i-9e5}var Jt={};Jt.Rd=new String("undefined");I.clearTimeout,I.setTimeout;var Xt=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"];var Qt=new ta;function hs(n){return function is(n){var r=n.arg0,i=n.arg1;if(n.any_of&&Array.isArray(i)){for(var o=0;o<i.length;o++){var s=J(n,{});if(J({arg1:i[o],any_of:void 0},s),hs(s))return!0}return!1}switch(n.function){case"_cn":return 0<=String(r).indexOf(String(i));case"_css":var l;e:{if(r)try{for(var v=0;v<Xt.length;v++){var d=Xt[v];if(r[d]){l=r[d](i);break e}}}catch(n){}l=!1}return l;case"_ew":return function ds(n,r){n=String(n),r=String(r);var i=n.length-r.length;return 0<=i&&n.indexOf(r,i)===i}(r,i);case"_eq":return String(r)===String(i);case"_ge":return Number(r)>=Number(i);case"_gt":return Number(r)>Number(i);case"_lc":return 0<=String(r).split(",").indexOf(String(i));case"_le":return Number(r)<=Number(i);case"_lt":return Number(r)<Number(i);case"_re":return function fs(n,r,i){var o=i?"i":void 0;try{var s=String(r)+o,l=Qt.get(s);return l||(l=new RegExp(r,o),Qt.set(s,l)),l.test(n)}catch(n){return!1}}(r,i,n.ignore_case);case"_sw":return 0===String(r).indexOf(String(i));case"_um":return function gs(n,r){function c(n){var r=Ve(n),i=Te(r,"protocol"),o=Te(r,"host",!0),s=Te(r,"port");return(void 0===i||"http"===i&&"80"===s||"https"===i&&"443"===s)&&(i="web",s="default"),[i,o,s,Te(r,"path").toLowerCase().replace(/\/$/,"")]}for(var i=c(String(n)),o=c(String(r)),s=0;s<i.length;s++)if(i[s]!==o[s])return!1;return!0}(r,i)}return!1}(n)?1:0}Object.freeze({dl:1,id:1}),Object.freeze(["config","event","get","set"]);window,document;encodeURI,encodeURIComponent;var $t={o:{}};$t.o.e=["google"],$t.__e=function(n){return String(n.vtp_gtmCachedValues.event)},$t.__e.s="e",$t.__e.isVendorTemplate=!0,$t.__e.priorityOverride=0,$t.__e.isInfrastructure=!1,$t.o.v=["google"],$t.__v=function(n){var r=n.vtp_name;if(!r||!r.replace)return!1;var i=function(n,r){return ve(n,r||2)}(r.replace(/\\\./g,"."),n.vtp_dataLayerVersion||1),o=void 0!==i?i:n.vtp_defaultValue;return function(n,r,i){We&&Lb(n)}(o,0,n.vtp_gtmEventId),o},$t.__v.s="v",$t.__v.isVendorTemplate=!0,$t.__v.priorityOverride=0,$t.__v.isInfrastructure=!1,$t.o.get=["google"],$t.__get=function(n){var r=n.vtp_settings,i=r.eventParameters||{},o=String(n.vtp_eventName),s={};s.eventId=n.vtp_gtmEventId,s.priorityId=n.vtp_gtmPriorityId,n.vtp_deferrable&&(s.deferrable=!0);var l=function(n,r,i){return(i=i||{})[$.xb]=n,Jo("event",r,i)}(String(r.streamId),o,i);(function(n,r,i){No().enqueue(n,r,i)})(l,s.eventId,s),n.vtp_gtmOnSuccess()},$t.__get.s="get",$t.__get.isVendorTemplate=!0,$t.__get.priorityOverride=0,$t.__get.isInfrastructure=!1;var Zt={};function ox(){ae[je.M]=ae[je.M]||Zt,je.Hb&&(ae["ctid_"+je.Hb]=Zt),function(){for(var n=Vg(),r=Sg(),i=0;i<r.length;i++){var o=n.container[r[i]];!o||pa(o)?n.container[r[i]]={state:2}:o.state=2}for(var s=Tg(),l=0;l<s.length;l++){var v=n.destination[s[l]];v&&0===v.state&&P(93),v?v.state=2:n.destination[s[l]]={state:2}}n.canonical[je.Hb]=2}(),Yg()||k(function(){var n={};return k(Vg().destination,(function(r,i){0===i.state&&(n[r]=i)})),n}(),(function(n,r){Jn(n,r.transportUrl,r.context),P(92)})),Ga(me,$t.o),L=H}Zt.dataLayer=Ee,Zt.callback=function(n){_e.hasOwnProperty(n)&&oa(_e[n])&&_e[n](),delete _e[n]},Zt.bootstrap=0,Zt._spx=!1,function(n){function b(){Qq(v=S.documentElement.getAttribute("data-tag-assistant-present"))&&(l=s.xi)}if(!I.__TAGGY_INSTALLED){var r=!1;if(S.referrer){var i=Ve(S.referrer);r="cct.google"===Se(i,"host")}if(!r){var o=pg("googTaggyReferrer");r=o.length&&o[0].length}r&&(I.__TAGGY_INSTALLED=!0,ub("https://cct.google/taggy/agent.js"))}var f=function(r){var i="GTM",o="GTM";i="OGT",o="GTAG";var s=I["google.tagmanager.debugui2.queue"];s||(s=[],I["google.tagmanager.debugui2.queue"]=s,ub("https://"+oe.ud+"/debug/bootstrap?id="+je.M+"&src="+o+"&cond="+r+"&gtm="+function(n){var r=je.M.split("-"),i=r[0].toUpperCase();if(O(45)){var o,s={};s.aj=je.M,s.bk=oe.Xe,s.fk=oe.Pc,s.Hj=je.Ve?2:1,s.pe=qe[i],s.pe||(s.pe=0),s.tf=3;var l=s.pe,v=s.tf;void 0===l?o="":(v||(v=0),o=""+$c(1,1)+"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_"[l<<2|v]);var d,g=s.zk,p=4+o+(g?""+$c(2,1)+"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_"[g]:""),_=s.fk;d=_&&X.test(_)?""+$c(3,2)+_:"";var m,y,w=s.bk;m=w?""+$c(4,1)+"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_"[w]:"";var x=s.aj;if(x&&n){var I=x.split("-"),S=I[0].toUpperCase();if("GTM"!==S&&"OPT"!==S)y="";else{var E=I[1];y=""+$c(5,3)+"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_"[1+E.length]+(s.Hj||0)+E}}else y="";return p+d+m+y}var M=Le[i]||"i",A=n&&"GTM"===i||"OPT"===i?r[1]:"";return"2o"+M+(4===oe.Pc.length?oe.Pc.slice(1):oe.Pc)+A}()));var l={messageType:"CONTAINER_STARTING",data:{scriptSource:M,containerProduct:i,debug:!1,id:je.M,isGte:le}};l.data.resume=function(){n()},oe.Ph&&(l.data.initialPublish=!0),s.push(l)},s={uk:1,yi:2,Ki:3,Rh:4,xi:5},l=void 0,v=void 0;if(Qq(Te(I.location,"query",!1,void 0,"gtm_debug"))&&(l=s.yi),!l&&S.referrer){var d=Ve(S.referrer);"tagassistant.google.com"===Se(d,"host")&&(l=s.Ki)}if(!l){var g=pg("__TAG_ASSISTANT");g.length&&g[0].length&&(l=s.Rh)}if(l||b(),!l&&O(54)&&function Rq(n){return!(!n||0!==n.indexOf("pending:"))&&Qq(n.substr(8))}(v)){var t=function(){if(p)return!0;p=!0,b(),l&&M?f(l):n()},p=!1;yb(S,"TADebugSignal",(function(){t()}),!1),I.setTimeout((function(){t()}),200)}else l&&M?f(l):n()}((function(){if(Gf().m(),Lh(),pt.enable_gbraid_cookie_write=!0,je.Hb?ae["ctid_"+je.Hb]:ae[je.M]){var n=ae.zones;n&&n.unregisterChild(Sg())}else{for(var i=r.resource||{},o=i.macros||[],s=0;s<o.length;s++)U.push(o[s]);for(var l=i.tags||[],v=0;v<l.length;v++)V.push(l[v]);for(var d=i.predicates||[],g=0;g<d.length;g++)B.push(d[g]);for(var p=i.rules||[],_=0;_<p.length;_++){for(var m=p[_],y={},w=0;w<m.length;w++)y[m[w][0]]=Array.prototype.slice.call(m[w],1);R.push(y)}if(F=$t,j=hs,ox(),Pq(),Pt=!1,kt=0,"interactive"==S.readyState&&!S.createEventObject||"complete"==S.readyState)ao();else{if(yb(S,"DOMContentLoaded",ao),yb(S,"readystatechange",ao),S.createEventObject&&S.documentElement.doScroll){var x=!0;try{x=!I.frameElement}catch(n){}x&&bo()}yb(I,"load",ao)}Rt=!1,"complete"===S.readyState?gq():yb(I,"load",gq),We&&(I.setInterval(ai,864e5),yb(I,"pagehide",(function(){for(var n in ot&&ht[ot]&&Ci(!0),gt)gt.hasOwnProperty(n)&&(ot=Number(n),Ci(!0))}))),O(46)&&(P(111),Wa("HEALTH",1)),O(47)&&(P(112),Wa("HEALTH",2)),he=z(),Zt.bootstrap=he}}))}(),window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8SC4NJQKYS");var ScRoot=pc.createScript("scRoot");ScRoot.prototype.initialize=function(){this.app.mouse.disableContextMenu(),ScRoot.sharedData={currLang:0,sfxState:1,bgmState:1,latestScore:0,login:!1,tuts:!0},this.camera=this.entity.findByName("Camera"),this.apiURL=this.app.assets.find("api.txt","text").resource+"api/",this.httpRequested=!1,this.jwt="",this.userData=null,this.app.systems.sound.volume=.1,this.entity.sound.play("Menu"),this.entity.on("click",(function(){this.entity.sound.play("Click")}),this),this.entity.on("changeScene",this.changeScene,this),this.entity.on("selectLocal",(function(t,e){ScRoot.sharedData.currLang!=t&&(ScRoot.sharedData.currLang=t,this.app.i18n.locale=e)}),this),this.entity.on("toggleSFX",(function(t){ScRoot.sharedData.sfxState=t}),this),this.entity.on("toggleBGM",(function(t){ScRoot.sharedData.bgmState=t,1==t?this.entity.sound.play("Menu"):this.entity.sound.stop()}),this),this.entity.on("postLogin",this.httpLogin,this),this.entity.on("postRegister",this.httpRegister,this),this.entity.on("postStart",this.httpStart,this),this.entity.on("getLeaderboard",this.httpLeaderboard,this),this.entity.on("postScore",this.httpNewScore,this),this.entity.on("goLogout",(function(){this.jwt="",this.userData=null,ScRoot.sharedData.login=!1,ScRoot.sharedData.tuts=!0}),this),this.entity.fire("changeScene","scnHome"),this.entity.fire("toggleBGM",0)},ScRoot.prototype.update=function(t){},ScRoot.prototype.changeScene=function(t){var e=this.app.scenes.find(t);this.app.scenes.loadSceneData(e,function(e,o){var s=this.app.root.findByName("Root");s.findByName("SceneRoot").destroy(),this.app.scenes.loadSceneHierarchy(o,(function(e,o){e?console.error(e):(gtag("event","scene_view",{scene_name:t}),o.reparent(s))})),this.app.scenes.unloadSceneData(o)}.bind(this))},ScRoot.prototype.httpLogin=function(t,e,o=null){if(this.httpRequested)return 0;let s=this;this.httpRequested=!0,pc.http.post(this.apiURL+"auth/local",{identifier:t,password:e},{headers:{"Content-Type":"application/json"}},(function(t,e){null==t?(ScRoot.sharedData.login=!0,s.jwt="Bearer "+e.jwt,s.userData=e.user,null!=o?o(!0):ScRoot.sharedData.tuts=!1):(console.log("Error",t),null!=o&&o(!1)),s.httpRequested=!1}))},ScRoot.prototype.httpRegister=function(t,e,o,s){if(this.httpRequested)return 0;let i=this;this.httpRequested=!0,pc.http.post(this.apiURL+"auth/local/register",{username:t,email:e,password:o},{headers:{"Content-Type":"application/json"}},(function(t,e){null==t?s(!0):(console.log("Error",t),s(!1)),i.httpRequested=!1}))},ScRoot.prototype.httpStart=function(){if(this.httpRequested)return 0;let t=null;t=""==this.jwt?{headers:{"Content-Type":"application/json"}}:{headers:{"Content-Type":"application/json",Authorization:this.jwt}};let e=this;this.httpRequested=!0,pc.http.post(this.apiURL+"players/startPlay",null,t,(function(t,o){null!=t&&console.log("Error",t),e.httpRequested=!1}))},ScRoot.prototype.httpLeaderboard=function(t){if(this.httpRequested)return 0;let e=this;this.httpRequested=!0,pc.http.get(this.apiURL+"leaderBoard",(function(o,s){null==o?t(s):console.log("Error",o),e.httpRequested=!1}))},ScRoot.prototype.httpNewScore=function(t,e){if(""==this.jwt)return e(1),0;if(this.httpRequested)return 0;let o=this;this.httpRequested=!0,pc.http.post(this.apiURL+"players/newScore",{score:t},{headers:{"Content-Type":"application/json",Authorization:this.jwt}},(function(t,s){null==t?e(1):(console.log("Error",t),e(-1)),o.httpRequested=!1}))};"undefined"!=typeof document&&(
/*! FPSMeter 0.3.1 - 9th May 2013 | https://github.com/Darsain/fpsmeter */
function(t,e){function s(t,e){for(var n in e)try{t.style[n]=e[n]}catch(t){}return t}function H(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function R(t,e){if("array"!==H(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function I(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(H(e[1][t])){case"object":e[0][t]=I({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?I.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function N(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function S(t,e,n,o){t.addEventListener?t[o?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[o?"detachEvent":"attachEvent"]("on"+e,n)}function D(t,e){function g(t,e,n,o){return h[0|t][Math.round(Math.min((e-n)/(o-n)*M,M))]}function r(){F.legend.fps!==q&&(F.legend.fps=q,F.legend[c]=q?"FPS":"ms"),b=q?v.fps:v.duration,F.count[c]=999<b?"999+":b.toFixed(99<b?0:O.decimals)}function m(){for(l=n(),P<l-O.threshold&&(v.fps-=v.fps/Math.max(1,60*O.smoothing/O.interval),v.duration=1e3/v.fps),w=O.history;w--;)T[w]=0===w?v.fps:T[w-1],j[w]=0===w?v.duration:j[w-1];if(r(),O.heat){if(z.length)for(w=z.length;w--;)z[w].el.style[o[z[w].name].heatOn]=q?g(o[z[w].name].heatmap,v.fps,0,O.maxFps):g(o[z[w].name].heatmap,v.duration,O.threshold,0);if(F.graph&&o.column.heatOn)for(w=C.length;w--;)C[w].style[o.column.heatOn]=q?g(o.column.heatmap,T[w],0,O.maxFps):g(o.column.heatmap,j[w],O.threshold,0)}if(F.graph)for(y=0;y<O.history;y++)C[y].style.height=(q?T[y]?Math.round(x/O.maxFps*Math.min(T[y],O.maxFps)):0:j[y]?Math.round(x/O.threshold*Math.min(j[y],O.threshold)):0)+"px"}function k(){20>O.interval?(p=i(k),m()):(p=setTimeout(k,O.interval),f=i(m))}function G(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),v.toggle()}function U(){O.toggleOn&&S(F.container,O.toggleOn,G,1),t.removeChild(F.container)}function V(){if(F.container&&U(),o=D.theme[O.theme],!(h=o.compiledHeatmaps||[]).length&&o.heatmaps.length){for(y=0;y<o.heatmaps.length;y++)for(h[y]=[],w=0;w<=M;w++){var e,n=h[y],a=w;e=.33/M*w;var i=o.heatmaps[y].saturation,l=o.heatmaps[y].lightness,p=void 0,c=void 0,u=void 0,d=u=void 0,f=p=c=void 0;f=void 0;0===(u=.5>=l?l*(1+i):l+i-l*i)?e="#000":(c=(u-(d=2*l-u))/u,f=(e*=6)-(p=Math.floor(e)),f*=u*c,0===p||6===p?(p=u,c=d+f,u=d):1===p?(p=u-f,c=u,u=d):2===p?(p=d,c=u,u=d+f):3===p?(p=d,c=u-f):4===p?(p=d+f,c=d):(p=u,c=d,u-=f),e="#"+N(p)+N(c)+N(u)),n[a]=e}o.compiledHeatmaps=h}for(var b in F.container=s(document.createElement("div"),o.container),F.count=F.container.appendChild(s(document.createElement("div"),o.count)),F.legend=F.container.appendChild(s(document.createElement("div"),o.legend)),F.graph=O.graph?F.container.appendChild(s(document.createElement("div"),o.graph)):0,z.length=0,F)F[b]&&o[b].heatOn&&z.push({name:b,el:F[b]});if(C.length=0,F.graph)for(F.graph.style.width=O.history*o.column.width+(O.history-1)*o.column.spacing+"px",w=0;w<O.history;w++)C[w]=F.graph.appendChild(s(document.createElement("div"),o.column)),C[w].style.position="absolute",C[w].style.bottom=0,C[w].style.right=w*o.column.width+w*o.column.spacing+"px",C[w].style.width=o.column.width+"px",C[w].style.height="0px";s(F.container,O),r(),t.appendChild(F.container),F.graph&&(x=F.graph.clientHeight),O.toggleOn&&("click"===O.toggleOn&&(F.container.style.cursor="pointer"),S(F.container,O.toggleOn,G))}"object"===H(t)&&undefined===t.nodeType&&(e=t,t=document.body),t||(t=document.body);var o,h,l,p,f,x,b,w,y,v=this,O=I({},D.defaults,e||{}),F={},C=[],M=100,z=[],E=O.threshold,A=0,P=n()-E,T=[],j=[],q="fps"===O.show;v.options=O,v.fps=0,v.duration=0,v.isPaused=0,v.tickStart=function(){A=n()},v.tick=function(){l=n(),E+=(l-P-E)/O.smoothing,v.fps=1e3/E,v.duration=A<P?E:l-A,P=l},v.pause=function(){return p&&(v.isPaused=1,clearTimeout(p),a(p),a(f),p=f=0),v},v.resume=function(){return p||(v.isPaused=0,k()),v},v.set=function(t,e){return O[t]=e,q="fps"===O.show,-1!==R(t,u)&&V(),-1!==R(t,d)&&s(F.container,O),v},v.showDuration=function(){return v.set("show","ms"),v},v.showFps=function(){return v.set("show","fps"),v},v.toggle=function(){return v.set("show",q?"ms":"fps"),v},v.hide=function(){return v.pause(),F.container.style.display="none",v},v.show=function(){return v.resume(),F.container.style.display="block",v},v.destroy=function(){v.pause(),U(),v.tick=v.tickStart=function(){}},V(),k()}var n,o=t.performance;n=o&&(o.now||o.webkitNow)?o[o.now?"now":"webkitNow"].bind(o):function(){return+new Date};for(var a=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,i=t.requestAnimationFrame,h=0,l=0,p=(o=["moz","webkit","o"]).length;l<p&&!a;++l)i=(a=t[o[l]+"CancelAnimationFrame"]||t[o[l]+"CancelRequestAnimationFrame"])&&t[o[l]+"RequestAnimationFrame"];a||(i=function(e){var o=n(),a=Math.max(0,16-(o-h));return h=o+a,t.setTimeout((function(){e(o+a)}),a)},a=function(t){clearTimeout(t)});var c="string"===H(document.createElement("div").textContent)?"textContent":"innerText";D.extend=I,window.FPSMeter=D,D.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var u=["toggleOn","theme","heat","graph","history"],d="position zIndex left top right bottom margin".split(" ")}(window),function(t,e){e.theme={};var n=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter));var Fps=pc.createScript("fps");Fps.prototype.initialize=function(){this.fps=new FPSMeter({heat:!0,graph:!0})},Fps.prototype.update=function(t){this.fps.tick()};var ScCamera=pc.createScript("scCamera");ScCamera.prototype.initialize=function(){let t=this.entity.getPosition();this.initX=t.x,this.initY=t.y,this.posX=t.x,this.posY=t.y,this.entity.on("updateVertical",(function(t,s){let i=t;s<0&&t<=28&&(i=4.5,t>=7&&(i+=(t-7)/21*23.5));let e=this.posY;s=Math.abs(s),this.posY+=e<i?Math.min(2*s,i-e):Math.max(i-e,2*-s);let h=this.patrick.getPosition(),o=this.patrickScript.posY;o<this.initY?h.y=o:h.y=this.initY+o-this.posY,this.patrick.setPosition(h);let a=Math.min(this.initY-this.posY,0);this.shiftGroup.setPosition(0,a,0),this.shiftVertical(a),this.minimap.fire("updateVertical",o)}),this),this.entity.on("updateHorizontal",(function(t){this.posX+=t;let s=this.patrickScript.posX;if(s!=this.posX){let t=this.patrick.getPosition();t.x=this.initX+s-this.posX,this.patrick.setPosition(t)}this.meshShiftU(this.fgMesh,t),this.meshShiftU(this.abyssMesh,t/16),this.meshShiftU(this.fg2Mesh,t),this.meshShiftU(this.abyss2Mesh,t/16),this.meshShiftU(this.abyssBonusMesh,t/16),this.meshShiftU(this.lightsMesh,t/2),this.lights.sprite.opacity<=.2&&(this.lights.sprite.opacity=pc.math.clamp(this.lights.sprite.opacity+(Math.random()-.5)/500,0,.2)),this.shiftGroupScroll(this.shiftGroup.children,t)}),this),this.entity.on("themeShift",this.shiftVertical,this),this.entity.on("setupPlay",(function(t){this.posX=this.initX,this.posY=this.initY,this.sceneRoot=t,this.patrick=this.sceneRoot.findByName("oPatrick"),this.patrickScript=this.patrick.script.scPatrick,this.lights=this.sceneRoot.findByName("oLights"),this.foreground=this.sceneRoot.findByName("oForeground"),this.foreground2=this.sceneRoot.findByName("oForeground2"),this.shiftGroup=this.sceneRoot.findByName("ShiftGroup"),this.abyss=this.sceneRoot.findByName("oAbyss"),this.abyss2=this.sceneRoot.findByName("oAbyss2"),this.abyssBonus=this.sceneRoot.findByName("oAbyssBonus"),this.lightsMesh=this.lights.sprite.sprite.meshes[0],this.fgMesh=this.foreground.sprite.sprite.meshes[0],this.fg2Mesh=this.foreground2.sprite.sprite.meshes[1],this.abyssMesh=this.abyss.sprite.sprite.meshes[0],this.abyss2Mesh=this.abyss2.sprite.sprite.meshes[0],this.abyssBonusMesh=this.abyssBonus.sprite.sprite.meshes[0],this.minimap=this.sceneRoot.findByName("2DScreen").findByName("UI_Minimap")}),this),this.entity.on("nextMeshes",(function(t){let s=t%this.foreground.sprite.sprite.meshes.length;this.fgMesh=this.changeMesh(this.fgMesh,this.foreground,s);let i=this.app.assets.find("txAbyss"+t+".png","textureatlas").resource;this.abyss.sprite.sprite.atlas=i,this.abyssMesh=this.abyss.sprite.sprite.meshes[0]}),this)},ScCamera.prototype.update=function(t){},ScCamera.prototype.meshShiftU=function(t,s){let i=[];t.getUvs(0,i);let e=s/16;i[0]+e>=2&&(e-=2),i[0]+=e,i[2]+=e,i[4]+=e,i[6]+=e,t.setUvs(0,i),t.update()},ScCamera.prototype.changeMesh=function(t,s,i){let e=[];t.getUvs(0,e);let h=e[0],o=e[2];s.sprite.frame=i;let a=s.sprite.sprite.meshes[i];return a.getUvs(0,e),e[0]=h,e[2]=o,e[4]=o,e[6]=h,a.setUvs(0,e),a.update(),a},ScCamera.prototype.shiftVertical=function(t=0){this.lights.setPosition(0,Math.max(-7,t/6.25),-2.5),this.foreground.setPosition(0,t,-2),this.abyss.setPosition(0,Math.max(-7,t/6.25),-20),this.foreground2.setPosition(0,t,-2.1),this.abyss2.setPosition(0,Math.max(-7,t/6.25),-20),this.abyssBonus.setPosition(0,Math.max(-7,t/6.25),-19.5)},ScCamera.prototype.shiftGroupScroll=function(t,s){let i=t.length;for(let e=0;e<i;e++){let h=t[e];h.getPosition().x-s<-3?(h.destroy(),e--,i--):h.translateLocal(-s,0,0)}};var ScPlaySceneRoot=pc.createScript("scPlaySceneRoot");ScPlaySceneRoot.prototype.initialize=function(){this.meshResetUV(this.entity.findByName("oLights").sprite.sprite.meshes[0]);let e=this.entity.findByName("oForeground").sprite.sprite.meshes;for(let t=0;t<e.length;t++)this.meshResetUV(e[t]);let t=this.entity.findByName("oAbyss").sprite.sprite,s=this.entity.findByName("oAbyss2").sprite.sprite,i=this.entity.findByName("oAbyssBonus").sprite.sprite;t.atlas=this.app.assets.find("txAbyss0.png","textureatlas").resource,s.atlas=this.app.assets.find("txAbyss1.png","textureatlas").resource,this.meshResetUV(t.meshes[0],.5),this.meshResetUV(s.meshes[0],.5),this.meshResetUV(i.meshes[0],.5),this.app.root.findByName("Camera").fire("setupPlay",this.entity)},ScPlaySceneRoot.prototype.update=function(e){},ScPlaySceneRoot.prototype.meshResetUV=function(e,t=1){let s=[];e.getUvs(0,s),s[0]=0,s[2]=t,s[4]=t,s[6]=0,e.setUvs(0,s),e.update()};var ScDirector=pc.createScript("scDirector");ScDirector.prototype.initialize=function(){gtag("event","level_start"),this.sceneRoot=this.app.root.findByName("SceneRoot"),this.shiftGroup=this.sceneRoot.findByName("ShiftGroup"),this.templates=this.entity.findByName("Templates"),this.patrick=this.sceneRoot.findByName("oPatrick"),this.patrickScript=this.patrick.script.scPatrick,this.patrickTrail=this.sceneRoot.findByName("oPatrickTrail"),this.screen=this.sceneRoot.findByName("2DScreen"),this.minimap=this.screen.findByName("UI_Minimap"),this.bonusSplash=this.screen.findByName("UI_BonusSplash"),this.gameOverSplash=this.screen.findByName("UI_GameOver"),this.camera=this.app.root.findByName("Camera"),this.camScript=this.camera.script.scCamera,this.foreground=this.sceneRoot.findByName("oForeground"),this.foreground2=this.sceneRoot.findByName("oForeground2"),this.abyss=this.sceneRoot.findByName("oAbyss"),this.abyss2=this.sceneRoot.findByName("oAbyss2"),this.abyssBonus=this.sceneRoot.findByName("oAbyssBonus"),this.maxHeight=48,this.distance=0,this.endReached=!1,this.gamePaused=!1,this.gameOver=!1,this.scorePost=0,this.transTurn=-1,this.themeLength=[200,300,300],this.themeStart=this.themeLength[0],this.themeCarryOn=0,this.nextThemeNo=1,this.colMixer=new pc.Color,this.themeColors=[new pc.Color(.2,.85,.95),new pc.Color(.25,.75,1),new pc.Color(1,.95,.7)],this.partyColors=[pc.Color.RED,pc.Color.GREEN,pc.Color.BLUE,pc.Color.CYAN,pc.Color.MAGENTA,pc.Color.YELLOW],this.lastLightCol=this.themeColors[0],this.nextLightCol=this.lastLightCol,this.floresColor=new pc.Color(1,1,1),this.lights=this.sceneRoot.findByName("oLights"),this.lights.sprite.color=this.lastLightCol,this.waterFilter=this.sceneRoot.findByName("oWaterFilter"),this.filterOpac=.1+.05*Math.random(),this.filterOpacNew=.1+.05*Math.random(),this.waterFilter.sprite.color=this.themeColors[0],this.waterFilter.sprite.opacity=this.filterOpac,this.inParty=!1,this.partyTime=0,this.partyLights=0,this.distCoins=0,this.tplCoin=this.templates.findByName("tplCoin"),this.coinDir=0,this.tplJellyfish=this.templates.findByName("tplJellyfish"),this.distJellyfish=5+20*Math.random(),this.tplBurger=this.templates.findByName("tplBurger"),this.distBurger=50+100*Math.random(),this.tplFood=this.templates.findByName("tplFood"),this.distFood=5*Math.random(),this.tplFores=this.templates.findByName("tplFores"),this.distFores=6+18*Math.random(),this.tplBubs=this.templates.findByName("tplBubs"),this.tplStars=this.templates.findByName("tplStars"),this.distObj=0,this.disperseJellyArray=[],this.disperseJellySpd=0,this.entity.on("distance",this.distanceUpdate,this),this.entity.on("pauseGame",this.pauseGame,this),this.entity.on("gameOver",(function(t=!1){if(!this.gameOver){gtag("event","game_over",{theme:this.nextThemeNo,dist:this.patrickScript.distScore,collect:this.patrickScript.collectScore});let i=this,s=Math.min(Math.round(this.patrickScript.distScore+this.patrickScript.collectScore),999999);this.app.root.findByName("Root").fire("postScore",s,(function(t){i.scorePost=t})),this.pauseGame(),this.gameOver=!0,this.gameOverSplash.enabled=!0,this.gameOverSplash.fire("activate",t)}}),this),this.entity.on("disperseJellyfishes",(function(t,i){this.disperseJellySpd=Math.max(t,16-t)/2;let s=this.shiftGroup.findByTag("jelly");this.disperseJellyArray=s;for(let e of s){let s=e.getPosition(),h=ScUtils.point_direction(t,i,s.x,s.y)-90;e.setLocalEulerAngles(0,0,h),e.sprite.play("Swim")}}),this),this.entity.on("bubs",this.createBub,this),this.entity.on("stars",this.createStar,this),this.minimap.fire("reset",0,this.themeLength[0]-50),this.minimap.enabled=!0,this.minimap.enabled=!1},ScDirector.prototype.update=function(t){if(this.partyTime>0||this.endReached){let i=this.partyLights%1;this.partyLights-=t;let s=this.partyLights%1;if(i<s&&(this.lights.sprite.color=this.nextLightCol,this.lastLightCol=this.nextLightCol,this.nextLightCol=this.partyColors[ScUtils.irandom(5)],this.partyLights++),this.endReached||this.partyTime-t>0){let i=this.lights.sprite.opacity;i<.5&&(this.lights.sprite.opacity=Math.min(i+t,.5)),this.lights.sprite.color=this.colMixer.lerp(this.lastLightCol,this.nextLightCol,1-s)}}if(!this.gamePaused)if(this.disperseJellyfishes(t),this.inParty){if(this.gameOver)return;if(this.partyTime>0)this.partyTime-=t,this.partyTime>=9&&(this.abyssBonus.sprite.opacity=10-this.partyTime);else{this.inParty=!1;let t=this.shiftGroup.findByTag("coins");for(let i of t)i.destroy();if(this.nextThemeNo>=3)this.endReached=!0;else{let t=this.distance;this.themeStart=t,this.minimap.enabled=!0,this.minimap.fire("reset",t,this.themeLength[this.nextThemeNo]-50)}this.bonusSplash.enabled=!0,this.bonusSplash.fire("activate",this.nextThemeNo)}}else if(this.patrickScript.xPower<=0&&this.transitioning){let t=this.themeCarryOn;t>0&&(this.distance+=t,this.themeUpdate(this.distance),this.camera.fire("themeShift"))}else if(this.nextThemeNo<3){let i=this.abyssBonus.sprite.opacity;i>0&&(i-=t,this.abyssBonus.sprite.opacity=Math.max(0,i),i<=0&&(this.abyssBonus.enabled=!1))}},ScDirector.prototype.distanceUpdate=function(t){if(t<=0||this.endReached||this.gameOver)return;this.distance+=t;let i=this.distance;if(this.inParty){if(this.partyTime>=2.5){let t=this.patrick.getPosition().y;i>=this.distCoins&&(this.distCoins=this.distance+this.placePartyCoins(t,this.patrickScript.posY))}}else if(i<this.themeStart&&i>=this.themeStart-50){this.inParty=!0,this.abyssBonus.enabled=!0,this.partyTime=10,this.partyLights=10,this.minimap.enabled=!1,this.nextLightCol=this.lights.sprite.color;let t=this.patrick.getPosition().y,i=this.patrickScript.posY;this.distCoins=this.distance+this.placePartyCoins(t,i)}else{if(this.minimap.fire("updateHorizontal",i),this.spawnCheck(i+8),Math.random()<.1){let t=this.patrick.getPosition();this.createBub(t.x+16*Math.random(),t.y-4.5+9*Math.random(),1,!0)}this.transitioning&&this.themeCarryOn>t&&(i+=this.themeCarryOn-t),this.themeUpdate(i,t)}},ScDirector.prototype.themeUpdate=function(t,i=0){let s=this.themeStart;if(t<s)return 0;let e=this.transTurn;this.transitioning||(this.transitioning=!0,this.themeCarryOn=Math.max(.01,i),-1==e?(this.foreground2.enabled=!0,this.abyss2.enabled=!0):(this.foreground.enabled=!0,this.abyss.enabled=!0));let h=Math.min((t-s)/20,1),r=h;1==e&&(r=1-r);let o=1-r;this.foreground.sprite.opacity=o,this.foreground2.sprite.opacity=1-o,this.abyss.sprite.opacity=o,this.abyss2.sprite.opacity=1-o;let a=this.nextThemeNo;return this.lights.sprite.opacity=.5-.3*h,this.lights.sprite.color=this.colMixer.lerp(this.lastLightCol,this.themeColors[a],h),this.waterFilter.sprite.color=this.colMixer.lerp(this.themeColors[a-1],this.themeColors[a],h),this.waterFilter.sprite.opacity=pc.math.lerp(this.filterOpac,this.filterOpacNew,h),h>=1?(1==e?(this.foreground2.enabled=!1,this.abyss2.enabled=!1):(this.foreground.enabled=!1,this.abyss.enabled=!1),this.filterOpac=this.filterOpacNew,this.filterOpacNew=.1+.05*Math.random(),this.patrickScript.themeCol=this.themeColors[a],this.themeStart+=this.themeLength[this.nextThemeNo],this.transitioning=!1,this.transTurn=-this.transTurn,this.themeCarryOn=0,this.nextThemeNo++,this.nextThemeNo<=2&&this.camera.fire("nextMeshes",this.nextThemeNo),2):1},ScDirector.prototype.spawnCheck=function(t){let i=this.patrick.getPosition().y,s=this.patrickScript.posY,e=i-s;if(t>=this.distFores)if(s-5<=8){let i=this.tplFores.clone();this.shiftGroup.addChild(i);let s=(this.nextThemeNo-1)%3;i.sprite.frame=s;let e=1-Math.random()/2;if(i.setLocalScale(e*ScUtils.choose(-1,1),e,1),Math.random()<.5){let t=i.getLocalPosition();t.y=.25,t.z=-5.5,i.setLocalPosition(t),i.sprite.opacity=1}if(s>0){let t=[ScUtils.choose(.5,1),ScUtils.choose(.5,1),ScUtils.choose(.5,1)];t.includes(1)?t.includes(.5)||(t[ScUtils.irandom(2)]=.5):t[ScUtils.irandom(2)]=1,this.floresColor.set(t[0],t[1],t[2]),i.sprite.color=this.floresColor}i.enabled=!0,this.distFores=t+6+18*Math.random()}else this.distFores=t+8*Math.random();if(t>=this.distFood&&(this.distFood=t+5,s>=12&&s<=32&&Math.random()<.5&&(this.distFood-=2.5),s+5<=this.maxHeight)){let t=Math.max(2,s-3+6*Math.random())+e;return this.spawnFood(t),1}if(t<this.distObj)return 0;if(this.patrickScript.hitGround)return 0;let h=(4-this.nextThemeNo)/2;if(t>=this.distBurger-14){if(s>9&&s+4.5<=this.maxHeight){let i=this.tplBurger.clone();this.shiftGroup.addChild(i);let r=i.getPosition();return r.y=Math.max(9,s+1.5*(8*Math.random()-4)/h)+e,i.setPosition(r),i.enabled=!0,this.minimap.fire("add",i,t+23,3),this.distBurger=t+75/h+Math.random()*(100/h),this.distObj=t+3,1}this.distBurger=t+50*Math.random()}if(t>=this.distJellyfish)if(Math.random()<.75){if(s>9&&s+9<=this.maxHeight){let i=this.tplJellyfish.clone();this.shiftGroup.addChild(i);let r=i.getPosition();if(r.y=Math.max(9,s-3*h*h+12*Math.random())+e,i.setPosition(r),i.enabled=!0,this.distFood-t>=2.5&&Math.random()<.5){let t=Math.min(r.y+1,this.maxHeight+e);this.spawnFood(t),this.distFood+=2.5}return this.distJellyfish=t+5+Math.random()*(20*h)*(1-s/this.maxHeight),this.distObj=t+3,1}this.distJellyfish=t+5*Math.random()}else{if(s>9&&s+12<=this.maxHeight){let i=1+ScUtils.irandom(1),r=ScUtils.irandom(2),o=ScUtils.irandom(2),a=this.maxHeight+e,n=this.tplJellyfish.getPosition().x,l=Math.max(9,s-3*h*h+6*Math.random())+e,p=3+ScUtils.irandom(6),c=0;for(;c<p;c++){let t=this.tplJellyfish.clone();this.shiftGroup.addChild(t);let s=t.getPosition();if(s.x=n,s.y=l,t.setPosition(s),t.enabled=!0,1==r||2==r&&c%2==1){let t=Math.min(l+1,a);c<p-1?this.spawnFood(t,n,ScUtils.irandom(2)):this.spawnFood(t,n,3)}if(1==o||2==o&&c%2==0){let t=l-2;t-e>2&&(c<p-1?this.spawnFood(t,n,ScUtils.irandom(2)):this.spawnFood(t,n,3))}if(c+1<p){if(n+=i,this.distJellyfish+=i,this.distJellyfish<this.themeStart&&this.distJellyfish>=this.themeStart-50)break;let s=ScUtils.irandom(2)-1;if(l+s>=a&&(s=ScUtils.irandom(1)-1),l+=s,l-e<2)break;{let e=0;e=1==s?1==i?.603:.452:0==s?1==i?.15+i/1e3:.3+i/1e3:i/1e3,t.translate(0,0,-e)}}}return this.distFood+=5,this.distJellyfish=t+10+Math.random()*(15*h)*(1-s/this.maxHeight)+c*i,this.distObj=t+3+c*i,1}this.distJellyfish=t+5*Math.random()}return 0},ScDirector.prototype.disperseJellyfishes=function(t){let i=this.disperseJellyArray,s=i.length;if(s<=0)return 0;let e=this.disperseJellySpd*t;for(var h=0;h<s;h++){let t=i[h],r=(t.getLocalEulerAngles().z+90)*pc.math.DEG_TO_RAD,o=t.getPosition(),a=o.x+e*Math.cos(r),n=o.y+e*Math.sin(r);a<=-2||a>=18||n<=-2||n>=11?(t.destroy(),this.disperseJellyArray.splice(h,1),s--,h--):(o.x=a,o.y=n,t.setPosition(o))}return 1},ScDirector.prototype.pauseGame=function(t=!0){this.gamePaused=t;let i=this.shiftGroup.findByTag("anim");if(t){this.patrickTrail.sprite.currentClip.isPlaying&&this.patrickTrail.sprite.currentClip.pause();for(let t of i)t.sprite.currentClip.isPlaying&&t.sprite.currentClip.pause()}else{this.patrickTrail.sprite.currentClip.isPaused&&this.patrickTrail.sprite.currentClip.resume();for(let t of i)t.sprite.currentClip.isPaused&&t.sprite.currentClip.resume()}},ScDirector.prototype.placeCoin=function(t,i){let s=this.tplCoin.clone();this.shiftGroup.addChild(s);let e=s.getPosition();e.x+=t,e.y=i,s.setPosition(e),Math.random()<.25&&s.setLocalScale(1.5,1.5,1),s.enabled=!0},ScDirector.prototype.placePartyCoins=function(t,i){if(i>=this.maxHeight-4.5)return 2;Math.random()<.75&&(this.coinDir=2*(Math.random()-.5));let s=8*Math.random()-4;t+=s,i+=s;let e=1+ScUtils.irandom(1),h=Math.random()*ScUtils.irandom(1),r=Math.random()*ScUtils.irandom(1),o=6+ScUtils.irandom(10);for(let s=0;s<o;s++)this.placeCoin(s,t),0!=h&&Math.random()<h&&this.placeCoin(s,t+e),0!=r&&Math.random()<r&&this.placeCoin(s,t-e),Math.random()<.5&&(this.coinDir=-this.coinDir),t+=this.coinDir,(i+=this.coinDir)-e<=2?this.coinDir=1:i+e>=this.maxHeight&&(this.coinDir=-1);return o+1+ScUtils.irandom(2)},ScDirector.prototype.createBub=function(t,i,s=1,e=!1){let h=this.tplBubs.clone();this.shiftGroup.addChild(h);let r=.2+Math.random()*s*.8;h.setLocalScale(r,r,1),h.setPosition(t+(Math.random()-.5),i+(Math.random()-.5),e?-19:-2.5);let o=h.sprite;o.frame=ScUtils.irandom(1),o.opacity=(.5+Math.random()/2)*(e?.3:1),this.inParty?o.color=this.partyColors[ScUtils.irandom(5)]:e&&(o.color=this.themeColors[this.nextThemeNo-1]),h.enabled=!0},ScDirector.prototype.createStar=function(t,i,s){let e=this.tplStars.clone();this.shiftGroup.addChild(e);let h=.2+.8*Math.random(),r=Math.random();e.setLocalScale(h,h,1),e.setPosition(t-Math.random(),i+(r-.5),-2.5),e.setEulerAngles(0,0,30*(.5-r));let o=e.sprite;this.inParty&&(s=3,o.color=this.partyColors[ScUtils.irandom(5)]),o.frame=s,o.opacity=.5+Math.random()/2,e.enabled=!0},ScDirector.prototype.spawnFood=function(t,i=-1,s=ScUtils.irandom(3)){let e=this.tplFood.clone();this.shiftGroup.addChild(e),e.sprite.frame=s;let h=e.getPosition();-1!=i&&(h.x=i),h.y=t,e.setPosition(h),e.enabled=!0};var ScSlingshot=pc.createScript("scSlingshot");ScSlingshot.prototype.initialize=function(){this.camera=this.app.root.findByName("Camera"),this.director=this.app.root.findByName("SceneRoot").findByName("Director").script.scDirector,this.stickL=this.entity.findByName("oSlingstickL"),this.stickR=this.entity.findByName("oSlingstickR"),this.sling=this.entity.findByName("oSling"),this.slingPart=this.sling.findByName("oSlingPart"),this.patrick=this.entity.findByName("oPatrickInitial"),this.arrow=this.entity.findByName("oArrow"),this.trailL=this.arrow.findByName("oArrowTrailL"),this.trailR=this.arrow.findByName("oArrowTrailR"),this.trailL.sprite.frame=1,this.trailR.sprite.frame=1,this.launchState=0,this.chargePower=0,this.launchPower=0,this.aimPos=new pc.Vec3,this.aimDir=0,this.aimRad=0,this.slingZ=this.sling.getPosition().z;let t=this.app.touch;t?(t.on(pc.EVENT_TOUCHSTART,this.onCharge,this),t.on(pc.EVENT_TOUCHMOVE,this.onAim,this),t.on(pc.EVENT_TOUCHEND,this.toRelease,this)):(this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onCharge,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onAim,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.toRelease,this))},ScSlingshot.prototype.update=function(t){let i=this.launchState;if(i>=2&&i<6){let s=this.chargePower,e=this.aimRad;this.sling.setLocalPosition(-s*Math.cos(e),-s*Math.sin(e),0);let h=-1;3==i?(h=-1,s<=-2&&(this.launchState=4)):4==i?(h=1,s>=1&&(this.launchState=5)):5==i&&s<=0&&(this.launchState=6,h=0,this.sling.setLocalPosition(0,-.25,0),this.sling.setLocalEulerAngles(0,0,15)),this.chargePower=s+60*h*t,this.slingPart.fire("move",s)}},ScSlingshot.prototype.onCharge=function(t){if(t.event.preventDefault(),this.director.gamePaused)return;this.launchState=1,this.stickL.sprite.play("Launch"),this.stickR.sprite.play("Launch"),this.stickL.sprite.pause(),this.stickR.sprite.pause(),this.slingPart.fire("charge"),this.patrick.reparent(this.sling),this.patrick.setLocalPosition(0,0,0),this.patrick.sprite.sprite=this.app.assets.find("sPatrickBounce","sprite").resource,this.arrow.enabled=!0,this.entity.findByName("oArc").enabled=!0;let i=this.app.touch;i?i.off(pc.EVENT_TOUCHSTART,this.onCharge,this):this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onCharge,this),this.onAim(t)},ScSlingshot.prototype.onAim=function(t){if(t.event.preventDefault(),this.director.gamePaused||1!=this.launchState)return;let i=t;this.app.touch&&(i=t.touches[0]);let s=this.entity.getPosition(),e=s.x,h=s.y,a=this.aimPos;this.camera.camera.screenToWorld(i.x,i.y,-this.slingZ,a);let r=a.x,o=a.y,n=pc.math.clamp(ScUtils.point_direction(r,o,e,h),-15,30),c=n*pc.math.DEG_TO_RAD,l=ScUtils.point_distance(r,o,e,h);if(a.x>e?l=1:(l**=.66,l<1?l=1:l>3&&(l=3)),this.sling.setLocalPosition(-l*Math.cos(c),-l*Math.sin(c),0),this.sling.setLocalEulerAngles(0,0,n),this.slingPart.fire("move",l),this.chargePower=l,l>2?(this.stickL.sprite.frame=0,this.stickR.sprite.frame=0):(this.stickL.sprite.frame=1,this.stickR.sprite.frame=1),this.arrow.setLocalEulerAngles(0,0,n),Math.abs(this.aimDir-n)>=5){let t=this.trailR;this.aimDir>=n&&(t=this.trailL),t.sprite.play("Trail")}this.aimDir=n},ScSlingshot.prototype.toRelease=function(t){if(t.event.preventDefault(),this.director.gamePaused||1!=this.launchState)return;this.launchState=2,this.launchPower=4*this.chargePower,this.aimRad=this.aimDir*pc.math.DEG_TO_RAD,this.stickL.sprite.resume(),this.stickR.sprite.resume(),this.arrow.destroy(),this.entity.findByName("oArc").destroy();let i=this.app.touch;i?(i.off(pc.EVENT_TOUCHMOVE,this.onAim,this),i.off(pc.EVENT_TOUCHEND,this.toRelease,this)):(this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onAim,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.toRelease,this))};var ScSlingPart=pc.createScript("scSlingPart");ScSlingPart.prototype.initialize=function(){this.state=0,this.sling=this.entity.parent,this.stringA=this.sling.findByName("oStringA"),this.stringB=this.sling.findByName("oStringB"),this.stringC=this.sling.findByName("oStringC"),this.stringD=this.sling.findByName("oStringD"),this.slingshot=this.sling.parent,this.slingshotScript=this.slingshot.script.scSlingshot,this.effect=this.entity.findByName("oSlingEffect"),this.stickL=this.slingshot.findByName("oSlingstickL"),this.stringAInitPos=new pc.Vec3(-.09,.45,.5),this.stringBInitPos=new pc.Vec3(.07,-.4,.5),this.stringCInitPos=new pc.Vec3(.3,.3,-.5),this.stringDInitPos=new pc.Vec3(.5,-.45,-.5),this.entity.on("charge",(function(){this.state=1,this.entity.sprite.frame=2,this.stringA.setLocalPosition(-.85,.65,.5),this.stringB.setLocalPosition(-.75,-.35,.5),this.stringC.setLocalPosition(.75,.45,-.5),this.stringD.setLocalPosition(.75,-.35,-.5)}),this),this.entity.on("move",(function(t){if(this.entity.getPosition().x>this.slingshot.getPosition().x){if(1==this.state){this.entity.sprite.frame=1,this.state=2,this.slingshotScript.launchState=3,this.slingshotScript.patrick.destroy(),this.effect.enabled=!0;let t=this.app.root.findByName("Root").findByName("SceneRoot").findByName("oPatrick");t.enabled=!0,t.script.scPatrick.boost(!1,this.slingshotScript.launchPower,this.slingshotScript.aimDir),this.stringA.setLocalPosition(-this.stringCInitPos.x,this.stringCInitPos.y,-.1),this.stringB.setLocalPosition(-this.stringDInitPos.x,this.stringDInitPos.y,-.1),this.stringC.setLocalPosition(-this.stringAInitPos.x,this.stringAInitPos.y,-.5),this.stringD.setLocalPosition(-this.stringBInitPos.x,this.stringBInitPos.y,-.5)}}else 2==this.state&&(this.entity.sprite.frame=0,this.state=3,this.effect.destroy(),this.stringA.setLocalPosition(this.stringAInitPos),this.stringB.setLocalPosition(this.stringBInitPos),this.stringC.setLocalPosition(this.stringCInitPos),this.stringD.setLocalPosition(this.stringDInitPos));this.stretch(t)}),this)},ScSlingPart.prototype.update=function(t){},ScSlingPart.prototype.stretch=function(t){if(1!=this.state){let i=Math.abs(t)/2;i<1&&(i=1),this.entity.setLocalScale(i,1,1)}let i=this.slingshot.getPosition(),s=i.x,n=i.y,r=this.slingshotScript.launchState,h=this.stickL.sprite.frame;0==r||6==r||2==h||6==h||8==h?(this.stringA.script.scSlingStrings.stretch(s-.56,n+.5),this.stringB.script.scSlingStrings.stretch(s-.56,n-.53),this.stringC.script.scSlingStrings.stretch(s+.38,n+.5),this.stringD.script.scSlingStrings.stretch(s+.38,n-.53)):0==h?(this.stringA.script.scSlingStrings.stretch(s-1.03,n+.2),this.stringB.script.scSlingStrings.stretch(s-.83,n-.55),this.stringC.script.scSlingStrings.stretch(s-.05,n+.5),this.stringD.script.scSlingStrings.stretch(s+.22,n-.25)):1==h||7==h?(this.stringA.script.scSlingStrings.stretch(s-.9,n+.35),this.stringB.script.scSlingStrings.stretch(s-.75,n-.54),this.stringC.script.scSlingStrings.stretch(s-.03,n+.55),this.stringD.script.scSlingStrings.stretch(s+.2,n-.34)):3==h||5==h?(this.stringA.script.scSlingStrings.stretch(s-.38,n+.35),this.stringB.script.scSlingStrings.stretch(s-.38,n-.54),this.stringC.script.scSlingStrings.stretch(s+.7,n+.5),this.stringD.script.scSlingStrings.stretch(s+.6,n-.4)):(this.stringA.script.scSlingStrings.stretch(s-.08,n+.2),this.stringB.script.scSlingStrings.stretch(s-.38,n-.55),this.stringC.script.scSlingStrings.stretch(s+.8,n+.5),this.stringD.script.scSlingStrings.stretch(s+.55,n-.25))};var ScSlingStrings=pc.createScript("scSlingStrings");ScSlingStrings.prototype.initialize=function(){this.length=2,this.setup=!1,this.isFlipped=this.entity.sprite.flipX},ScSlingStrings.prototype.update=function(t){},ScSlingStrings.prototype.stretch=function(t,i){this.setup||(this.entity.sprite.flipX=Math.random()<.5,this.entity.sprite.flipY=Math.random()<.5,this.isFlipped=this.entity.sprite.flipX,this.setup=!0);let e=this.entity.getPosition(),s=ScUtils.point_distance(e.x,e.y,t,i)/this.length,n=ScUtils.point_direction(e.x,e.y,t,i);this.isFlipped&&(n+=180),this.entity.setEulerAngles(0,0,n),this.entity.sprite.frame=0;let p=1/s;s<1&&(p=1,s<.75&&(this.entity.sprite.frame=1)),this.entity.setLocalScale(s,p,1)};var ScPatrick=pc.createScript("scPatrick");ScPatrick.attributes.add("yDrop",{type:"number",title:"Gravity",default:5}),ScPatrick.attributes.add("xDrop",{type:"number",title:"Air Resistance",default:.05}),ScPatrick.attributes.add("tapPower",{type:"number",title:"Tap Power",default:2}),ScPatrick.attributes.add("speedFactor",{type:"number",title:"Speed Factor",default:.85,min:0,max:2}),ScPatrick.prototype.initialize=function(){0==ScRoot.sharedData.sfxState&&(this.entity.sound.volume=0),this.sprite=this.entity.sprite,this.clipFly=this.sprite.clip("Fly"),this.clipHighFive=this.sprite.clip("HighFive"),this.trail=this.entity.findByName("oPatrickTrail"),this.trailPower=0,this.cam=this.app.root.findByName("Camera"),this.sceneRoot=this.entity.parent,this.director=this.sceneRoot.findByName("Director"),this.directorScript=this.director.script.scDirector,this.shiftGroup=this.sceneRoot.findByName("ShiftGroup"),this.screenUI=this.sceneRoot.findByName("2DScreen"),this.specialTimerText=this.screenUI.findByName("txtSpecialTimer"),this.hpUI=this.screenUI.findByName("UI_HP"),this.hpUI.enabled=!0,this.hpBarFrame=this.hpUI.findByName("imgHPFrame"),this.hpBarFill=this.hpUI.findByName("imgHPFill"),this.hpBarBlink=0,this.hpBarTapCol=new pc.Color(1,.9,.9),this.hpBarHurtCol=new pc.Color(1,.5,.5),this.hpBarHealCol=new pc.Color(.5,1,.5),this.scoreUI=this.screenUI.findByName("UI_Score"),this.scoreUI.enabled=!0,this.scoreCounter=this.scoreUI.findByName("txtScore"),this.scoreCoin=this.scoreUI.findByName("imgCoin"),this.scoreBlink=0,this.bonusCount=0,this.minimapUI=this.screenUI.findByName("UI_Minimap"),this.minimapUI.enabled=!0,this.specialGain=0,this.specialTap=this.screenUI.findByName("UI_Special"),this.specialTap.enabled=!0;let t=this.entity.getPosition();this.posX=t.x,this.posY=t.y,this.initY=this.posY,this.panAdjustRate=2.5,this.panAdjust=3,this.endReached=!1,this.gameOver=!1,this.xPower=0,this.yPower=0,this.maxHeight=this.directorScript.maxHeight,this.hpMax=100,this.hp=this.hpMax,this.distScore=0,this.collectScore=0,this.hitGround=!1,this.bounceGroundPower=-1,this.onGround=!1,this.currentCollider=null,this.currentColliderParam=[],this.currentReach=null,this.currentReachRadius=0,this.ouchieTime=0,this.slowTime=0,this.healEffect=0,this.animHold=0;let i=this.app.touch;i?i.on(pc.EVENT_TOUCHSTART,this.tapControl,this):this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.tapControl,this),this.entity.on("tapControl",this.tapControl,this),this.entity.on("tapSpecial",this.tapSpecial,this),this.entity.on("addScore",this.addScore,this),this.entity.on("updateScore",this.updateScoreCounter,this),this.entity.on("reachEnd",this.reachEnd,this)},ScPatrick.prototype.update=function(t){if(this.hpBarBlink>0&&(this.hpBarBlink-=t,this.hpBarBlink<=0&&(this.hpBarFrame.element.color=pc.Color.WHITE,this.hpBarFill.element.color=pc.Color.WHITE)),this.healEffect>0&&(this.healEffect-=t),this.gameOver||this.directorScript.gamePaused)return;if(this.endReached&&this.entity.getPosition().x>=18)return gtag("event","level_end"),this.gameOver=!0,this.director.fire("gameOver",!0),void(this.entity.enabled=!1);if(this.entity.sprite.currentClip.isPlaying&&this.entity.sprite.currentClip==this.entity.sprite.clip("Stung"))return;let i=this.xPower*t;this.ouchieTime<=0&&(i=Math.min(i,12*t),this.slowTime>0&&(i/=2)),i*=this.speedFactor;let e=this.yPower*t,s=!1;this.posY+e>this.maxHeight&&(s=!0,e=this.maxHeight-this.posY),this.slowTime>0&&(e/=2);let h=this.posX,r=1;if(h<=48&&(r=(60-h)/12,i*=r,e>0&&(e*=r)),this.panAdjustRate>0){let i=this.entity.getPosition(),e=this.panAdjust-i.x;if(0==e)this.panAdjustRate=0;else{let i=this.panAdjustRate,s=0;e<0?s=Math.max(-i*t,e):e>0&&(s=Math.min(i*t,e)),this.endReached||this.cam.fire("updateHorizontal",-s)}}let o=(i+Math.abs(e))/t;if(Math.random()*(50+o)/54>1){let t=this.entity.getPosition();this.healEffect>0?this.director.fire("stars",t.x,t.y,2):this.ouchieTime>0&&Math.random()<this.ouchieTime/1.5?this.director.fire("stars",t.x,t.y,0):this.slowTime>0&&Math.random()<this.slowTime/2?this.director.fire("stars",t.x,t.y,1):this.director.fire("bubs",t.x,t.y,.5)}if(this.onGround){if(this.xPower>0&&(this.xPower*=.99,i=Math.min(this.xPower,12)*t,this.posX+=i,this.endReached&&this.entity.translate(i,0,0),this.xPower<.5)){this.xPower=0,this.gameOver=!0;let t=this.app.root.findByName("Root");t.sound.stop(),1==ScRoot.sharedData.bgmState&&t.sound.play("GameOver"),this.director.fire("gameOver")}}else{this.posX+=i,this.endReached?(this.entity.translate(i,0,0),this.hitGround&&(this.posY+=e)):this.posY+=e;let h=this.posY;if(this.ouchieTime<=0?(this.xPower=Math.max(0,this.xPower-this.xDrop*t),this.yPower=Math.max(-12,this.yPower-this.yDrop*t/r),this.slowTime>0&&(this.slowTime-=t,this.slowTime<=0?this.slowTimeEnd():this.specialTimerText.element.text=Math.ceil(this.slowTime).toString())):(this.ouchieTime-=t,this.ouchieTime<=0?this.ouchieEnd():this.specialTimerText.element.text=Math.ceil(this.ouchieTime).toString()),0!=e){if(h<=1)if(h=1,this.posY=1,this.hitGround&&this.bounceGroundPower<1)this.onGround=!0,this.yPower=0,this.sprite.play("Fell"),this.endReached||(this.panAdjustRate=2,this.panAdjust=8);else{let t=this.app.touch;t?t.off(pc.EVENT_TOUCHSTART,this.tapControl):this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.tapControl),-1==this.bounceGroundPower?(this.bounceGroundPower=Math.min(-this.yPower/2,2*this.xPower),this.hitGround=!0,this.ouchieEnd(),this.slowTimeEnd(),this.entity.setEulerAngles(0,0,0),this.trail.sprite.play("None")):this.bounceGroundPower/=2,this.yPower=this.bounceGroundPower,this.sprite.play("HitGround")}!this.hitGround&&!this.endReached&&!s&&this.ouchieTime<=0?this.entity.setEulerAngles(0,0,ScUtils.point_direction(0,0,this.xPower,this.yPower)):this.entity.setEulerAngles(0,0,0)}}if(this.cam.fire("updateVertical",this.posY,e),!this.endReached)if(0!=i&&(this.addScore(i,!1),this.cam.fire("updateHorizontal",i),this.director.fire("distance",i)),this.hitGround){if(!this.onGround){let t=this.entity.getPosition(),i=t.x,e=t.y;this.collisionFoodTag(i,e,"foods"),this.collisionFoodTag(i,e,"coins")}}else{let i=this.entity.getPosition(),e=i.x,s=i.y;if(null==this.currentCollider)this.collisionCircleTag(e,s,1.2,"burger",this.collideBurger,"ReachBurger"),this.collisionFoodTag(e,s,"foods"),this.collisionFoodTag(e,s,"coins"),this.collisionJellyfishTag(e,s);else{let t=e-1,i=e+1,h=s+1,r=s-1,o=this.currentColliderParam;if(o[0]<0){let e=this.currentCollider.getPosition();ScUtils.coll_rect(t,i,h,r,e.x+o[0],e.x+o[1],e.y+o[2],e.y+o[3])||(this.currentCollider=null)}else o[0]>0?ScUtils.coll_circle(e,s,o[0],this.currentCollider)||(this.currentCollider=null):ScUtils.coll_yline(t,i,s,1.2,this.currentCollider)||(this.currentCollider=null)}this.animHold<=0?this.ouchieTime<=0&&(this.sprite.currentClip==this.clipFly||this.sprite.currentClip.isPlaying||(this.sprite.play("Fly"),this.trail.sprite.play("Fly"),this.trail.setLocalEulerAngles(0,0,0)),this.sprite.currentClip==this.clipFly&&(this.yPower>=0?this.trail.sprite.frame=1:this.trail.sprite.frame=0)):this.animHold-=t;let h=0;this.ouchieTime>0?h=1:this.trailPower<=0?this.yPower<=-2&&(h=-(this.yPower+2)/2):(h=this.trailPower/2,this.trailPower-=t),this.trail.sprite.opacity=Math.min(h,1)}},ScPatrick.prototype.boost=function(t,i,e=90){if(t)this.yPower+=i*Math.sin(e*pc.math.DEG_TO_RAD);else{e>0&&this.yPower<0&&(this.yPower=0);let t=e*pc.math.DEG_TO_RAD;this.xPower+=i*Math.cos(t),this.yPower+=i*Math.sin(t);let s=Math.atan(this.yPower/Math.min(this.xPower,12));this.trail.setEulerAngles(0,0,s)}this.yPower=Math.min(this.yPower,12)},ScPatrick.prototype.tapControl=function(t){if(t.event.preventDefault(),!(this.ouchieTime>0||this.directorScript.gamePaused)&&this.hp>0){let t=this.tapPower;this.xPower<8&&(t*=this.xPower/8),this.boost(!0,t),this.hp=Math.max(0,this.hp-1),this.hpBarFill.element.color=this.hpBarTapCol,this.hpBarBlink=.1,this.updateHPBar()}},ScPatrick.prototype.collisionRectTag=function(t,i,e,s,h,r,o,l,a,n,c,p,u=""){let d=this.shiftGroup.findByTag(c),y=o+1.5;for(let c of d){let d=c.getPosition(),m=d.x,f=d.y;if(ScUtils.coll_rect(e,s,h,r,m+o,m+l,f+a,f+n))return this.currentCollider=c,this.currentColliderParam=[o,l,a,n],(p=p.bind(this))(c,t,i,m,f),2;if(ScUtils.point_distance(t,i,m,f)<=y)return this.reachCheck(c,t,i,m,f,y,u)}return 0},ScPatrick.prototype.collisionCircleTag=function(t,i,e,s,h=null,r=""){let o=this.shiftGroup.findByTag(s),l=e+1.5;for(let s of o){let o=s.getPosition(),a=ScUtils.point_distance(t,i,o.x,o.y);if(!(a>l))return a>e?this.reachCheck(s,t,i,o.x,o.y,l,r):(null!=h&&(this.currentCollider=s,this.currentColliderParam[0]=e,(h=h.bind(this))(s,t,i,o.x,o.y,a)),2)}return 0},ScPatrick.prototype.collisionFoodTag=function(t,i,e){let s=this.shiftGroup.findByTag(e),h=0;for(let r of s){let s=r.getPosition(),o=ScUtils.point_distance(t,i,s.x,s.y);if(!(o>2.7)){if(!(o>1.2))return this.collideFood(r,e),2;1!=h&&1==this.reachCheck(r,t,i,s.x,s.y,2.7,"ReachFood")&&(h=1)}}return 0},ScPatrick.prototype.collisionJellyfishTag=function(t,i){let e=t-.5,s=t+.5,h=this.shiftGroup.findByTag("jelly");for(let r of h)if(ScUtils.coll_yline(e,s,i,1.2,r))return this.currentCollider=r,this.currentColliderParam[0]=0,this.collideJellyfish(r,t,i),2;return 0},ScPatrick.prototype.reachCheck=function(t,i,e,s,h,r,o){if(null==this.currentReach){if(i<s&&Math.abs(e-h)<1)return this.currentReach=t,this.currentReachRadius=r,this.reachAnimate(o),1}else if(i>=this.currentReach.getPosition().x||!ScUtils.coll_circle(i,e,this.currentReachRadius,this.currentReach)){if(this.entity.sprite.currentClip.isPlaying){let t=this.entity.sprite.currentClip;t!=this.entity.sprite.clip("ReachBurger")&&t!=this.entity.sprite.clip("ReachFood")||this.entity.sprite.stop()}return this.currentReach=null,-1}return 0},ScPatrick.prototype.reachAnimate=function(t){""!=t&&this.sprite.currentClip==this.clipFly&&(this.entity.sprite.play(t),"ReachBurger"==t&&(this.trail.sprite.play("Reach"),this.trailPower=2),"ReachFood"==t&&(this.animHold=.4))},ScPatrick.prototype.collideJellyfish=function(t,i,e){let s=t.getPosition().y;if(e>=s){let i=(e-(s+.8))/2;i<0&&(this.posY-=i,this.cam.fire("updateVertical",this.posY,i)),this.ouchieEnd(),this.entity.sprite.play("Bounce"),this.trail.sprite.play("BounceSmall"),this.trailPower=2,t.sprite.play("Bounce"),this.entity.sound.play("Bounce");let h=10*-(t.getPosition().z+8);if(0==h){let t=ScUtils.point_distance(0,0,this.xPower,this.yPower)/4;this.boost(!1,t,30)}else{let t=0;h>=6?t=60:h>=4.5?t=45:h>=3?t=30:h>=1.5&&(t=15),this.boost(!1,100*h%10*(this.yDrop/2),t)}gtag("event","collide",{object:"jellyfish",info:"bounce"})}else this.ouchieEnd(),this.slowTimeEnd(),this.entity.sprite.play("Stung"),this.trail.sprite.play("None"),this.hp-=20,this.hp<0&&(this.hp=0),this.updateHPBar(-1),this.director.fire("disperseJellyfishes",i,e),this.entity.sound.play("Shocked"),gtag("event","collide",{object:"jellyfish",info:"stung"})},ScPatrick.prototype.collideFood=function(t,i){if("coins"==i){let i=100;t.getLocalScale().x>1&&(i*=2),this.bonusCount+=i,this.entity.sound.play("Coin")}else{let i=1;3==t.sprite.frame&&(i=3),this.addScore(50*i),this.entity.sound.play("Food"),gtag("event","collide",{object:"food",info:i})}this.currentCollider=null,this.currentReach=null,t.destroy()},ScPatrick.prototype.collideBurger=function(t){if(t.script.scBurger.collected)return 0;this.hp=Math.min(this.hp+20,this.hpMax),this.updateHPBar(1),this.animHold=.5,this.healEffect=1,t.fire("collected",this),this.entity.sound.play("Burger"),gtag("event","collide",{object:"burger"})},ScPatrick.prototype.tapSpecial=function(t){-1!=t&&(0==t?(this.slowTime=0,this.ouchieTime=3,this.entity.sprite.play("Boost"),this.trail.sprite.play("Urchin"),this.trailPower=2,this.entity.setLocalEulerAngles(0,0,0),this.trail.setLocalEulerAngles(0,0,0),this.xPower=16,this.yPower=0,this.entity.sound.play("GainSpecial"),this.specialTimerText.enabled=!0,this.specialTimerText.element.text=Math.ceil(this.ouchieTime).toString()):1==t?(this.ouchieTime=0,this.slowTime=8,this.specialTimerText.enabled=!0,this.specialTimerText.element.text=Math.ceil(this.slowTime).toString()):(this.entity.sound.play("HealthGain"),this.hp=Math.min(this.hp+20,this.hpMax),this.updateHPBar(1),this.healEffect=1))},ScPatrick.prototype.ouchieEnd=function(){this.ouchieTime=0,this.slowTime<=0&&(this.specialTimerText.enabled=!1)},ScPatrick.prototype.slowTimeEnd=function(){this.slowTime=0,this.ouchieTime<=0&&(this.specialTimerText.enabled=!1)},ScPatrick.prototype.reachEnd=function(){this.endReached=!0;let t=this.app.touch;if(t?t.off(pc.EVENT_TOUCHSTART,this.tapControl):this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.tapControl),this.specialTimerText.enabled=!1,this.hitGround||this.ouchieTime>0)return;let i=ScUtils.choose("ReachBurger","ReachFood");this.sprite.play(i),this.entity.setEulerAngles(0,0,0),this.trail.sprite.play("Reach"),this.trail.sprite.opacity=1,this.trail.setLocalEulerAngles(0,0,0)},ScPatrick.prototype.updateHPBar=function(t=0){0!=t&&(this.hpBarBlink=.1,this.hpBarFrame.element.color=1==t?this.hpBarHealCol:this.hpBarHurtCol,this.hpBarFill.element.color=this.hpBarFrame.element.color);let i=this.hp/this.hpMax;this.hpBarFill.element.rect.z=i,this.hpBarFill.element.width=212*i,this.hpBarFill.element.anchor=this.hpBarFill.element.anchor},ScPatrick.prototype.addScore=function(t,i=!0){for(i?(this.collectScore+=t,this.updateScoreCounter()):(this.distScore+=t,this.updateScoreCounter(!1)),this.specialGain+=t;this.specialGain>=1e4;)this.specialGain-=1e4,this.specialTap.fire("addCount"),this.entity.sound.play("GainSpecial"),gtag("event","special_gain")},ScPatrick.prototype.updateScoreCounter=function(t=!0){let i=Math.min(Math.round(this.distScore+this.collectScore),999999);this.scoreCounter.element.text=ScUtils.formatNumber(i),t||this.scoreBlink>0?(this.scoreCoin.element.spriteFrame=1,this.scoreCoin.setLocalScale(.9,1.4,1),t?this.scoreBlink=4:this.scoreBlink--):(this.scoreCoin.element.spriteFrame=0,this.scoreCoin.setLocalScale(1,1,1))};var ScBurger=pc.createScript("scBurger");ScBurger.prototype.initialize=function(){this.angle=0,this.angleRate=45,this.initY=this.entity.getLocalPosition().y,this.patrickScript=null,this.collected=!1,this.entity.on("collected",(function(t){this.collected=!0,this.patrickScript=t,this.entity.sprite.play("Blip"),this.angleRate=0,this.entity.setLocalEulerAngles(0,0,0)}),this),this.entity.on("destroy",(function(){this.entity.enabled=!1}),this)},ScBurger.prototype.update=function(t){let i=this.angleRate*t;if(0!=i){let t=this.angle;t+=i,i>0?t>=10&&(this.angleRate=-this.angleRate):t<=-10&&(this.angleRate=-this.angleRate),this.angle=t;let e=this.entity.getLocalPosition();e.y=this.initY+Math.sin(9*(t+90)*pc.math.DEG_TO_RAD)/4,this.entity.setLocalPosition(e),this.entity.setLocalEulerAngles(0,0,t)}else this.entity.sprite.currentClip.isPlaying||(this.patrickScript.currentCollider=null,this.patrickScript.currentReach=null,this.entity.enabled=!1,this.entity.destroy())};var ScFoods=pc.createScript("scFoods");ScFoods.prototype.initialize=function(){this.angle=0,this.angleRate=30,this.initY=this.entity.getLocalPosition().y},ScFoods.prototype.update=function(t){let i=this.angleRate*t,e=this.angle;e+=i,i>0?e>=5&&(this.angleRate=-this.angleRate):e<=-5&&(this.angleRate=-this.angleRate),this.angle=e;let s=this.entity.getLocalPosition();s.y=this.initY+Math.sin(18*(e+90)*pc.math.DEG_TO_RAD)/8,this.entity.setLocalPosition(s),this.entity.setLocalEulerAngles(0,0,e)};var ScSpecialUI=pc.createScript("scSpecialUI");ScSpecialUI.prototype.initialize=function(){this.sceneRoot=this.app.root.findByName("SceneRoot"),this.director=this.sceneRoot.findByName("Director").script.scDirector,this.patrick=this.sceneRoot.findByName("oPatrick"),this.patrickScript=this.patrick.script.scPatrick,this.splash=this.sceneRoot.findByName("UI_SpecialSplash"),this.rev=this.entity.findByName("uiSpecialRev").script.scSpecialRev,this.button=this.entity.findByName("imgSpecialBtn"),this.state=0,this.specialCount=3,this.specialUnlocked=[!0,!0,!0],this.count=this.button.findByName("imgSpecialCount"),this.countElement=this.count.element,this.countElement.spriteFrame=this.specialCount,this.outline=new pc.Color,this.shadow=new pc.Color,this.countScale=1,this.entity.on("addCount",(function(){this.specialCount<5&&(this.specialCount<=0&&this.rev.fire("countOut",!1),this.specialCount++,this.countElement.spriteFrame=this.specialCount,this.countScale=1.5,this.count.setLocalScale(1.5,1.5,1))}),this),this.entity.on("button",this.buttonInteract,this),this.interacted()},ScSpecialUI.prototype.update=function(t){if(!this.patrick.enabled||this.patrickScript.hitGround)return void(this.entity.enabled=!1);let i=this.countScale;i>1&&(i-=2*t,i<1&&(i=1),this.count.setLocalScale(i,i,1),this.countScale=i)},ScSpecialUI.prototype.buttonInteract=function(t,i,e){if(2==t&&!this.director.gamePaused&&this.specialCount>0){let t=this.rev.specialCurr;-1!=t&&(this.specialCount--,this.countElement.spriteFrame=this.specialCount,this.specialCount<=0&&this.rev.fire("countOut"),this.splash.enabled=!0,this.splash.fire("activate",t))}this.interacted(e)},ScSpecialUI.prototype.interacted=function(t){let i=.75;(1==t||2==t)&&(i=1),this.countElement.opacity=i};var ScBonusSplash=pc.createScript("scBonusSplash");ScBonusSplash.prototype.initialize=function(){this.sceneRoot=this.app.root.findByName("SceneRoot"),this.director=this.sceneRoot.findByName("Director"),this.patrick=this.sceneRoot.findByName("oPatrick"),this.patrickScript=this.patrick.script.scPatrick,this.shade=this.entity.findByName("imgBonusShade"),this.portrait=this.entity.findByName("imgBonusPtrt"),this.textAre=this.entity.findByName("txtYouAre"),this.textTitle=this.entity.findByName("txtBonusTitle"),this.textScore=this.entity.findByName("txtBonusLabel"),this.textBonus=this.entity.findByName("txtBonusScore"),this.scaleDown=!1,this.portraitSide=!1,this.textSide=!1,this.duration=0,this.bonus=0,this.bonusInit=0,this.doFade=!1,this.themeNo=0,this.entity.on("activate",this.activate,this)},ScBonusSplash.prototype.update=function(t){if(!this.doFade){if(this.duration>0){let i=this.shade.element.opacity;i<.8&&(i+=4*t,this.shade.element.opacity=i);let e=3072*t,s=this.portrait.getLocalPosition();0!=s.x?(s.x+=e,s.x>0&&(s.x=0)):0!=s.y&&(s.y+=e,s.y>0&&(s.y=0)),this.portrait.setLocalPosition(s),s=this.textAre.getLocalPosition(),s.x<0?(s.x+=3*e,s.x>0&&(s.x=0)):s.y>0&&(s.y-=e,s.y<0&&(s.y=0)),this.textAre.setLocalPosition(s);let o=this.textTitle.getLocalScale().x;this.scaleDown?o=1+.95*(o-1):o<1.25&&(o+=3*t,o>=1.25&&(this.scaleDown=!0)),this.textTitle.setLocalScale(o,o,1),s=this.textScore.getLocalPosition(),s.x>0?(s.x-=e,s.x<0&&(s.x=0)):s.y<0&&(s.y+=e,s.y>0&&(s.y=0)),this.textScore.setLocalPosition(s),this.duration-=t}else if(this.bonus<=0)this.doFade=!0,this.textBonus.enabled=!1,1==ScRoot.sharedData.sfxState&&this.entity.sound.play("BonusEnd"),gtag("event","bonus_gain",{amount:this.bonusInit});else{let i=Math.min(Math.max(20,Math.ceil(this.bonus*t*2.5)),this.bonus);this.patrick.fire("addScore",i),this.bonus-=i}if(this.duration<=.5){let t=this.bonus/this.bonusInit,i=1+t/2;this.textBonus.element.text="+ "+ScUtils.formatNumber(this.bonus),this.textBonus.setLocalPosition(0,-(25+50*t),0),this.textBonus.setLocalScale(i,i,1),this.doFade||(this.textBonus.enabled=!0)}return}let i=this.shade.element.opacity;i>0&&(i-=4*t,i<0&&(i=0),this.shade.element.opacity=i);let e=4096*t,s=this.portrait.getLocalPosition();this.portraitSide?s.x>-this.portrait.element.width&&(s.x-=e):s.y>-this.portrait.element.height&&(s.y-=e),this.portrait.setLocalPosition(s),s=this.textAre.getLocalPosition(),this.textSide?s.x>-3072&&(s.x-=3*e):s.y<1024&&(s.y+=e),this.textAre.setLocalPosition(s),s=this.textScore.getLocalPosition(),this.textSide?s.x<1024&&(s.x+=e):s.y>-1024&&(s.y-=e),this.textScore.setLocalPosition(s);let o=.9*this.textTitle.getLocalScale().x;this.textTitle.setLocalScale(o,o,1),this.duration-=t,this.duration<=-.5&&(this.director.fire("pauseGame",!1),this.themeNo>=2&&this.patrick.fire("reachEnd"),this.entity.enabled=!1)},ScBonusSplash.prototype.activate=function(t){this.director.fire("pauseGame",!0),this.bonus=this.patrickScript.bonusCount,this.patrickScript.bonusCount=0,this.bonusInit=Math.max(1,this.bonus),this.textBonus.enabled=!1,this.duration=1,this.doFade=!1,this.themeNo=t-1,this.shade.element.opacity=0,Math.random()>=.5?(this.portrait.setLocalPosition(-this.portrait.element.width,0,0),this.portraitSide=!0):(this.portrait.setLocalPosition(0,-this.portrait.element.height,0),this.portraitSide=!1),this.scaleDown=!1,this.textTitle.setLocalScale(0,0,1),Math.random()>=.5?(this.textAre.setLocalPosition(-3072,0,0),this.textScore.setLocalPosition(1024,0,0),this.textSide=!0):(this.textAre.setLocalPosition(0,1024,0),this.textScore.setLocalPosition(0,-1024,0),this.textSide=!1),this.textTitle.element.text=1==t?"POP STAR":2==t?"VIRAL STAR":"GOLD STAR"};var ScSpecialSplash=pc.createScript("scSpecialSplash");ScSpecialSplash.prototype.initialize=function(){this.sceneRoot=this.app.root.findByName("SceneRoot"),this.director=this.sceneRoot.findByName("Director"),this.patrick=this.sceneRoot.findByName("oPatrick"),this.radial=this.entity.findByName("imgSpecialRad"),this.portrait=this.entity.findByName("imgSpecialPtrt"),this.rotateA=0,this.portraitSide=!1,this.duration=0,this.specialCurr=-1,this.entity.on("activate",this.activate,this)},ScSpecialSplash.prototype.update=function(t){if(this.duration>0){let i=this.radial.element.opacity;if(i<1&&(i+=5*t,i>1&&(i=1),this.radial.element.opacity=i),this.radial.rotateLocal(0,0,this.rotateA*t),this.duration<=.9){let i=3072*t,e=this.portrait.getLocalPosition();128!=e.x?(e.x+=i,e.x>128&&(e.x=128)):0!=e.y&&(e.y+=i,e.y>0&&(e.y=0)),this.portrait.setLocalPosition(e)}return void(this.duration-=t)}let i=this.radial.element.opacity;i>0&&(i-=5*t,i<0&&(i=0),this.radial.element.opacity=i);let e=4096*t,a=this.portrait.getLocalPosition();this.portraitSide?a.x>-this.portrait.element.width&&(a.x-=e):a.y>-this.portrait.element.height&&(a.y-=e),this.portrait.setLocalPosition(a),this.duration-=t,this.duration<=-.5&&(this.director.fire("pauseGame",!1),this.patrick.fire("tapSpecial",this.specialCurr),this.entity.enabled=!1,gtag("event","special_activate",{no:this.specialCurr}))},ScSpecialSplash.prototype.activate=function(t){this.director.fire("pauseGame",!0),this.duration=1,this.specialCurr=t,this.radial.element.opacity=0,this.rotateA=(5+10*Math.random())*ScUtils.choose(-1,1),this.portrait.element.spriteFrame=t,Math.random()>=.5?(this.portrait.setLocalPosition(-this.portrait.element.width,0,0),this.portraitSide=!0):(this.portrait.setLocalPosition(0,-this.portrait.element.height,0),this.portraitSide=!1)};var ScSpecialRev=pc.createScript("scSpecialRev");ScSpecialRev.prototype.initialize=function(){this.screen=this.app.root.findByName("2DScreen").screen,this.res=this.screen.resolution;let t=this.entity.getPosition();this.oX=(1+t.x)/2,this.oY=(1-t.y)/2,this.turn=0,this.icons=[[this.entity.findByName("imgSpecialIcon1"),-1],[this.entity.findByName("imgSpecialIcon2"),-1],[this.entity.findByName("imgSpecialIcon3"),-1]],this.iconCurr=1,this.hasSpecial=!0;let i=this.entity.parent.script.scSpecialUI.specialUnlocked,e=1,s=0;for(let t=0;t<3;t++){if(!i[t])continue;let n=this.icons[e][0];n.enabled=!0,n.findByName("Image").element.spriteFrame=t+2,this.icons[e][1]=t,s++,e=1==e?0:2}this.minDir=0,this.maxDir=0,s>1&&(this.minDir=-45,s>2&&(this.maxDir=45)),this.specialCurr=this.icons[1][1],this.state=0,this.initDir=0,this.updateRotate=!1,this.locked=!1,this.lastDiff=0,this.moved=0,this.on("countOut",(function(t=!0){let i=this.icons[this.iconCurr][0];t?(i.element.opacity=.5,i.element.spriteFrame=1,i.findByName("Image").element.opacity=.5,this.hasSpecial=!1):(i.element.opacity=1,i.element.spriteFrame=0,i.findByName("Image").element.opacity=1,this.hasSpecial=!0)}),this),this.app.touch?(this.entity.element.on("touchstart",(function(t){this.state=2,this.locked=!0,this.moved=0,this.initDir=ScUtils.point_direction_ui(this.oX*this.res.x,this.oY*this.res.y,t.x,t.y),t.event.preventDefault(),t.stopPropagation()}),this),this.entity.element.on("touchmove",(function(t){this.interact(t)}),this),this.entity.element.on("touchend",(function(t){this.moved<3?this.interact(t,2):this.interact(t,1),this.state=0}),this),this.entity.element.on("touchcancel",(function(t){this.interact(t,1),this.state=0}),this)):(this.entity.element.on("mousedown",(function(t){this.state=2,this.locked=!0,this.moved=0,this.initDir=ScUtils.point_direction_ui(this.oX*this.res.x,this.oY*this.res.y,t.x,t.y),t.stopPropagation()}),this),this.entity.element.on("mousemove",(function(t){this.interact(t)}),this),this.entity.element.on("mouseup",(function(t){this.moved<3?this.interact(t,2):this.interact(t,1),this.state=0}),this),this.entity.element.on("mouseleave",(function(t){this.interact(t,1),this.state=0}),this))},ScSpecialRev.prototype.update=function(t){let i=this.entity.getLocalEulerAngles().z,e=+i.toPrecision(2),s=e;if(!this.locked){let t=this.turn;if(0!=t)this.entity.rotateLocal(0,0,t),e+=t,t*=.98,(e<this.minDir||e>this.maxDir)&&(t*=.75),t>-.1&&t<.1&&(t=0),this.turn=t;else{let t=45*this.iconCurr-45;if(e!=t&&(e<this.minDir||e>this.maxDir||e>=t-15&&e<=t+15)){let s=.95*(i-t);s>-.05&&s<.05&&(s=0),e=t+s,this.entity.setLocalEulerAngles(0,0,e)}}}if(this.hasSpecial){let i=this.iconCurr;this.icons[i][0].rotateLocal(0,0,-45*t),this.icons[i][0].findByName("Image").rotateLocal(0,0,45*t)}if(s!=e||this.updateRotate){this.updateRotate=!1;let t=pc.math.clamp(Math.floor((e+45)/45+.5),0,2);if(t!=this.iconCurr&&-1!=this.icons[t][1]){let i=this.icons[this.iconCurr][0];i.element.opacity=.5,i.element.spriteFrame=1,i.setLocalScale(.67,.67,.67),i.findByName("Image").element.opacity=.5,this.iconCurr=t,i=this.icons[t][0],i.setLocalScale(1,1,1),this.hasSpecial&&(i.element.opacity=1,i.element.spriteFrame=0,i.findByName("Image").element.opacity=1),this.specialCurr=this.icons[t][1]}for(let t=0;t<3;t++)this.icons[t][0].findByName("Image").setEulerAngles(0,0,0)}},ScSpecialRev.prototype.interact=function(t,i=0){if(2!=this.state)return;let e=t;if(this.app.touch&&(e=t,t.event.preventDefault()),0==i){let t=ScUtils.point_direction_ui(this.oX*this.res.x,this.oY*this.res.y,e.x,e.y),i=ScUtils.ang_diff(this.initDir,t)*(this.app.touch?1.3:1);this.entity.rotateLocal(0,0,i),this.updateRotate=!0,this.initDir=t,this.lastDiff=i,this.moved++}else{if(1==i)this.turn=this.lastDiff/2;else{let t=this.entity.getLocalEulerAngles().z,i=ScUtils.ang_diff(this.initDir,135);i>0?i-=10:i+=10,this.entity.setLocalEulerAngles(0,0,pc.math.clamp(t+i,this.minDir,this.maxDir)),this.updateRotate=!0}this.moved=0,this.locked=!1,this.lastDiff=0}t.stopPropagation()};var ScMinimap=pc.createScript("scMinimap");ScMinimap.prototype.initialize=function(){this.tplMarker=this.entity.findByName("tplMarker"),this.themeStart=0,this.lengthFactor=3.2,this.distance=0,this.patrickY=0,this.markPatrick=this.tplMarker.clone(),this.entity.addChild(this.markPatrick),this.markPatrick.setLocalPosition(-240,0,0),this.markPatrick.enabled=!0,this.markersList=[],this.markersListN=0,this.entity.on("updateHorizontal",this.updateHorizontal,this),this.entity.on("updateVertical",(function(t){this.patrickY=t;let i=this.markersListN;for(let t=0;t<i;t++)-1==this.updateMarker(t)&&(t--,i--)}),this),this.entity.on("reset",(function(t,i){let e=this.markersListN;for(let t=0;t<e;t++)this.markersList[t][0].destroy();this.markersList=[],this.markersListN=0,this.lengthFactor=480/i,this.themeStart=t,this.updateHorizontal(t)}),this),this.entity.on("add",this.createMarker,this)},ScMinimap.prototype.update=function(t){},ScMinimap.prototype.createMarker=function(t,i,e=3){let s=this.tplMarker.clone();this.entity.insertChild(s,0);let r=(i-this.themeStart)*this.lengthFactor-240;s.setLocalPosition(r,0,0),s.element.spriteFrame=e,s.enabled=!0,this.markersList[this.markersListN]=[s,t],this.updateMarker(this.markersListN),this.markersListN++},ScMinimap.prototype.updateMarker=function(t){let i=this.markersList[t][1];if(!i.enabled)return this.markersList[t][0].destroy(),this.markersList.splice(t,1),this.markersListN--,-1;let e=(i.getLocalPosition().y-this.patrickY)/4.5,s=Math.abs(e)-1,r=1;s>0&&(r=1-Math.min(s/8,.5));let a=this.markersList[t][0],h=a.getLocalPosition();return h.y=32*pc.math.clamp(e,-1,1),a.setLocalPosition(h),a.setLocalScale(r,r,1),1},ScMinimap.prototype.updateHorizontal=function(t){let i=(t-this.themeStart)*this.lengthFactor,e=this.markPatrick.getLocalPosition();e.x=i-240,this.markPatrick.setLocalPosition(e),this.markPatrick.element.spriteFrame=i>=160?1:i>=320?2:0};var ScGameOverSplash=pc.createScript("scGameOverSplash");ScGameOverSplash.prototype.initialize=function(){this.sceneRoot=this.app.root.findByName("SceneRoot"),this.director=this.sceneRoot.findByName("Director"),this.endScreen=this.sceneRoot.findByName("2DScreen").findByName("UI_EndScreen"),this.portrait=this.entity.findByName("imgPatrickOver"),this.text=this.entity.findByName("txtGameOver"),this.nextBtn=this.entity.findByName("imgOverNextBtn"),this.duration=0,this.textS=0,this.textAng=0,this.textExpand=!0,this.entity.on("activate",this.activate,this),this.entity.on("button",(function(t){2==t&&(this.entity.enabled=!1,this.endScreen.enabled=!0,this.endScreen.fire("activate"))}),this)},ScGameOverSplash.prototype.update=function(t){if(this.duration<0)return;let e=this.entity.element.opacity;e<.9&&(e+=4*t,e>.9&&(e=.9),this.entity.element.opacity=e);let i=this.text.getLocalScale().x;if(this.textExpand?(i+=this.textS*t,i>1&&(this.textS*=.97,i>=1.5&&(this.textExpand=!1)),this.text.setLocalEulerAngles(0,0,i*this.textAng)):i>1&&(i*=.97,i<1&&(i=1),this.text.setLocalEulerAngles(0,0,(i-1)*this.textAng*2)),this.text.setLocalScale(i,i,1),this.duration<=.5){let e=2048*t,i=this.portrait.getLocalPosition();0!=i.y&&(i.y+=e,i.y>0&&(i.y=0),this.portrait.setLocalPosition(i)),this.duration<=.25&&(e=3072*t,i=this.nextBtn.getLocalPosition(),i.x>0&&(i.x-=e,i.x<0&&(i.x=0),this.nextBtn.setLocalPosition(i)))}this.duration-=t,this.duration<=0&&this.nextBtn.fire("lock",!1)},ScGameOverSplash.prototype.activate=function(t=!1){this.director.fire("pauseGame",!0),this.duration=.75,this.entity.element.opacity=0,this.portrait.setLocalPosition(0,-640,0),this.portrait.element.spriteFrame=t?1:0,this.text.setLocalScale(0,0,1),this.textS=8,this.textAng=pc.math.random(-2.5,2.5),this.textExpand=!0,this.nextBtn.setLocalPosition(512,0,0),this.nextBtn.fire("lock")};var ScButtonUi=pc.createScript("scButtonUi");ScButtonUi.attributes.add("clickLink",{type:"entity",title:"Link Entity"}),ScButtonUi.attributes.add("clickEvent",{type:"string",title:"Click Event",default:"default"}),ScButtonUi.attributes.add("onTouch",{type:"boolean",title:"On Touch",default:!1}),ScButtonUi.attributes.add("noVFX",{type:"boolean",title:"No VFX",default:!1}),ScButtonUi.attributes.add("noSFX",{type:"boolean",title:"No SFX",default:!1}),ScButtonUi.attributes.add("isOpaque",{type:"boolean",title:"Opaque",default:!1}),ScButtonUi.attributes.add("simpleText",{type:"boolean",title:"Simple Text",default:!1}),ScButtonUi.prototype.initialize=function(){this.root=this.app.root.findByName("Root"),this.locked=!1,this.state=0,this.initX=0,this.initY=0,this.noVFX||(this.isOpaque||(this.entity.element.opacity=.75),this.entity.element.spriteFrame=0,this.text=this.entity.findByName("Text"),null!=this.text&&(this.simpleText?(this.textColA=this.text.element.color.clone(),this.textColB=this.text.element.outlineColor.clone()):(this.text.setLocalPosition(4,6,0),this.text.element.shadowOffset=new pc.Vec2(-.2,-.5)),this.text.element.opacity=this.entity.element.opacity)),this.entity.on("lock",(function(t=!0){this.locked=t}),this),this.app.touch?(this.entity.element.on("touchend",(function(t){this.onTouch||2!=this.state||this.interacted(0,2),this.state=0,t.event.preventDefault()}),this),this.entity.element.on("touchstart",(function(t){this.onTouch?this.interacted(2,2):this.interacted(2,1),this.state=2,this.initX=t.x,this.initY=t.y,t.event.preventDefault(),t.stopPropagation()}),this),this.entity.element.on("touchmove",(function(t){ScUtils.point_distance(this.initX,this.initY,t.x,t.y)>96&&(this.interacted(),this.state=0),t.event.preventDefault()}),this),this.entity.element.on("touchcancel",(function(t){this.interacted(),this.state=0,t.event.preventDefault()}),this)):(this.entity.element.on("mousedown",(function(t){1==this.state&&(this.interacted(2,1),this.state=2),t.stopPropagation()}),this),this.entity.element.on("mouseup",(function(t){2==this.state&&(this.interacted(1,2),this.state=1)}),this),this.entity.element.on("mouseenter",(function(t){this.interacted(1),this.state=1}),this),this.entity.element.on("mouseleave",(function(t){this.interacted(),this.state=0}),this))},ScButtonUi.prototype.update=function(t){},ScButtonUi.prototype.interacted=function(t=0,e=0){if(!this.noVFX){this.locked&&(t=0);let e=.75,i=0;1==t?(e=1,i=1):2==t&&(e=1,i=2),this.isOpaque&&(e=1),this.entity.element.opacity=e,this.entity.element.spriteFrame=i,null!=this.text&&(this.simpleText?this.text.element.color=2==t?this.textColB:this.textColA:2==t?(this.text.element.shadowOffset=pc.Vec2.ZERO,this.text.setLocalPosition(-1,-1,0)):(this.text.element.shadowOffset=new pc.Vec2(-.2,-.5),1==t?this.text.setLocalPosition(0,0,0):this.text.setLocalPosition(4,6,0)),this.text.element.opacity=e)}this.locked||(2!=e||this.noSFX||1!=ScRoot.sharedData.sfxState||this.root.fire("click"),this.clickLink.fire("button",e,this.clickEvent,t))};var ScEndScreenSplash=pc.createScript("scEndScreenSplash");ScEndScreenSplash.prototype.initialize=function(){this.sceneRoot=this.app.root.findByName("SceneRoot"),this.director=this.sceneRoot.findByName("Director"),this.directorScript=this.sceneRoot.findByName("Director").script.scDirector,this.patrickScript=this.sceneRoot.findByName("oPatrick").script.scPatrick,this.unlocked=this.sceneRoot.findByName("2DScreen").findByName("UI_Special").script.scSpecialUI.specialUnlocked,this.uiCongrats=this.entity.findByName("uiCongrats"),this.congrats=this.uiCongrats.findByName("txtCongrats"),this.cover=this.uiCongrats.findByName("imgCongratsCover"),this.uiEnsemble=this.entity.findByName("uiEnsemble"),this.uiScore=this.entity.findByName("uiEndScore"),this.scoreGroup=this.uiScore.findByName("scoreGroup"),this.finalScore=this.scoreGroup.findByName("txtFinalScore"),this.leaderBtn=this.entity.findByName("imgLeaderBtn"),this.replayBtn=this.entity.findByName("imgEndReplayBtn"),this.duration=0,this.congratsS=0,this.textS=0,this.textExpand=!0,this.scoreS=0,this.scoreAng=0,this.buttonUnlocked=!1,this.changingScene=!1,this.entity.on("activate",this.activate,this),this.entity.on("button",(function(t,e){if(2!=t||this.changingScene)return;this.changingScene=!0;let i=this.app.root.findByName("Root");"replay"==e?(i.fire("postStart"),i.fire("changeScene","scnPlay")):(i.sound.stop(),1==ScRoot.sharedData.bgmState&&i.sound.play("Menu"),i.fire("changeScene","scnLeaderboard"))}),this)},ScEndScreenSplash.prototype.update=function(t){let e=this.entity.element.opacity;if(e<1)return e+=4*t,e>=1&&(e=1,this.uiCongrats.enabled=!0),void(this.entity.element.opacity=e);let i=512*t,s=this.uiCongrats.getLocalPosition();if(s.y>0)s.y-=i,s.y<0&&(s.y=0),this.uiCongrats.setLocalPosition(s),s=this.congrats.getLocalPosition(),s.y<0&&(i=1024*t,s.y+=i,s.y>=0&&(s.y=0,this.uiEnsemble.enabled=!0,this.uiScore.enabled=!0),this.congrats.setLocalPosition(s),s=this.cover.getLocalPosition(),s.y>0&&(s.y-=i,s.y<0&&(s.y=0),this.cover.setLocalPosition(s)));else{let e=this.uiCongrats.getLocalScale().x;e+=this.congratsS*t,this.uiCongrats.setLocalScale(e,e,1),this.congratsS*=.99,e<=1?this.congratsS=.5:e>=1.2&&(this.congratsS=-.5)}if(this.duration<=1){let e=this.uiEnsemble.element.width;if(e>0&&(e*=.9,e<1&&(e=0),this.uiEnsemble.element.width=e),this.duration<=.75){let e=this.uiScore.getLocalScale().x;if(this.textExpand)e+=this.textS*t,e>1&&(this.textS*=.98,e>=1.5&&(this.textExpand=!1)),this.uiScore.setLocalScale(e,e,1);else if(e>1)e*=.98,e<1&&(e=1),this.uiScore.setLocalScale(e,e,1);else{if(e=this.scoreGroup.getLocalScale().x,e+=this.scoreS*t,this.scoreGroup.setLocalScale(e,e,1),this.scoreGroup.rotateLocal(0,0,this.scoreAng*t),this.scoreS*=.98,e<=1)this.scoreS=2;else if(e>=1.5){this.scoreS=-2;let t=this.scoreGroup.getLocalEulerAngles().z,e=Math.abs(t)+5*Math.random();t>0&&(e=-e),this.scoreAng=e}this.duration<=.25&&0!=this.directorScript.scorePost&&(i=3072*t,s=this.leaderBtn.getLocalPosition(),s.x>0&&(s.x-=i,s.x<0&&(s.x=0),this.leaderBtn.setLocalPosition(s)),s=this.replayBtn.getLocalPosition(),s.x<0&&(s.x+=i,s.x>0&&(s.x=0),this.replayBtn.setLocalPosition(s)))}}}this.buttonUnlocked||(this.duration>0?this.duration-=t:0!=this.directorScript.scorePost&&(this.buttonUnlocked=!0,this.replayBtn.fire("lock",!1),this.leaderBtn.fire("lock",!1)))},ScEndScreenSplash.prototype.activate=function(){this.director.fire("pauseGame",!0),this.duration=1.25,this.uiCongrats.enabled=!1,this.uiEnsemble.enabled=!1,this.uiScore.enabled=!1,this.entity.element.opacity=0,this.uiCongrats.setLocalPosition(1024,256,0),this.congrats.setLocalPosition(0,-256,0),this.cover.setLocalPosition(1024,256,0),this.congratsS=.5,this.uiEnsemble.element.width=8192,this.uiScore.setLocalScale(0,0,1),this.textS=5,this.textExpand=!0,this.scoreGroup.setLocalScale(1.5,1.5,1),this.scoreGroup.setLocalEulerAngles(0,0,0),this.scoreS=-2,this.scoreAng=2.5;let t=Math.min(Math.round(this.patrickScript.distScore+this.patrickScript.collectScore),999999);this.finalScore.element.text=ScUtils.formatNumber(t),ScRoot.sharedData.latestScore=t,this.replayBtn.setLocalPosition(-512,0,0),this.leaderBtn.setLocalPosition(512,0,0),this.replayBtn.fire("lock"),this.leaderBtn.fire("lock"),this.buttonUnlocked=!1;let e=this.uiEnsemble.children,i=e.length;for(let t=0;t<i;t++){let s=e[t],o=s.name,n=parseInt(o.substr(o.length-1));if(0==n)continue;let c=n;this.unlocked[n-1]||(c+=i),s.element.spriteFrame=c}};var ScHome=pc.createScript("scHome");ScHome.prototype.initialize=function(){this.star0=this.entity.findByName("imgStar0"),this.star1=this.entity.findByName("imgStar1"),this.star2=this.entity.findByName("imgStar2"),this.star3=this.entity.findByName("imgStar3"),this.star4=this.entity.findByName("imgStar4"),this.board=this.entity.findByName("imgBoardBox"),this.patrick=this.entity.findByName("imgPatrick"),this.titleYear=this.entity.findByName("YEAR"),this.titleOf=this.entity.findByName("OF"),this.titleThe=this.entity.findByName("THE"),this.titleStar=this.entity.findByName("STAR"),this.stars0=this.titleStar.findByName("stars0"),this.stars1=this.titleStar.findByName("stars1"),this.stars2=this.titleStar.findByName("stars2"),this.stars3=this.titleStar.findByName("stars3"),this.stars4=this.titleStar.findByName("stars4"),this.startBtn=this.entity.findByName("imgStartBtn"),this.logoutBtn=this.entity.findByName("imgLogoutBtn"),this.trophyBtn=this.entity.findByName("imgTrophyBtn"),this.settingsBtn=this.entity.findByName("imgSettingsBtn"),ScRoot.sharedData.login||(this.logoutBtn.enabled=!1),this.duration=1,this.starTick=1,this.titleDone=!1,this.star0.enabled=!1,this.star1.enabled=!1,this.star2.enabled=!1,this.star3.enabled=!1,this.star4.enabled=!1,this.stars0.enabled=!1,this.stars1.enabled=!1,this.stars2.enabled=!1,this.stars3.enabled=!1,this.stars4.enabled=!1,this.patrick.setLocalPosition(640,-512,0),this.titleYear.setLocalPosition(0,1024,0),this.titleOf.setLocalPosition(-512,0,0),this.titleThe.setLocalPosition(0,-1024,0),this.titleStar.setLocalPosition(2048,0,0),this.startBtn.setLocalPosition(-1024,0,0),this.logoutBtn.setLocalPosition(0,-512,0),this.trophyBtn.setLocalPosition(0,-768,0),this.settingsBtn.setLocalPosition(512,0,0),this.changingScene=!1,this.entity.on("button",(function(t,i){if(this.duration>0||2!=t||this.changingScene)return;this.changingScene=!0;let s=this.app.root.findByName("Root");"start"==i?ScRoot.sharedData.login?ScRoot.sharedData.tuts?s.fire("changeScene","scnInstructions"):(s.sound.stop(),1==ScRoot.sharedData.bgmState&&s.sound.play("Game"),s.fire("postStart"),s.fire("changeScene","scnPlay")):s.fire("changeScene","scnLogin"):"logout"==i?(this.changingScene=!1,this.logoutBtn.enabled=!1,s.fire("goLogout")):"trophy"==i?s.fire("changeScene","scnLeaderboard"):"settings"==i&&s.fire("changeScene","scnSettings")}),this)},ScHome.prototype.update=function(t){if(this.duration>=.5||!this.titleDone){let i=this.duration;this.star0.enabled=i<=1,this.star1.enabled=i<=.9,this.star2.enabled=i<=.8,this.star3.enabled=i<=.7,this.star4.enabled=i<=.6,i*=2,this.star0.element.opacity=Math.min(2.8-i,1),this.star1.element.opacity=Math.min(2.6-i,1),this.star2.element.opacity=Math.min(2.4-i,1),this.star3.element.opacity=Math.min(2.2-i,1),this.star4.element.opacity=Math.min(2-i,1);let s=10240*t,e=this.titleYear.getLocalPosition();e.y>0?(e.y-=s,e.y<0&&(e.y=0),this.titleYear.setLocalPosition(e)):(e=this.titleOf.getLocalPosition(),e.x<0?(e.x+=s,e.x>0&&(e.x=0),this.titleOf.setLocalPosition(e)):(e=this.titleThe.getLocalPosition(),e.y<0?(e.y+=s,e.y>0&&(e.y=0),this.titleThe.setLocalPosition(e)):(e=this.titleStar.getLocalPosition(),e.x>0&&(e.x-=12800*t,e.x<=0&&(e.x=0,this.titleDone=!0),this.titleStar.setLocalPosition(e)))))}if(this.duration<=.75){let i=this.starTick;if(this.stars0.enabled=i<=.85,this.stars1.enabled=i<=.7,this.stars2.enabled=i<=.55,this.stars3.enabled=i<=.4,this.stars4.enabled=i<=.25,i-=t,this.starTick=i<0?1-i:i,this.duration<=0)return;if(this.duration<=.6){let i=3072*t;pos=this.patrick.getLocalPosition(),pos.x>0&&(pos.x-=i,pos.x<0&&(pos.x=0)),pos.y<0&&(pos.y+=i,pos.y>0&&(pos.y=0)),this.patrick.setLocalPosition(pos)}}if(this.duration<.5){let i=4096*t,s=this.startBtn.getLocalPosition();s.x<0&&(s.x+=i,s.x>=0&&(s.x=0,this.startBtn.fire("lock",!1)),this.startBtn.setLocalPosition(s)),this.duration<.35&&(i=3072*t,s=this.logoutBtn.getLocalPosition(),s.y<0&&(s.y+=i,s.y>=0&&(s.y=0,this.logoutBtn.fire("lock",!1)),this.logoutBtn.setLocalPosition(s)),s=this.trophyBtn.getLocalPosition(),s.y<0&&(s.y+=i,s.y>=0&&(s.y=0,this.trophyBtn.fire("lock",!1)),this.trophyBtn.setLocalPosition(s)),this.duration<.25&&(s=this.settingsBtn.getLocalPosition(),s.x>0&&(s.x-=i,s.x<=0&&(s.x=0,this.settingsBtn.fire("lock",!1)),this.settingsBtn.setLocalPosition(s))))}this.duration-=t};var ScUtils=pc.createScript("scUtils");ScUtils.formatNumber=function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},ScUtils.irandom=function(t){return Math.floor(Math.random()*(t+1))},ScUtils.choose=function(){return arguments[Math.floor(Math.random()*arguments.length)]},ScUtils.point_direction=function(t,n,i,c){let r=Math.atan((c-n)/(i-t))*pc.math.RAD_TO_DEG;return t>i&&(r+=180),r},ScUtils.point_distance=function(t,n,i,c){let r=i-t,o=c-n;return Math.sqrt(r*r+o*o)},ScUtils.ang_diff=function(t,n){return(n-t+180)%360-180},ScUtils.point_direction_ui=function(t,n,i,c){let r=Math.atan((n-c)/(i-t))*pc.math.RAD_TO_DEG;return t>i&&(r+=180),r},ScUtils.coll_rect=function(t,n,i,c,r,o,e,l){return t<o&&n>r&&i>l&&c<e},ScUtils.coll_circle=function(t,n,i,c){let r=c.getPosition();return ScUtils.point_distance(t,n,r.x,r.y)<=i}.bind(this),ScUtils.coll_yline=function(t,n,i,c,r){let o=r.getPosition(),e=o.x,l=i-o.y;return e>=t&&e<=n&&l>=-c&&l<=c};var ScLogin=pc.createScript("scLogin");ScLogin.prototype.initialize=function(){let t=this.entity.findByName("Group");this.group=t,this.patrick=t.findByName("imgPatrick"),this.loginText=t.findByName("txtLogin"),this.registText=t.findByName("txtRegister"),this.userBox=t.findByName("boxUsername"),this.passBox=t.findByName("boxPassword"),this.pass2Box=t.findByName("boxPassword2"),this.emailBox=t.findByName("boxEmail"),this.forgotBtn=t.findByName("txtForgot"),this.loginBtn=t.findByName("imgLoginBtn"),this.registBtn=t.findByName("imgRegisterBtn"),this.backBtn=t.findByName("imgBackBtn"),this.skipBtn=t.findByName("imgSkipBtn"),this.notifText=t.findByName("txtNotif"),this.notifShrink=!1,this.notifValidCol=new pc.Color(0,.75,.75),this.warning=this.entity.findByName("Warning"),this.stars=[this.entity.findByName("imgStar0"),this.entity.findByName("imgStar1"),this.entity.findByName("imgStar2"),this.entity.findByName("imgStar3"),this.entity.findByName("imgStar4"),this.entity.findByName("imgStar5"),this.entity.findByName("imgStar6"),this.entity.findByName("imgStar7")],this.loginMode=!0,this.duration=1,this.patrick.setLocalPosition(0,-1024,0),this.loginText.setLocalPosition(0,256,0),this.registText.setLocalPosition(0,256,0),this.userBox.setLocalPosition(-1280,0,0),this.passBox.setLocalPosition(-1536,0,0),this.pass2Box.setLocalPosition(0,138,0),this.emailBox.setLocalPosition(0,300,0),this.forgotBtn.setLocalPosition(0,120,0),this.loginBtn.setLocalPosition(-1792,0,0),this.registBtn.setLocalPosition(0,-512,0),this.backBtn.setLocalPosition(-512,0,0),this.skipBtn.setLocalPosition(512,0,0),this.forgotBtn.enabled=!1,this.pass2Box.enabled=!1,this.emailBox.enabled=!1,this.focusColor=new pc.Color(247/255,1,215/255),this.boxFocusIndex=-1,this.keyPress=void 0,this.tickHighlight=0,this.tickCarat=.25,this.keyboardGroup=this.entity.findByName("Keyboard"),this.keyboard=this.keyboardGroup.findByName("imgKeyboard"),this.boxKeyboard=this.keyboardGroup.findByName("boxKeyboard"),this.keySetCurr=-1,this.keysAlt=!1,this.keysShift=0,this.keyboardBox=this.keyboardGroup.findByName("boxKeyboard"),this.carat=this.keyboardBox.findByName("Carat"),this.boxArray=[this.userBox,this.passBox,this.pass2Box,this.emailBox,this.keyboardBox],this.boxStrings=["","","",""],this.boxTexts=[this.userBox.findByName("Text"),this.passBox.findByName("Text"),this.pass2Box.findByName("Text"),this.emailBox.findByName("Text"),this.keyboardBox.findByName("Text")],this.boxHints=[this.userBox.findByName("Hint"),this.passBox.findByName("Hint"),this.pass2Box.findByName("Hint"),this.emailBox.findByName("Hint"),this.keyboardBox.findByName("Hint")],this.characters=this.keyboard.findByName("Characters"),this.arrayKeys=[this.characters.findByName("Q"),this.characters.findByName("W"),this.characters.findByName("E"),this.characters.findByName("R"),this.characters.findByName("T"),this.characters.findByName("Y"),this.characters.findByName("U"),this.characters.findByName("I"),this.characters.findByName("O"),this.characters.findByName("P"),this.characters.findByName("A"),this.characters.findByName("S"),this.characters.findByName("D"),this.characters.findByName("F"),this.characters.findByName("G"),this.characters.findByName("H"),this.characters.findByName("J"),this.characters.findByName("K"),this.characters.findByName("L"),this.characters.findByName("Z"),this.characters.findByName("X"),this.characters.findByName("C"),this.characters.findByName("V"),this.characters.findByName("B"),this.characters.findByName("N"),this.characters.findByName("M"),this.characters.findByName("-"),this.characters.findByName("_"),this.characters.findByName("@"),this.characters.findByName(".")],this.arrayKeysSpec=[this.keyboard.findByName("Shift"),this.keyboard.findByName("Del"),this.keyboard.findByName("Dots"),this.keyboard.findByName("Up"),this.keyboard.findByName("Down"),this.keyboard.findByName("Enter")],this.goPlay=!1,this.delayPlay=0,this.changingScene=!1,this.entity.on("button",this.buttonHandle,this),this.app.keyboard.on(pc.EVENT_KEYDOWN,this.onKeyDown,this),this.app.keyboard.on(pc.EVENT_KEYUP,this.onKeyUp,this)},ScLogin.prototype.update=function(t){if(this.updateAnimations(t),this.tickHighlight>0&&(this.tickHighlight-=t),this.keyboardUpdate(t),this.tickCarat-=t,this.tickCarat<=0&&(this.tickCarat=.25,this.carat.element.opacity=0==this.carat.element.opacity?1:0),this.goPlay)if(this.delayPlay<=0){this.goPlay=!1,this.removeKeyboardListeners();let t=this.app.root.findByName("Root");ScRoot.sharedData.tuts?t.fire("changeScene","scnInstructions"):(t.sound.stop(),1==ScRoot.sharedData.bgmState&&t.sound.play("Game"),t.fire("postStart"),t.fire("changeScene","scnPlay"))}else this.delayPlay-=t},ScLogin.prototype.clickBox=function(t){this.boxFocusIndex!=t?(this.focusBox(t),this.tickHighlight=.5,this.keyboardShow()):this.tickHighlight>0?(this.tickHighlight=0,this.boxStrings[t].length>0&&(this.boxTexts[t].element.outlineThickness=1,this.boxTexts[4].element.outlineThickness=1)):(this.tickHighlight=.5,this.boxTexts[t].element.outlineThickness=0,this.boxTexts[4].element.outlineThickness=0)},ScLogin.prototype.focusBox=function(t){this.unfocusBox(),this.boxFocusIndex=t,this.boxArray[t].element.color=this.focusColor,this.boxTexts[4].element.text=this.boxTexts[t].element.text,this.boxHints[4].element.text=this.boxHints[t].element.text,this.boxTexts[4].element.outlineThickness=this.boxTexts[t].element.outlineThickness,this.carat.enabled=!0,this.carat.setLocalPosition(this.boxTexts[t].element.textWidth,0,0),this.keyboardGroup.enabled||this.carat.reparent(this.boxArray[t]),this.keyboardChange()},ScLogin.prototype.unfocusBox=function(){let t=this.boxFocusIndex;-1!=t&&(this.boxArray[t].element.color=pc.Color.WHITE,this.boxTexts[t].element.outlineThickness=0,this.boxFocusIndex=-1),this.carat.enabled=!1},ScLogin.prototype.navigateBox=function(t,i=!1){i?t>0&&this.focusBox(t-1):(0==t||!this.loginMode&&t<3)&&this.focusBox(t+1)},ScLogin.prototype.clearBox=function(t){this.boxStrings[t]="",this.boxTexts[t].element.text="",this.boxHints[t].enabled=!0,this.boxTexts[t].element.outlineThickness=0},ScLogin.prototype.keyboardHide=function(){if(this.keyboardGroup.enabled){this.keyboardGroup.enabled=!1,this.keyboardGroup.element.opacity=0,this.keyboard.setLocalPosition(1024,-256,0),this.boxKeyboard.setLocalScale(0,0,1);let t=this.arrayKeys;for(let i=0;i<30;i++)t[i].fire("lock");t=this.arrayKeysSpec;for(let i=0;i<6;i++)t[i].fire("lock");this.carat.reparent(this.boxArray[this.boxFocusIndex])}},ScLogin.prototype.keyboardShow=function(){if(!this.keyboardGroup.enabled&&this.app.touch){this.keyboardGroup.enabled=!0,this.keysAlt=!1,this.keysShift=0,this.keyboardChange();let t=this.arrayKeys;for(let i=0;i<30;i++)t[i].fire("lock",!1);t=this.arrayKeysSpec;for(let i=0;i<6;i++)t[i].fire("lock",!1);this.carat.reparent(this.boxArray[4])}},ScLogin.prototype.keyboardUpdate=function(t){if(!this.keyboardGroup.enabled)return;let i=this.keyboardGroup.element.opacity;i<.9&&(i+=4*t,i>.9&&(i=.9),this.keyboardGroup.element.opacity=i);let e=this.keyboard.getLocalPosition();e.y<230&&(e.y+=2048*t,e.y>230&&(e.y=230),this.keyboard.setLocalPosition(e));let s=this.boxKeyboard.getLocalScale().x;s<1&&(s+=4*t,s>1&&(s=1),this.boxKeyboard.setLocalScale(s,s,1))},ScLogin.prototype.keyboardChange=function(){let t=this.boxFocusIndex,i=0;if(this.keysAlt?i=0==t||3==t?4:0!=this.keysShift?3:2:0!=this.keysShift&&(i=1),i!=this.keySetCurr){this.keySetCurr=i;let t=this.arrayKeys;for(let e=0;e<30;e++)t[e].findByName("Text").element.text=ScKeys.keySets[i][e]}},ScLogin.prototype.onKeyDown=function(t){let i=t.key;this.keyPress==i&&i!=pc.KEY_BACKSPACE||(this.keyPress=i,this.actionKey(i,t.event.key),t.event.preventDefault())},ScLogin.prototype.onKeyUp=function(t){t.key===this.keyPress&&(this.keyPress=void 0)},ScLogin.prototype.actionKey=function(t,i="",e=!1){if(t===pc.KEY_ENTER){this.unfocusBox(),this.keyboardHide(),this.notifText.enabled=!1;let t=this,i=this.app.root.findByName("Root");return void(this.loginMode?0==this.boxStrings[0].length||0==this.boxStrings[1].length?(this.loginNotif("PLEASE FILL ALL FIELDS"),0==this.boxStrings[0].length&&this.boxArray[0].translateLocal(32,0,0),0==this.boxStrings[1].length&&this.boxArray[1].translateLocal(48,0,0)):this.boxStrings[1].length<8?this.loginNotif("INVALID LOGIN",1):i.fire("postLogin",this.boxStrings[0],this.boxStrings[1],(function(i){i?t.loginNotif("LOGIN SUCCESSFUL",-1):t.loginNotif("INVALID LOGIN",1)})):0==this.boxStrings[0].length||0==this.boxStrings[1].length||0==this.boxStrings[2].length||0==this.boxStrings[3].length?(this.loginNotif("PLEASE FILL ALL FIELDS"),0==this.boxStrings[0].length&&this.boxArray[0].translateLocal(32,0,0),0==this.boxStrings[1].length&&this.boxArray[1].translateLocal(40,0,0),0==this.boxStrings[2].length&&this.boxArray[2].translateLocal(48,0,0),0==this.boxStrings[3].length&&this.boxArray[3].translateLocal(56,0,0)):this.boxStrings[1].length<8?(this.loginNotif("PASSWORD IS TOO SHORT"),this.boxArray[1].translateLocal(32,0,0)):this.boxStrings[1]!=this.boxStrings[2]?(this.loginNotif("PASSWORDS DON'T MATCH"),this.boxArray[1].translateLocal(32,0,0),this.boxArray[2].translateLocal(56,0,0)):i.fire("postRegister",this.boxStrings[0],this.boxStrings[3],this.boxStrings[1],(function(i){i?(t.loginNotif("REGISTRATION SUCCESSFUL",-2),t.toLogin(!1)):t.loginNotif("INVALID REGISTER",2)})))}let s=this.boxFocusIndex;if(-1==s)return;let o=this.boxTexts[s].element.outlineThickness;if(t===pc.KEY_BACKSPACE){let t=this.boxStrings[s].length;t>0&&(1==o||1==t?(this.clearBox(s),this.clearBox(4)):(this.boxStrings[s]=this.boxStrings[s].substr(0,t-1),this.boxTexts[s].element.text=1==s||2==s?"•".repeat(this.boxStrings[s].length):this.boxStrings[s],this.boxTexts[4].element.text=this.boxTexts[s].element.text),this.carat.setLocalPosition(this.boxTexts[s].element.textWidth,0,0))}else if(t===pc.KEY_TAB)this.navigateBox(s,this.app.keyboard.isPressed(pc.KEY_SHIFT));else if(65==t&&this.app.keyboard.isPressed(pc.KEY_CONTROL))this.boxStrings[s].length>0&&(this.boxTexts[s].element.outlineThickness=0==o?1:0,this.boxTexts[4].element.outlineThickness=this.boxTexts[s].element.outlineThickness);else if(e||t>=48&&t<=57||t>=65&&t<=90||t>=96&&t<=105||t>=186&&t<=192||t>=219&&t<=222){if(""==i)return;(1==s||2==s||0==s&&-1!=i.search(/^[0-9a-zA-Z_-]+$/)||3==s&&-1!=i.search(/^[0-9a-zA-Z.@_-]+$/))&&(1==o&&this.clearBox(s),this.boxStrings[s]+=i,this.boxHints[s].enabled=!1,this.boxTexts[s].element.text+=1==s||2==s?"•":i,this.boxTexts[4].element.text=this.boxTexts[s].element.text,this.carat.setLocalPosition(this.boxTexts[s].element.textWidth,0,0))}},ScLogin.prototype.removeKeyboardListeners=function(){this.app.keyboard.off(pc.EVENT_KEYDOWN,this.onKeyDown,this),this.app.keyboard.off(pc.EVENT_KEYUP,this.onKeyUp,this)},ScLogin.prototype.buttonHandle=function(t,i){if(this.duration>0||t<2||this.changingScene)return;if(3==t)return void(30==i?(this.keysShift=0==this.keysShift?1:0,this.keyboardChange()):31==i?(this.keysShift=2,this.keyboardChange()):33==i?(this.keysAlt=!this.keysAlt,this.arrayKeysSpec[0].fire("shiftOff"),this.keysShift=0,this.keyboardChange()):32==i?this.actionKey(pc.KEY_BACKSPACE):34==i?this.navigateBox(this.boxFocusIndex,!0):35==i?this.navigateBox(this.boxFocusIndex,!1):36==i?this.actionKey(pc.KEY_ENTER):(this.actionKey(-1,ScKeys.keySets[this.keySetCurr][i],!0),1==this.keysShift&&(this.arrayKeysSpec[0].fire("shiftOff"),this.keysShift=0,this.keyboardChange())));let e=this.app.root.findByName("Root");"unfocus"==i?(this.unfocusBox(),this.keyboardHide()):"user"==i?this.clickBox(0):"pass"==i?this.clickBox(1):"pass2"==i?this.clickBox(2):"email"==i?this.clickBox(3):"keyboard"==i?this.clickBox(this.boxFocusIndex):"login"==i?this.actionKey(pc.KEY_ENTER):"skip"==i?(gtag("event","login_skip"),this.unfocusBox(),this.group.enabled=!1,this.warning.enabled=!0):this.group.enabled?(this.unfocusBox(),"register"==i?(this.loginMode=!1,this.loginBtn.findByName("Text").element.text=this.app.i18n.getText("CONFIRM"),this.notifText.enabled=!1,gtag("event","to_register",{state:!0})):"back"==i&&this.toLogin(),this.loginBtn.fire("lock"),this.registBtn.fire("lock"),this.backBtn.fire("lock")):"close"==i?(this.group.enabled=!0,this.warning.enabled=!1):"ok"==i&&(gtag("event","skip_confirm"),this.changingScene=!0,this.removeKeyboardListeners(),e.fire("changeScene","scnInstructions"))},ScLogin.prototype.toLogin=function(t=!0){this.loginMode=!0,this.loginBtn.findByName("Text").element.text=this.app.i18n.getText("LOGIN"),t&&(this.notifText.enabled=!1),this.clearBox(2),this.clearBox(3),this.clearBox(4),gtag("event","to_register",{state:!1})},ScLogin.prototype.updateAnimations=function(t){if(this.notifText.enabled){let i=this.notifText.getLocalScale().x;!this.notifShrink&&i<1.25?(i+=10*t,this.notifText.setLocalScale(i,i,1),i>=1.25&&(this.notifShrink=!0)):i>1&&(i*=.95,i<1.001&&(i=1),this.notifText.setLocalScale(i,i,1))}if(this.duration>0){let i=this.duration,e=2*i;for(let t=0;t<8;t++)this.stars[t].enabled=i<=1-.1*t,this.stars[t].element.opacity=Math.min(2.5-.2*t-e,1);this.duration-=1.5*t}let i=4096*t,e=256*t;if(this.loginMode){let t=this.patrick.getLocalPosition();t.y<-160&&(t.y+=i,t.y>-160&&(t.y=0),this.patrick.setLocalPosition(t)),t=this.registText.getLocalPosition(),t.y<256?(t.y+=i,this.registText.setLocalPosition(t)):(t=this.loginText.getLocalPosition(),t.y>0&&(t.y-=i,t.y<0&&(t.y=0),this.loginText.setLocalPosition(t))),t=this.userBox.getLocalPosition(),t.x<0?(t.x+=i,t.x>0&&(t.x=0),this.userBox.setLocalPosition(t)):t.x>0&&(t.x-=e,t.x<0&&(t.x=0),this.userBox.setLocalPosition(t)),t=this.passBox.getLocalPosition(),t.x<0?(t.x+=i,t.x>=0&&(t.x=0),this.passBox.setLocalPosition(t)):t.x>0?(t.x-=e,t.x<0&&(t.x=0),this.passBox.setLocalPosition(t)):(t=this.pass2Box.getLocalPosition(),t.y<138&&(t.y+=i,t.y>=138&&(t.y=138,this.pass2Box.enabled=!1),this.pass2Box.setLocalPosition(t)),t.x>0&&(t.x-=e,t.x<0&&(t.x=0),this.pass2Box.setLocalPosition(t)),t=this.emailBox.getLocalPosition(),t.x>0&&(t.x-=e,t.x<0&&(t.x=0),this.emailBox.setLocalPosition(t)),t.y<300?(t.y+=i,t.y>=300&&(t.y=300,this.emailBox.enabled=!1),this.emailBox.setLocalPosition(t)):(t=this.forgotBtn.getLocalPosition(),t.y>0&&(t.y-=i/2,t.y<0&&(t.y=0),this.forgotBtn.setLocalPosition(t)))),t=this.loginBtn.getLocalPosition(),t.x<0?(t.x+=i,t.x>0&&(t.x=0)):t.y<0&&(t.y+=i,t.y>=0&&(t.y=0,this.loginBtn.fire("lock",!1))),this.loginBtn.setLocalPosition(t),t=this.backBtn.getLocalPosition(),t.x>-512?(t.x-=i,this.backBtn.setLocalPosition(t)):(t=this.registBtn.getLocalPosition(),t.y<0&&(t.y+=i,t.y>=0&&(t.y=0,this.registBtn.fire("lock",!1)),this.registBtn.setLocalPosition(t))),t=this.skipBtn.getLocalPosition(),t.x>0&&(t.x-=i,t.x<=0&&(t.x=0,this.skipBtn.fire("lock",!1)),this.skipBtn.setLocalPosition(t))}else{let t=this.loginText.getLocalPosition();t.y<256?(t.y+=i,this.loginText.setLocalPosition(t)):(t=this.registText.getLocalPosition(),t.y>0&&(t.y-=i,t.y<0&&(t.y=0),this.registText.setLocalPosition(t))),t=this.forgotBtn.getLocalPosition(),t.y<120?(t.y+=i/2,t.y>=120&&(t.y=120,this.pass2Box.enabled=!0,this.emailBox.enabled=!0),this.forgotBtn.setLocalPosition(t)):(t=this.userBox.getLocalPosition(),t.x>0&&(t.x-=e,t.x<0&&(t.x=0),this.userBox.setLocalPosition(t)),t=this.passBox.getLocalPosition(),t.x>0&&(t.x-=e,t.x<0&&(t.x=0),this.passBox.setLocalPosition(t)),t=this.pass2Box.getLocalPosition(),t.y>0&&(t.y-=i,t.y<0&&(t.y=0),this.pass2Box.setLocalPosition(t)),t.x>0&&(t.x-=e,t.x<0&&(t.x=0),this.pass2Box.setLocalPosition(t)),t=this.emailBox.getLocalPosition(),t.y>0&&(t.y-=i,t.y<0&&(t.y=0),this.emailBox.setLocalPosition(t)),t.x>0&&(t.x-=e,t.x<0&&(t.x=0),this.emailBox.setLocalPosition(t))),t=this.loginBtn.getLocalPosition(),t.y>-256&&(t.y-=i,t.y<=-256&&(t.y=-256,this.loginBtn.fire("lock",!1)),this.loginBtn.setLocalPosition(t)),t=this.registBtn.getLocalPosition(),t.y>-512?(t.y-=i,this.registBtn.setLocalPosition(t)):(t=this.backBtn.getLocalPosition(),t.x<0&&(t.x+=i,t.x>=0&&(t.x=0,this.backBtn.fire("lock",!1)),this.backBtn.setLocalPosition(t)))}},ScLogin.prototype.loginNotif=function(t,i=0){this.notifText.element.text=this.app.i18n.getText(t),this.notifText.setLocalScale(0,0,1),this.notifText.enabled=!0,this.notifShrink=!1,this.notifText.element.color=pc.Color.RED,i<0?(this.notifText.element.color=this.notifValidCol,-1==i?(gtag("event","login"),this.goPlay=!0,this.delayPlay=1,this.changingScene=!0):gtag("event","sign_up")):1==i?(this.boxArray[0].translateLocal(32,0,0),this.boxArray[1].translateLocal(56,0,0)):2==i&&(this.boxArray[0].translateLocal(32,0,0),this.boxArray[3].translateLocal(56,0,0))};var ScKeys=pc.createScript("scKeys");ScKeys.keySets=[["q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m","-","=","@","."],["Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M","-","=","@","."],["1","2","3","4","5","6","7","8","9","0","-","/",":",";","(",")","$","&",'"',".",",","?","!","'","@","","","","",""],["[","]","{","}","#","%","^","*","+","=","","_","\\","|","~","<",">","","",".",",","?","!","'","@","","","","",""],["1","2","3","4","5","6","7","8","9","0","","","-","_","@",".","","","","","","","","","","","","","",""]];var ScKeysUi=pc.createScript("scKeysUi");ScKeysUi.attributes.add("clickEvent",{type:"string",title:"Click Event",default:"default"}),ScKeysUi.prototype.initialize=function(){this.root=this.app.root.findByName("Root"),this.clickLink=this.root.findByName("UI_Login"),this.locked=!0,this.state=0,this.initX=0,this.initY=0,this.frameInit=this.entity.element.spriteFrame,this.hold=0,this.tickShift=0,this.tickDel=.5,this.intvDel=.25,this.entity.on("lock",(function(t=!0){this.locked=t,this.entity.element.spriteFrame=this.frameInit,this.hold=0}),this),this.entity.on("shiftOff",(function(){this.hold=0,this.entity.element.spriteFrame=this.frameInit}),this),this.app.touch?(this.entity.element.on("touchend",(function(t){2==this.state&&this.interacted(0,2),this.state=0,t.event.preventDefault()}),this),this.entity.element.on("touchstart",(function(t){this.tickDel=.5,this.intvDel=.25,this.interacted(1,1),this.state=2,this.initX=t.x,this.initY=t.y,t.event.preventDefault(),t.stopPropagation()}),this),this.entity.element.on("touchmove",(function(t){ScUtils.point_distance(this.initX,this.initY,t.x,t.y)>80&&(this.interacted(),this.state=0),t.event.preventDefault()}),this),this.entity.element.on("touchcancel",(function(t){this.interacted(),this.state=0,t.event.preventDefault()}),this)):(this.entity.element.on("mousedown",(function(t){1==this.state&&(this.interacted(1,1),this.state=2,this.tickDel=.5,this.intvDel=.25),t.stopPropagation()}),this),this.entity.element.on("mouseup",(function(t){2==this.state&&(this.interacted(0,2),this.state=1)}),this),this.entity.element.on("mouseenter",(function(t){this.state=1}),this),this.entity.element.on("mouseleave",(function(t){this.interacted(),this.state=0}),this))},ScKeysUi.prototype.update=function(t){this.tickShift>0&&(this.tickShift-=t),32==this.clickEvent&&2==this.state&&(this.tickDel-=t,this.tickDel<=0&&(this.tickDel=this.intvDel,this.intvDel*=.9,this.clickLink.fire("button",3,32)))},ScKeysUi.prototype.interacted=function(t=0,i=0){if(!this.locked){if(this.clickEvent<30){let i=this.entity.findByName("Text");0==t?(this.entity.element.spriteFrame=0,this.entity.element.pivot=[.5,.5],i.element.pivot=[.5,.5],i.element.fontSize=56):(this.entity.element.spriteFrame=1,this.entity.element.pivot=[.5,.25],i.element.pivot=[.5,0],i.element.fontSize=128)}else 1==i&&(30==this.clickEvent?0==this.hold?(this.hold=1,this.tickShift=.4):this.tickShift>0?(this.tickShift=0,this.hold=2,this.clickLink.fire("button",3,31),i=0):this.hold=0:33==this.clickEvent&&(this.hold=0==this.hold?1:0)),0!=this.hold&&(t=this.hold),this.entity.element.spriteFrame=this.frameInit+t;1==i&&(this.root.fire("click"),this.clickLink.fire("button",3,this.clickEvent))}};var ScInstructions=pc.createScript("scInstructions");ScInstructions.prototype.initialize=function(){gtag("event","tutorial_begin"),this.board=this.entity.findByName("imgBoardBox"),this.title=this.board.findByName("txtTitle"),this.pic=this.board.findByName("imgPicture"),this.desc=this.board.findByName("txtDesc"),this.prevBtn=this.board.findByName("imgPrevBtn"),this.nextBtn=this.board.findByName("imgNextBtn"),this.patrick=this.entity.findByName("imgPatrick"),this.skipBtn=this.entity.findByName("imgSkipBtn"),this.duration=.5,this.titleS=1,this.titleAng=1.25,this.board.setLocalScale(0,0,1),this.pic.setLocalScale(0,0,1),this.desc.element.opacity=0,this.prevBtn.setLocalScale(0,0,1),this.nextBtn.setLocalScale(0,0,1),this.patrick.setLocalPosition(-1024,0,0),this.skipBtn.setLocalPosition(1024,0,0),this.instNo=0,this.instLast=2,this.prevBtn.enabled=0!=this.instNo,this.nextBtn.enabled=this.instNo!=this.instLast,this.entity.on("button",(function(t,i){if(!(this.duration>0||2!=t||this.changingScene))if("skip"==i){this.instNo<this.instLast?gtag("event","tutorial_skip"):gtag("event","tutorial_complete"),this.changingScene=!0;let t=this.app.root.findByName("Root");t.sound.stop(),1==ScRoot.sharedData.bgmState&&t.sound.play("Game"),t.fire("postStart"),t.fire("changeScene","scnPlay")}else{let t=this.instNo;"prev"==i?this.instNo>0&&(this.instNo--,gtag("event","tutorial_prev")):this.instNo<this.instLast&&(this.instNo++,gtag("event","tutorial_next")),t!=this.instNo&&(this.desc.element.text=this.app.i18n.getText("INST"+this.instNo.toString()),this.prevBtn.enabled=0!=this.instNo,this.nextBtn.enabled=this.instNo!=this.instLast)}}),this)},ScInstructions.prototype.update=function(t){let i=this.board.getLocalScale().x;if(i<1)return i+=3*t,i>1&&(i=1),void this.board.setLocalScale(i,i,1);let s=this.title.getLocalPosition().y;if(s+=64*this.titleS*t,this.title.setLocalPosition(0,s,0),this.title.rotateLocal(0,0,this.titleAng*t),this.titleS*=.98,s<=-8)this.titleS=1;else if(s>=8){this.titleS=-1;let t=this.title.getLocalEulerAngles().z,i=Math.abs(t)+2.5*Math.random();t>0&&(i=-i),this.titleAng=i}if(this.duration<=0)return;i=this.pic.getLocalScale().x,i<1&&(i+=4*t,i>1&&(i=1),this.pic.setLocalScale(i,i,1));let e=this.desc.element.opacity;e<1?(e+=4*t,e>1&&(e=1),this.desc.element.opacity=e):(i=this.prevBtn.getLocalScale().x,i<1&&(i+=4*t,i>1&&(i=1),this.prevBtn.setLocalScale(i,i,1)),i=this.nextBtn.getLocalScale().x,i<1&&(i+=4*t,i>1&&(i=1),this.nextBtn.setLocalScale(i,i,1)));let n=4096*t,a=this.patrick.getLocalPosition();a.x<0&&(a.x+=n,a.x>0&&(a.x=0),this.patrick.setLocalPosition(a)),a=this.skipBtn.getLocalPosition(),a.x>0&&(a.x-=n,a.x<0&&(a.x=0),this.skipBtn.setLocalPosition(a)),this.duration-=t,this.duration<=0&&(this.skipBtn.fire("lock",!1),ScRoot.sharedData.tuts=!1)};var ScBubs=pc.createScript("scBubs");ScBubs.prototype.initialize=function(){this.spd=3*Math.abs(this.entity.getLocalScale().x)},ScBubs.prototype.update=function(t){this.entity.translateLocal(0,this.spd*t,0)};var ScScrollUi=pc.createScript("scScrollUi");ScScrollUi.prototype.initialize=function(){this.state=0,this.locked=!1,this.lastDiff=0,this.initY=0,this.scroll=0,this.index=0,this.textArray=[],this.lines=0,this.entity.on("activate",this.activate,this),this.app.touch?(this.entity.element.on("touchstart",(function(t){this.state=2,this.locked=!0,this.initY=t.y,t.event.preventDefault(),t.stopPropagation()}),this),this.entity.element.on("touchmove",(function(t){this.interact(t)}),this),this.entity.element.on("touchend",(function(t){this.interact(t,2),this.state=0}),this),this.entity.element.on("touchcancel",(function(t){this.interact(t,2),this.state=0}),this)):(this.entity.element.on("mousedown",(function(t){this.state=2,this.locked=!0,this.initY=t.y,t.stopPropagation()}),this),this.entity.element.on("mousemove",(function(t){this.interact(t)}),this),this.entity.element.on("mouseup",(function(t){this.interact(t,2),this.state=0}),this),this.entity.element.on("mouseleave",(function(t){this.interact(t,2),this.state=0}),this),this.entity.element.on("mousewheel",(function(t){this.interact(t,1),this.state=0}),this))},ScScrollUi.prototype.update=function(t){if(!this.locked){let t=this.scroll;if(0!=t){let i=this.index;this.index=pc.math.clamp(this.index+this.scroll,0,Math.max(this.lines-10,0));let e=Math.round(this.index);if(i!=e){let i=pc.math.clamp(this.index+20,1,this.lines),s="";for(let t=e;t<i;t++)s+=this.textArray[t]+"\n";this.entity.element.text=s,(this.index<=0||this.index>=this.lines-10)&&(t=0)}t*=.98,t>-1e-5&&t<1e-5&&(t=0),this.scroll=t}}},ScScrollUi.prototype.interact=function(t,i=0){if(2!=this.state&&1!=i)return;let e=t;if(this.app.touch&&(e=t,t.event.preventDefault()),2!=i){0==i?(this.lastDiff=(this.initY-e.y)/32,this.initY=e.y):(this.lastDiff=2*e.wheelDelta,this.scroll=0);let t=this.index;this.index=pc.math.clamp(this.index+this.lastDiff,0,Math.max(this.lines-10,0));let s=Math.round(this.index);if(t!=s){let t=pc.math.clamp(this.index+20,1,this.lines),i="";for(let e=s;e<t;e++)i+=this.textArray[e]+"\n";this.entity.element.text=i}}else this.scroll=10*this.lastDiff,this.locked=!1,this.lastDiff=0;t.stopPropagation()},ScScrollUi.prototype.activate=function(t){this.state=0,this.locked=!1,this.lastDiff=0,this.initY=0,this.scroll=0,this.index=0,this.textArray=this.app.assets.find(t+".txt","text").resource.split(/\r\n|\r|\n/),this.lines=this.textArray.length;let i="",e=pc.math.clamp(this.index+20,1,this.lines);for(let t=this.index;t<e;t++)i+=this.textArray[t]+"\n";this.entity.element.text=i};var ScLimiter=pc.createScript("scLimiter");ScLimiter.attributes.add("targetFps",{type:"number",default:30}),ScLimiter.prototype.initialize=function(){this.app;this.limit(this.targetFps),this.on("attr:targetFps",(function(t,i){this.limit(t)}))},ScLimiter.prototype.limit=function(t){var i=this.app;this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),t>=60?i.autoRender=!0:(i.autoRender=!1,this.intervalId=setInterval((function(){i.renderNextFrame=!0}),1e3/t))};var ScLeaderboard=pc.createScript("scLeaderboard");ScLeaderboard.prototype.initialize=function(){let t,i;this.spotlight=this.entity.findByName("imgShade"),this.board=this.entity.findByName("imgBoardBox"),this.tmpEntry=this.board.findByName("tmpEntry"),this.title=this.board.findByName("txtLeaderboard"),this.uiCharacters=this.entity.findByName("uiCharacters"),this.homeBtn=this.entity.findByName("imgHomeBtn"),this.replayBtn=this.entity.findByName("imgReplayBtn"),this.duration=1.25,this.titleS=1,this.titleAng=1.25,this.phase=0,this.phaseSpd=10,Math.random()<.5?(t=ScUtils.choose(-2048,2048),i=pc.math.random(-1344,1344)):(t=pc.math.random(-2048,2048),i=ScUtils.choose(-1344,1344)),this.spotlight.setLocalPosition(t,i,0),this.spotlightX=3*-t,this.spotlightY=3*-i,this.spotlightDone=!1,this.board.setLocalScale(0,0,1),this.uiCharacters.element.width=4096,this.homeBtn.setLocalPosition(512,0,0),this.replayBtn.setLocalPosition(-512,0,0),this.changingScene=!1,this.entries=[];let e=this;this.app.root.findByName("Root").fire("getLeaderboard",(function(t){e.clear();let i=e.board,s=t.length,o=0;for(let a=0;a<s;a++)e.addEntry(i,o,a+1,t[a].username.slice(0,12),t[a].score),o-=110})),this.entity.on("button",(function(t,i){if(this.duration>0||2!=t||this.changingScene)return;this.changingScene=!0;let e=this.app.root.findByName("Root");"replay"==i?(e.fire("postStart"),e.fire("changeScene","scnPlay")):e.fire("changeScene","scnHome")}),this)},ScLeaderboard.prototype.update=function(t){if(!this.spotlightDone){let i=this.spotlight.getLocalPosition(),e=i.x,s=i.y;return 0!=e&&(e>0?(e+=this.spotlightX*t,e<0&&(e=0)):(e+=this.spotlightX*t,e>0&&(e=0))),0!=s&&(s>0?(s+=this.spotlightY*t,s<0&&(s=0)):(s+=this.spotlightY*t,s>0&&(s=0))),this.spotlight.setLocalPosition(e,s,0),void(0==e&&0==s&&(this.spotlightDone=!0))}let i=this.board.getLocalScale().x;if(i<1)return i+=3*t,i>1&&(i=1),void this.board.setLocalScale(i,i,1);let e=this.uiCharacters.element.width;e>0&&(e*=.9,e<1&&(e=0),this.uiCharacters.element.width=e);let s=this.title.getLocalPosition().y;if(s+=128*this.titleS*t,this.title.setLocalPosition(0,s,0),this.title.rotateLocal(0,0,this.titleAng*t),this.titleS*=.98,s<=-16)this.titleS=1;else if(s>=16){this.titleS=-1;let t=this.title.getLocalEulerAngles().z,i=Math.abs(t)+2.5*Math.random();t>0&&(i=-i),this.titleAng=i}let o=this.entries.length;if(o>0){for(let t=0;t<o;t++){let i=this.phase-2*t-1,e=pc.math.clamp(i,-1,3)*Math.PI/2,s=1.1+Math.sin(e)/10,o=this.entries[t];o.findByName("Position").setLocalScale(s,s,1),o.findByName("Name").setLocalScale(s,s,1),o.findByName("Coin").setLocalScale(s,s,1),o.findByName("Score").setLocalScale(s,s,1),i>-1&&(o.enabled=!0)}this.phase+=this.phaseSpd*t,this.phase>=16&&(this.phase-=16,this.phaseSpd=4)}this.duration>0&&(this.duration<.25&&(shift=3072*t,pos=this.homeBtn.getLocalPosition(),pos.x>0&&(pos.x-=shift,pos.x<0&&(pos.x=0),this.homeBtn.setLocalPosition(pos)),pos=this.replayBtn.getLocalPosition(),pos.x<0&&(pos.x+=shift,pos.x>0&&(pos.x=0),this.replayBtn.setLocalPosition(pos))),this.duration-=t,this.duration<=0&&(this.homeBtn.fire("lock",!1),this.replayBtn.fire("lock",!1)))},ScLeaderboard.prototype.clear=function(){for(var t=0;t<this.entries.length;t++)this.entries[t].destroy();this.entries=[]},ScLeaderboard.prototype.addEntry=function(t,i,e,s,o){var a=this.tmpEntry.clone(),h=a.findByName("Position").element;h.text=e.toString()+".",h.fontSize=104-8*e,a.findByName("Name").element.text=s.toUpperCase(),a.findByName("Score").element.text=ScUtils.formatNumber(o),t.addChild(a),a.translateLocal(0,i,0),this.entries.push(a)};var ScSettings=pc.createScript("scSettings");ScSettings.prototype.initialize=function(){let t,i;this.spotlight=this.entity.findByName("imgShade"),this.board=this.entity.findByName("imgBoardBox"),this.title=this.board.findByName("txtSettings"),this.homeBtn=this.entity.findByName("imgHomeBtn"),this.backBtn=this.entity.findByName("imgBackBtn"),this.boardPop=this.entity.findByName("imgBoardPop"),this.popText=this.boardPop.findByName("txtBoardPop"),this.langText=this.board.findByName("txtLanguage"),this.sfxText=this.board.findByName("txtSFX"),this.bgmText=this.board.findByName("txtBGM"),this.privacy=this.board.findByName("txtPrivacy"),this.support=this.board.findByName("txtSupport"),this.terms=this.board.findByName("txtTerms"),this.langBar=this.board.findByName("imgLangBar"),this.langFill=this.langBar.findByName("imgBarFill"),this.langLabel=[this.langBar.findByName("imgLabelENG").element,this.langBar.findByName("imgLabelCHN").element,this.langBar.findByName("imgLabelTRD").element,this.langBar.findByName("imgLabelJPN").element],this.darkCol=new pc.Color(104/255,17/255,43/255),this.sfxBtn=this.board.findByName("imgSFXToggle"),this.bgmBtn=this.board.findByName("imgBGMToggle"),this.uiJellyfishes=this.entity.findByName("uiJellyfishes"),this.langBarSet(ScRoot.sharedData.currLang),this.toggleSet(this.sfxBtn,ScRoot.sharedData.sfxState),this.toggleSet(this.bgmBtn,ScRoot.sharedData.bgmState),this.duration=.5,this.titleS=1,this.titleAng=1.25,this.langPop=0,this.sfxPop=0,this.bgmPop=0,this.langText.setLocalPosition(-1024,0,0),this.sfxText.setLocalPosition(-2048,0,0),this.bgmText.setLocalPosition(-3072,0,0),this.langBar.setLocalPosition(1024,0,0),this.sfxBtn.setLocalPosition(2048,0,0),this.bgmBtn.setLocalPosition(3072,0,0),this.terms.setLocalPosition(0,-512,0),this.privacy.setLocalPosition(0,-768,0),this.support.setLocalPosition(0,-1024,0),this.langText.enabled=!1,this.sfxText.enabled=!1,this.bgmText.enabled=!1,this.langBar.enabled=!1,this.sfxBtn.enabled=!1,this.bgmBtn.enabled=!1,this.terms.enabled=!1,this.privacy.enabled=!1,this.support.enabled=!1,Math.random()<.5?(t=ScUtils.choose(-2048,2048),i=pc.math.random(-1344,1344)):(t=pc.math.random(-2048,2048),i=ScUtils.choose(-1344,1344)),this.spotlight.setLocalPosition(t,i,0),this.spotlightX=3*-t,this.spotlightY=3*-i,this.spotlightDone=!1,this.board.setLocalScale(0,0,1),this.homeBtn.setLocalPosition(512,0,0),this.uiJellyfishes.element.width=8192,this.changingScene=!1,this.entity.on("button",(function(t,i){this.duration>0||2!=t||this.changingScene||("home"==i?(this.changingScene=!0,this.app.root.findByName("Root").fire("changeScene","scnHome")):"sfx"==i?(this.toggle(this.sfxBtn,"toggleSFX","sfx_toggle"),this.sfxPop=.05):"bgm"==i?(this.toggle(this.bgmBtn,"toggleBGM","bgm_toggle"),this.bgmPop=.05):"eng"==i?this.langSelect(0,"en"):"chn"==i?this.langSelect(1,"zh-sc"):"trd"==i?this.langSelect(2,"zh-tc"):"jpn"==i?this.langSelect(3,"ja"):"back"==i?(this.boardPop.enabled=!1,this.board.enabled=!0,this.homeBtn.enabled=!0,this.backBtn.enabled=!1):(this.boardPop.enabled=!0,this.board.enabled=!1,this.homeBtn.enabled=!1,this.backBtn.enabled=!0,"terms"==i?this.popText.fire("activate","terms"):"privacy"==i?this.popText.fire("activate","privacy"):"support"==i&&this.popText.fire("activate","support")))}),this)},ScSettings.prototype.update=function(t){if(this.boardPop.enabled){let i=this.uiJellyfishes.element.width;return void(i>-4096&&(i-=4096*t,this.uiJellyfishes.element.width=i))}if(!this.spotlightDone){let i=this.spotlight.getLocalPosition(),e=i.x,s=i.y;0!=e&&(e>0?(e+=this.spotlightX*t,e<0&&(e=0)):(e+=this.spotlightX*t,e>0&&(e=0))),0!=s&&(s>0?(s+=this.spotlightY*t,s<0&&(s=0)):(s+=this.spotlightY*t,s>0&&(s=0))),this.spotlight.setLocalPosition(e,s,0),0==e&&0==s&&(this.spotlightDone=!0)}let i=this.board.getLocalScale().x;if(i<1)return i+=3*t,i>=1&&(i=1,this.langText.enabled=!0,this.sfxText.enabled=!0,this.bgmText.enabled=!0,this.langBar.enabled=!0,this.sfxBtn.enabled=!0,this.bgmBtn.enabled=!0,this.privacy.enabled=!0,this.support.enabled=!0,this.terms.enabled=!0),void this.board.setLocalScale(i,i,1);let e=this.title.getLocalPosition().y;if(e+=64*this.titleS*t,this.title.setLocalPosition(0,e,0),this.title.rotateLocal(0,0,this.titleAng*t),this.titleS*=.98,e<=-8)this.titleS=1;else if(e>=8){this.titleS=-1;let t=this.title.getLocalEulerAngles().z,i=Math.abs(t)+2.5*Math.random();t>0&&(i=-i),this.titleAng=i}i=this.langText.getLocalScale().x,this.langPop>0?(i+=t,this.langPop-=t,this.langText.setLocalScale(i,i,1)):i>1&&(i-=t,i<1&&(i=1),this.langText.setLocalScale(i,i,1)),i=this.sfxText.getLocalScale().x,this.sfxPop>0?(i+=t,this.sfxPop-=t,this.sfxText.setLocalScale(i,i,1)):i>1&&(i-=t,i<1&&(i=1),this.sfxText.setLocalScale(i,i,1)),i=this.bgmText.getLocalScale().x,this.bgmPop>0?(i+=t,this.bgmPop-=t,this.bgmText.setLocalScale(i,i,1)):i>1&&(i-=t,i<1&&(i=1),this.bgmText.setLocalScale(i,i,1));let s=this.uiJellyfishes.element.width;if(0!=s&&(s*=.9,s>-1&&s<1&&(s=0),this.uiJellyfishes.element.width=s),this.duration<=0)return;let a=8192*t,o=this.langText.getLocalPosition();o.x<0&&(o.x+=a,o.x>0&&(o.x=0),this.langText.setLocalPosition(o)),o=this.sfxText.getLocalPosition(),o.x<0&&(o.x+=a,o.x>0&&(o.x=0),this.sfxText.setLocalPosition(o)),o=this.bgmText.getLocalPosition(),o.x<0&&(o.x+=a,o.x>0&&(o.x=0),this.bgmText.setLocalPosition(o)),o=this.langBar.getLocalPosition(),o.x>0&&(o.x-=a,o.x<0&&(o.x=0),this.langBar.setLocalPosition(o)),o=this.sfxBtn.getLocalPosition(),o.x>0&&(o.x-=a,o.x<0&&(o.x=0),this.sfxBtn.setLocalPosition(o)),o=this.bgmBtn.getLocalPosition(),o.x>0&&(o.x-=a,o.x<0&&(o.x=0),this.bgmBtn.setLocalPosition(o)),a=2048*t,o=this.privacy.getLocalPosition(),o.y<0&&(o.y+=a,o.y>0&&(o.y=0),this.privacy.setLocalPosition(o)),o=this.support.getLocalPosition(),o.y<0&&(o.y+=a,o.y>0&&(o.y=0),this.support.setLocalPosition(o)),o=this.terms.getLocalPosition(),o.y<0&&(o.y+=a,o.y>0&&(o.y=0),this.terms.setLocalPosition(o)),this.duration<.25&&(a=4096*t,o=this.homeBtn.getLocalPosition(),o.x>0&&(o.x-=a,o.x<0&&(o.x=0),this.homeBtn.setLocalPosition(o))),this.duration-=t,this.duration<=0&&this.homeBtn.fire("lock",!1)},ScSettings.prototype.langBarSet=function(t){let i;switch(this.langLabel[0].spriteFrame=0,this.langLabel[1].spriteFrame=1,this.langLabel[2].spriteFrame=2,this.langLabel[3].spriteFrame=3,this.langLabel[t].spriteFrame+=4,t){case 1:i=192;break;case 2:i=320;break;case 3:i=428;break;default:i=0}this.langFill.setLocalPosition(i,0,0),this.langFill.element.spriteFrame=t},ScSettings.prototype.langSelect=function(t,i){this.langBarSet(t),this.langPop=.05,this.app.root.findByName("Root").fire("selectLocal",t,i),this.langFill.element.spriteFrame!=t&&gtag("event","lang_select",{language:i})},ScSettings.prototype.toggleSet=function(t,i){let e=t.findByName("txtOFF"),s=t.findByName("txtON");t.element.spriteFrame=i,0==i?(e.element.color=pc.Color.WHITE,s.element.color=this.darkCol,e.setLocalScale(1.1,1.1,1),s.setLocalScale(.8,.8,1)):(s.element.color=pc.Color.WHITE,e.element.color=this.darkCol,s.setLocalScale(1.1,1.1,1),e.setLocalScale(.8,.8,1))},ScSettings.prototype.toggle=function(t,i,e){let s=0==t.element.spriteFrame?1:0;this.toggleSet(t,s),this.app.root.findByName("Root").fire(i,s),gtag("event",e,{state:s})};